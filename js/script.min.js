var initielized=!1,editorPHP=null,editorJSP=null,editorSQL=null;function initCodeMirror(){initielized||($(".code-area").css({display:"block"}),editorPHP=CodeMirror.fromTextArea(document.getElementById("text-code-php"),{lineNumbers:!0,matchBrackets:!0,mode:"application/x-httpd-php"}),editorJSP=CodeMirror.fromTextArea(document.getElementById("text-code-jsp"),{lineNumbers:!0,matchBrackets:!0,mode:"text/x-csrc"}),editorSQL=CodeMirror.fromTextArea(document.getElementById("sql-from-server"),{mode:"text/x-pgsql",indentWithTabs:!0,smartIndent:!0,lineNumbers:!0,matchBrackets:!0}),initielized=!0)}function saveState(e,t){var r=JSON.stringify(e.serializeArray()),n=databaseInfo(t),a=n.host.val(),i=n.port.val(),o=n.database.val(),s=n.table.val();window.localStorage.setItem(a+"_"+i+"_"+o+"_"+s,r)}function databaseInfo(e){var t=$(e).find("#host"),r=$(e).find("#port"),n=$(e).find("#database"),a=$(e).find("#table");return{host:t,port:r,database:n,table:a}}function getSavedData(e){var t=databaseInfo(e),r=t.host.val(),n=t.port.val(),a=t.database.val(),i=t.table.val();return JSON.parse(window.localStorage.getItem(r+"_"+n+"_"+a+"_"+i))}function hasKey(e,t){var r,n=e.length;for(r=0;r<n;r++)if(e[r].value==t)return!0;return!1}function loadState(e,t,r){var n;for(n in r.find("tbody tr").each(function(t,n){var a=$(this).find('input[type="hidden"][name="field"]').val();hasKey(e,a)&&$(r).find('input[name$="'+a+'"]').each(function(e,t){$(this)[0].checked=!1})}),e){var a=$(r).find(":input[name="+e[n].name+"]");if(a.length){var i=e[n].value,o=e[n].name,s=a.prop("tagName").toString().toLowerCase(),l=a.attr("type");"radio"==l?$(r).find('[name="'+o+'"][value="'+i+'"]')[0].checked=!0:"checkbox"==l&&null!=i&&0!=i&&"0"!=i?$(r).find('[name="'+o+'"]')[0].checked=!0:"select"==s&&a.val(e[n].value)}}}function getContraVal(e){return"text"==e?"select":"select"==e?"text":void 0}function loadConfig(){var e=window.localStorage.getItem("sg_host")||"",t=window.localStorage.getItem("sg_port")||"",r=window.localStorage.getItem("sg_username")||"",n=window.localStorage.getItem("sg_password")||"",a=window.localStorage.getItem("sg_database")||"",i=window.localStorage.getItem("sg_table")||"";$('.config-table [name="host"]').val(e),$('.config-table [name="port"]').val(t),$('.config-table [name="username"]').val(r),$('.config-table [name="password"]').val(n),$('.config-table [name="database"]').val(a),$('.config-table [name="table"]').val(i)}function finalizeString(e){return e=e.replaceAll("`","")}function generateAuthentification(e,t){var r="";return"jsp"==(t=t||"php")?r='<%@ include file="lib.inc/auth-with-login-form.jsp" %>':"php"==t&&(r='<?php include_once dirname(__FILE__)."/lib.inc/auth-with-login-form.php"; ?>'),r}function generateController(e,t,r){r=r||"php",(t=t||{}).withApproval=t.withApproval||!1,t.withTrash=t.withTrash||!1,t.withNote=t.withNote||!1;var n,a=getFieldValues(e,"field"),i=getFieldValues(e,"table")[0],o=[],s=getPrimaryKey(e),l=s.length?s[0]:a[0],p=getSelectedFilterType(e,l),d="",c="";if("jsp"==r){c+="<%\r\n",c+="// Script Generator\r\n",c+="// Witten by Kamshory\r\n",c+="// All rights reserved\r\n",c+="// http://planetbiru.com/kamshory\r\n\r\n",c+="// declare all variables\r\n\r\n",c+='_self_name = "'+i.replaceAll("_","-")+'.jsp";\r\n',c+='_table_name = "'+i+'";\r\n',c+='_module_name = "'+i.replaceAll("_","-")+'";\r\n',c+='_module_title = "'+i.replaceAll("_"," ").capitalize().prettify().trim()+'";\r\n\r\n',c+='String _pkey_name = "'+l+'";\r\n',c+='String _pkey_value = "";\r\n',c+='String _na_name = "aktif";\r\n',c+="String _now = query1.now();\r\n",c+="String _query;\r\n",c+='String _action = filterInput(request, "user_action", "FILTER_SANITIZE_STRING", true);\r\n',c+='String _activate = filterInput(request, "data_activate", "FILTER_SANITIZE_STRING", true);\r\n',c+='String _deactivate = filterInput(request, "data_deactivate", "FILTER_SANITIZE_STRING", true);\r\n',c+='String _delete = filterInput(request, "data_delete", "FILTER_SANITIZE_STRING", true);\r\n',c+='String _save = filterInput(request, "button_save", "FILTER_SANITIZE_STRING", true);\r\n',c+='String _show_only = filterInput(request, "show-only", "FILTER_SANITIZE_SPECIAL_CHARS", true);\r\n\r\n',c+="// You can comment two lines below in case you don't want to use it.\r\n",c+="_permission = getPermission(_userLevel, _module_name);\r\n",c+="createUserLog(request, _userID, _module_name, _action);\r\n\r\n",c+="int int_i = 0, int_j = 0, int_k = 0;\r\n";var u=getInsertFields(e),f=getUpdateFields(e),h=arrayUnique(u.concat(f));for(n in h)c+="String r_"+h[n]+' = "";\r\n';for(n in t.withNote&&(c+='String r_apv_note = "";\r\n'),c+="\r\n",c+='if(_action.equals("insert") || _action.equals("update")) \r\n{\r\n',h)d=getSelectedFilterType(e,h[n]),c+="	r_"+h[n]+' = filterInput(request, "'+h[n]+'", "'+d+'", true);\r\n';for(n in t.withNote&&(c+='	r_apv_note = filterInput(request, "apv_note", "FILTER_SANITIZE_SPECIAL_CHARS", true);\r\n'),c+="}\r\n\r\n",o=[],u)o[n]="r_"+u[n];if(c+="// [INSERT BEGIN]\r\n",c+="// TODO: Here are your code to insert data to database\r\n",c+='if(_action.equals("insert") && !_save.equals("")) \r\n{\r\n',c+='	if(hasPermission(_userLevel, _module_name, "insert"))\r\n	{\r\n',c+='		_query = query1.newQuery()\r\n			.insert()\r\n			.into("`'+i+'`")\r\n			.fields("(`'+u.join("`, `")+'`)")\r\n			.values("(\'"+'+o.join("+\"', '\"+")+'+"\')")\r\n			.toString();\r\n',c+="		database1.execute(_query);\r\n\r\n",c+="		long newID = database1.getLastID();\r\n",t.withApproval){var v=u,m=o;t.withNote&&(v.push("note_create"),m.push("r_apv_note")),c+="\r\n",c+="		// [NEED APPROVAL BEGIN]",c+="\r\n",-1==$.inArray(i+"_id",v)&&(v.push(i+"_id"),m.push("newID")),c+='		_query = query1.newQuery()\r\n			.insert()\r\n			.into("`'+i+'_apv`")\r\n			.fields("(`'+v.join("`, `")+'`)")\r\n			.values("(\'"+'+m.join("+\"', '\"+")+'+"\')")\r\n			.toString();\r\n',c+="		database1.execute(_query);\r\n\r\n",c+="		long newApvID = database1.getLastID();\r\n",c+='		_query = query1.newQuery()\r\n			.update("`'+i+"_apv`\")\r\n			.set(\"`admin_buat` = '\"+_userID+\"', `waktu_buat` = \"+_now+\", `ip_buat` = '\"+_remoteAddress+\"', `status_data` = '1', `status_approve` = '0', `"+l+'` = \'"+newID+"\'")\r\n			.where("`'+i+'_apv_id` = \'"+newApvID+"\'")\r\n			.toString();\r\n',c+="		database1.execute(_query);\r\n\r\n",c+='		_query = query1.newQuery()\r\n			.update("`'+i+'`")\r\n			.set("`draft` = 1, `waiting_for` = 1, `'+i+'_apv_id` = \'"+newApvID+"\'")\r\n			.where("`'+l+'` = \'"+newID+"\'")	\n			.toString();\r\n',c+="		database1.execute(_query);\r\n\r\n",t.withNote&&(c+='		_query = query1.newQuery()\r\n			.update("`'+i+'_apv`")\r\n			.set("`note_create` = \'"+r_apv_note+"\', ")\r\n			.where("`'+i+'_apv_id` = \'"+newApvID+"\'")\r\n			.toString();\r\n',c+="		database1.execute(_query);\r\n\r\n"),c+="		// [NEED APPROVAL END]",c+="\r\n",c+="\r\n"}for(n in c+='		response.sendRedirect(_self_name+"?user_action=detail&'+l+'="+newID);\r\n',c+="	}\r\n",c+="	else\r\n	{\r\n		// TODO: add your code here when user does not have permission to insert new data\r\n\r\n	}\r\n",c+="}\r\n",c+="// [INSERT END]\r\n",c+="\r\n\r\n",o=[],f)o[n]="r_"+f[n];if(c+="// [UPDATE BEGIN]\r\n",c+="// TODO: Here are your code to update data to database\r\n",c+='if(_action.equals("update") && !_save.equals("")) \r\n{\r\n',c+='	if(hasPermission(_userLevel, _module_name, "update"))\r\n	{\r\n',c+='		_pkey_value = filterInput(request, "'+l+'", "'+p+'", true);\r\n',t.withApproval){var y=f,b=o;-1==y.indexOf(l)&&(y.push(l),b.push("_pkey_value")),c+="\r\n",c+="		// [NEED APPROVAL BEGIN]",c+="\r\n",c+='		_query = query1.newQuery()\r\n			.insert()\r\n			.into("`'+i+'_apv`")\r\n			.fields("(`'+y.join("`, `")+'`)")\r\n			.values("(\'"+'+b.join("+\"', '\"+")+'+"\')")\r\n			.toString();\r\n',c+="		database1.execute(_query);\r\n\r\n",c+="		long newApvIDForEdit = database1.getLastID();\r\n",c+='		_query = query1.newQuery()\r\n			.update("`'+i+'`")\r\n			.set("`waiting_for` = 2, `'+i+'_apv_id` = \'"+newApvIDForEdit+"\'")\r\n			.where("`'+l+'` = \'"+_pkey_value+"\'")\r\n			.toString();\r\n',c+="		database1.execute(_query);\r\n\r\n",c+='		_query = query1.newQuery()\r\n			.update("`'+i+"_apv`\")\r\n			.set(\"`admin_buat_id` = '\"+_userID+\"', `waktu_buat` = \"+_now+\", `ip_buat` = '\"+_remoteAddress+\"', `status_data` = '0', `status_approve` = '0', `"+l+'` = \'"+_pkey_value+"\'")\r\n			.where("`'+i+'_apv_id` = \'"+newApvIDForEdit+"\'")\r\n			.toString();\r\n',c+="		database1.execute(_query);\r\n",t.withNote&&(c+='		_query = query1.newQuery()\r\n			.update("`'+i+'_apv`")\r\n			.set("`note_create` = \'"+r_apv_note+"\'")\r\n			.where("`'+i+'_apv_id` = \'"+newApvIDForEdit+"\'")\r\n			.toString();\r\n',c+="		database1.execute(_query);\r\n\r\n"),c+="		// [NEED APPROVAL END]",c+="\r\n",c+="\r\n"}else{var g=[];for(n in f)g.push("`"+f[n]+"` = '\"+r_"+f[n]+"+\"'");c+='		_query = query1.newQuery()\r\n			.update("`'+i+'`")\r\n			.set("'+g.join(", ")+'")\r\n			.where("`'+l+'` = \'"+_pkey_value+"\'")\r\n			.toString();\r\n',c+="		database1.execute(_query);\r\n\r\n"}if(c+='		response.sendRedirect(_self_name+"?user_action=detail&'+l+'="+_pkey_value);\r\n',c+="	}\r\n",c+="	else\r\n	{\r\n		// TODO: add your code here when user does not have permission to update data\r\n\r\n	}\r\n",c+="}\r\n",c+="// [UPDATE END]\r\n",c+="\r\n\r\n",c+="// [ACTIVATE BEGIN]\r\n",c+="// TODO: Here are your code to activate selected data\r\n",c+="//       You can add filter here or modify the default code\r\n",c+='if(!_activate.equals("")) \r\n{\r\n',c+='	if(hasPermission(_userLevel, _module_name, "update"))\r\n	{\r\n',c+="		try\r\n		{\r\n",c+="			String[] activate_key_array = getRequestArray(request, _pkey_name);\r\n",c+="			for(int_i = 0; int_i < activate_key_array.length; int_i++)\r\n",c+="			{\r\n",t.withApproval?(c+='				_query = query1.newQuery()\r\n					.update("'+i+'")\r\n					.set("'+i+'_apv_id = -1, waiting_for = 3")\r\n					.where("'+l+" = '\"+cms.escapeSQL(activate_key_array[int_i])+\"' and "+i+'_apv_id = 0")\r\n					.toString();\r\n',c+="				database1.execute(_query);\r\n"):c+='				cms.setRecordValue("'+i+'", "'+l+'", activate_key_array[int_i], _na_name, "1");\r\n',c+="			}\r\n",c+="			response.sendRedirect(_self_name);\r\n",c+="		}\r\n",c+="		catch(Exception e)\r\n",c+="		{\r\n",c+="		}\r\n",c+="		finally\r\n",c+="		{\r\n",c+="		}\r\n",c+="	}\r\n",c+="	else\r\n	{\r\n		// TODO: add your code here when user does not have permission to update data\r\n\r\n	}\r\n",c+="}\r\n",c+="// [ACTIVATE END]\r\n",c+="\r\n\r\n",c+="// [DEACTIVATE BEGIN]\r\n",c+="// TODO: Here are your code to deactivate selected data\r\n",c+="//       You can add filter here or modify the default code\r\n",c+='if(!_deactivate.equals("")) \r\n{\r\n',c+='	if(hasPermission(_userLevel, _module_name, "update"))\r\n	{\r\n',c+="		try\r\n		{\r\n",c+="			String[] deactivate_key_array = getRequestArray(request, _pkey_name);\r\n",c+="			for(int_i = 0; int_i < deactivate_key_array.length; int_i++)\r\n",c+="			{\r\n",t.withApproval?(c+='				_query = query1.newQuery()\r\n					.update("'+i+'")\r\n					.set("'+i+'_apv_id = -1, waiting_for = 4")\r\n					.where("'+l+" = '\"+cms.escapeSQL(deactivate_key_array[int_i])+\"' and "+i+'_apv_id = 0")\r\n					.toString();\r\n',c+="				database1.execute(_query);\r\n"):c+='				cms.setRecordValue("'+i+'", "'+l+'", deactivate_key_array[int_i], _na_name, "0");\r\n',c+="			}\r\n",c+="			response.sendRedirect(_self_name);\r\n",c+="		}\r\n",c+="		catch(Exception e)\r\n",c+="		{\r\n",c+="		}\r\n",c+="		finally\r\n",c+="		{\r\n",c+="		}\r\n",c+="	}\r\n",c+="	else\r\n	{\r\n		// TODO: add your code here when user does not have permission to update data\r\n\r\n	}\r\n",c+="}\r\n",c+="// [DEACTIVATE END]\r\n",c+="\r\n\r\n",c+="// [DELETE BEGIN]\r\n",c+="// TODO: Here are your code to deactivate selected data\r\n",c+="//       You can add filter here or modify the default code\r\n",c+='if(!_delete.equals("")) \r\n{\r\n',c+='	if(hasPermission(_userLevel, _module_name, "delete"))\r\n	{\r\n',c+="		try\r\n		{\r\n",c+="			String[] delete_key_array = getRequestArray(request, _pkey_name);\r\n",c+="			for(int_i = 0; int_i < delete_key_array.length; int_i++)\r\n",c+="			{\r\n",t.withApproval?(c+='				_query = query1.newQuery()\r\n					.update("'+i+'")\r\n					.set("'+i+'_apv_id = -1, waiting_for = 5")\r\n					.where("'+l+" = '\"+cms.escapeSQL(delete_key_array[int_i])+\"' and "+i+'_apv_id = 0")\r\n					.toString();\r\n',c+="				database1.execute(_query);\r\n"):(c+='				cms.deleteRecord("'+i+'", "'+l+'", delete_key_array[int_i]);\r\n',t.withTrash&&(c+='				cms.updateTrashInfo("'+i+'_trash", "'+l+'", delete_key_array[int_i], "'+i+'_trash_id", _userID, _remoteAddress);\r\n')),c+="			}\r\n",c+="			response.sendRedirect(_self_name);\r\n",c+="		}\r\n",c+="		catch(Exception e)\r\n",c+="		{\r\n",c+="		}\r\n",c+="		finally\r\n",c+="		{\r\n",c+="		}\r\n",c+="	}\r\n",c+="	else\r\n	{\r\n		// TODO: add your code here when user does not have permission to delete data\r\n\r\n	}\r\n",c+="}\r\n",c+="// [DELETE END]\r\n",t.withApproval){var w=f.join(",");c+="\r\n",c+="\r\n",c+='// [APPROVE BEGIN]\r\nif(!filterInput(request, "data_approve", "FILTER_SANITIZE_STRING", true).equals(""))\r\n{\r\n	// TODO: Here are your code for approve\r\n	if(hasPermission(_userLevel, _module_name, "approve"))\r\n	{\r\n		_pkey_value = filterInput(request, "'+l+'", "'+p+'", true);\r\n',t.withNote&&(c+='		r_apv_note = filterInput(request, "apv_note", "FILTER_SANITIZE_SPECIAL_CHARS", true);\r\n'),c+='		ResultSet _apv_values = cms.getValues("'+i+'", "'+i+'_id", _pkey_value, "'+i+'_apv_id as apv_id, waiting_for");\r\n',c+='		if(!_apv_values.getString("apv_id").equals("0"))\r\n		{\r\n',c+='			String _apv_id = _apv_values.getString("apv_id");\r\n',c+='			if(_apv_values.getString("waiting_for").equals("1"))\r\n			{\r\n',c+='				_query = query1.newQuery()\r\n					.update("`'+i+'`")\r\n					.set("`'+i+'_apv_id` = 0, `draft` = 0, `waiting_for` = 0")\r\n					.where("`'+l+'` = \'"+_pkey_value+"\'")\r\n					.toString();\r\n',c+="				database1.execute(_query);\r\n\r\n",c+='				_query = query1.newQuery()\r\n					.update("`'+i+'_apv`")\r\n					.set("`status_approve` = \'1\', `admin_approve_id` = \'"+_userID+"\', `ip_address_approve` = \'"+_remoteAddress+"\', `time_approve` = "+_now)\r\n					.where("`'+i+'_apv_id` = \'"+_apv_id+"\'")\r\n					.toString();\r\n',c+="				database1.execute(_query);\r\n\r\n",t.withNote&&(c+='				_query = query1.newQuery()\r\n					.update("`'+i+'_apv`")\r\n					.set("`note_approve` = \'"+r_apv_note+"\'")\r\n					.where("`'+i+'_apv_id` = \'"+_apv_id+"\'")\r\n					.toString();\r\n',c+="				database1.execute(_query);\r\n\r\n"),c+='				// cms.setRecordValue("'+i+'_apv", "'+i+'_apv_id", _apv_id, "status_approve", "1");\r\n',c+='				// database1.executeQuery("update `'+i+"` set `"+i+"_apv_id` = '0' where `"+l+'` = \'"+_pkey_value+"\'");\r\n',c+="			}\r\n",c+='			else if(_apv_values.getString("waiting_for").equals("2"))\r\n',c+="			{\r\n",c+='				cms.copyData("'+i+'_apv", "'+i+'", "'+w+'", "'+i+'_apv_id", _apv_id, "'+l+'", _pkey_value);\r\n',c+='				cms.setRecordValue("'+i+'", "'+l+'", _pkey_value, "'+i+'_apv_id", "0");\r\n',c+='				cms.setRecordValue("'+i+'", "'+l+'", _pkey_value, "waiting_for", "0");\r\n',c+='				_query = query1.newQuery()\r\n					.update("`'+i+'_apv`")\r\n					.set("`status_approve` = \'1\', `admin_approve_id` = \'"+_userID+"\', `ip_address_approve` = \'"+_remoteAddress+"\', `time_approve` = "+_now)\r\n					.where("`'+i+'_apv_id` = \'"+_apv_id+"\'")\r\n					.toString();\r\n',c+="				database1.execute(_query);\r\n\r\n",t.withNote&&(c+='				_query = query1.newQuery()\r\n					.update("`'+i+'_apv`")\r\n					.set("`note_approve` = \'"+r_apv_note+"\'")\r\n					.where("`'+i+'_apv_id` = \'"+_apv_id+"\'")\r\n					.toString();\r\n',c+="				database1.execute(_query);\r\n\r\n"),c+='				// cms.setRecordValue("'+i+'_apv", "'+i+'_apv_id", _apv_id, "status_approve", "1");\r\n				// database1.executeQuery("update `'+i+"` set `"+i+"_apv_id` = '0' where `"+l+'` = \'"+_pkey_value+"\'");\r\n				// database1.executeQuery("update `'+i+"_apv` set `status_approve` = '1' where `"+i+'_apv_id` = \'"+_apv_id+"\'");\r\n',c+="			}\r\n",c+='			else if(_apv_values.getString("waiting_for").equals("3"))\r\n',c+="			{\r\n",c+='				_query = query1.newQuery()\r\n					.update("'+i+'")\r\n					.set("active = 1, '+i+'_apv_id = 0, waiting_for = 0 ")\r\n					.where("'+l+' = \'"+_pkey_value+"\'")\r\n					.toString();\r\n				database1.execute(_query);\r\n',c+="			}\r\n",c+='			else if(_apv_values.getString("waiting_for").equals("4"))\r\n',c+="			{\r\n",c+='				_query = query1.newQuery()\r\n					.update("'+i+'")\r\n					.set("active = 0, '+i+'_apv_id = 0, waiting_for = 0 ")\r\n					.where("'+l+' = \'"+_pkey_value+"\'")\r\n					.toString();\r\n				database1.execute(_query);\r\n',c+="			}\r\n",c+='			else if(_apv_values.getString("waiting_for").equals("5"))\r\n',c+="			{\r\n",c+='				_query = query1.newQuery()\r\n					.update("'+i+'")\r\n					.set("'+i+'_apv_id = 0, waiting_for = 0")\r\n					.where("'+l+' = \'"+_pkey_value+"\'")\r\n					.toString();\r\n',c+="				database1.execute(_query);\r\n",c+='				cms.deleteRecord("'+i+'", "'+l+'", _pkey_value);\r\n',t.withTrash&&(c+='				cms.updateTrashInfo("'+i+'_trash", "'+l+'", _pkey_value, "'+i+'_trash_id", _userID, _remoteAddress);\r\n'),c+="			}\r\n",c+='		}\r\n		response.sendRedirect(_self_name+"?show-only=need-approval");\r\n	}\r\n}\r\n// [APPROVE END]\r\n\r\n\r\n// [REJECT BEGIN]\r\nif(!filterInput(request, "data_reject", "FILTER_SANITIZE_STRING", true).equals(""))\r\n{\r\n	// TODO: Here are your code for approve\r\n	if(hasPermission(_userLevel, _module_name, "approve"))\r\n	{\r\n		_pkey_value = filterInput(request, "'+l+'", "'+p+'", true);\r\n',t.withNote&&(c+='		r_apv_note = filterInput(request, "apv_note", "FILTER_SANITIZE_SPECIAL_CHARS", true);\r\n'),c+='		ResultSet _apv_values = cms.getValues("'+i+'", "'+i+'_id", _pkey_value, "'+i+'_apv_id as apv_id, waiting_for");\r\n',c+='		if(!_apv_values.getString("apv_id").equals("0"))\r\n',c+="		{\r\n",c+='			String _apv_id = _apv_values.getString("apv_id");\r\n',c+='			if(_apv_values.getString("waiting_for").equals("1"))\r\n			{\r\n',c+="				// delete source data\r\n",c+='				cms.deleteRecord("'+i+'", "'+l+'", _pkey_value);\r\n',c+='				_query = query1.newQuery()\r\n					.update("`'+i+'_apv`")\r\n					.set("`status_approve` = \'-1\', `admin_approve_id` = \'"+_userID+"\', `ip_address_approve` = \'"+_remoteAddress+"\', `time_approve` = "+_now)\r\n					.where("`'+i+'_apv_id` = \'"+_apv_id+"\'")\r\n					.toString();\r\n',c+="				database1.execute(_query);\r\n\r\n",t.withNote&&(c+='				_query = query1.newQuery()\r\n					.update("`'+i+'_apv`")\r\n					.set("`note_approve` = \'"+r_apv_note+"\'")\r\n					.where("`'+i+'_apv_id` = \'"+_apv_id+"\'")\r\n					.toString();\r\n',c+="				database1.execute(_query);\r\n\r\n"),c+='				// cms.setRecordValue("'+i+'_apv", "'+i+'_apv_id", _apv_id, "status_approve", "-1");\r\n',c+='				// database1.executeQuery("delete from `'+i+"` where `"+l+'` = \'"+_pkey_value+"\'");\r\n',c+='				// database1.executeQuery("update `'+i+"_apv` set `status_approve` = '-1' where `"+i+'_apv_id` = \'"+_apv_id+"\'");\r\n',c+="			}\r\n",c+="			else\r\n",c+="			{\r\n",c+='				cms.setRecordValue("'+i+'_apv", "'+i+'_apv_id", _apv_id, "status_approve", "-1");\r\n',c+='				_query = query1.newQuery()\r\n					.update("`'+i+'_apv`")\r\n					.set("`status_approve` = \'-1\', `admin_approve_id` = \'"+_userID+"\', `ip_address_approve` = \'"+_remoteAddress+"\', `time_approve` = "+_now)\r\n					.where("`'+i+'_apv_id` = \'"+_apv_id+"\'")\r\n					.toString();\r\n',c+="				database1.execute(_query);\r\n\r\n",t.withNote&&(c+='				_query = query1.newQuery()\r\n					.update("`'+i+'_apv`")\r\n					.set("`note_approve` = \'"+r_apv_note+"\'")\r\n					.where("`'+i+'_apv_id` = \'"+_apv_id+"\'")\r\n					.toString();\r\n',c+="				database1.execute(_query);\r\n\r\n"),c+='				_query = query1.newQuery()\r\n					.update("'+i+'")\r\n					.set("'+i+'_apv_id = 0, waiting_for = 0")\r\n					.where("'+l+' = \'"+_pkey_value+"\'")\r\n					.toString();\r\n',c+="				database1.execute(_query);\r\n\r\n",c+="				// database1.executeQuery(_query);\r\n",c+='				// database1.executeQuery("update `'+i+"_apv` set `status_approve` = '-1' where `"+i+'_apv_id` = \'"+_apv_id+"\'");\r\n',c+="			}\r\n",c+="		}\r\n",c+='		response.sendRedirect(_self_name+"?show-only=need-approval");\r\n',c+="	}\r\n",c+="}\r\n",c+="// [REJECT END]\r\n",c+="\r\n"}c+="%>",c=(c=(c=(c=(c=(c=(c=(c=c.replaceAll("'\"+r_waktu_buat+\"'",'"+r_waktu_buat+"')).replaceAll("'\"+r_waktu_ubah+\"'",'"+r_waktu_ubah+"')).replaceAll("r_waktu_buat = ",'r_waktu_buat = "now()"; //')).replaceAll("r_waktu_ubah = ",'r_waktu_ubah = "now()"; //')).replaceAll("r_admin_buat = ",'r_admin_buat = _userID+""; //')).replaceAll("r_admin_ubah = ",'r_admin_ubah = _userID+""; //')).replaceAll("r_ip_buat = ","r_ip_buat = _remoteAddress; //")).replaceAll("r_ip_ubah = ","r_ip_ubah = _remoteAddress; //")}else if("php"==r){c+="<?php\r\n",c+="// Script Generator\r\n",c+="// Witten by Kamshory\r\n",c+="// All rights reserved\r\n",c+="// http://planetbiru.com/kamshory\r\n\r\n",c+="// declare all variables\r\n\r\n",c+='$_self_name = "'+i.replaceAll("_","-")+'.php";\r\n',c+='$_table_name = "'+i+'";\r\n',c+='$_module_name = "'+i.replaceAll("_","-")+'";\r\n',c+='$_module_title = "'+i.replaceAll("_"," ").capitalize().prettify().trim()+'";\r\n\r\n',c+='$_pkey_name = "'+l+'";\r\n',c+='$_pkey_value = "";\r\n',c+='$_na_name = "aktif";\r\n',c+="$_now = $query1->now();\r\n",c+='$_query = "";\r\n',c+='$_action = filterInput(INPUT_GET, "user_action", FILTER_SANITIZE_STRING, true);\r\n',c+='$_activate = filterInput(INPUT_POST, "data_activate", FILTER_SANITIZE_STRING, true);\r\n',c+='$_deactivate = filterInput(INPUT_POST, "data_deactivate", FILTER_SANITIZE_STRING, true);\r\n',c+='$_delete = filterInput(INPUT_POST, "data_delete", FILTER_SANITIZE_STRING, true);\r\n',c+='$_save = filterInput(INPUT_POST, "button_save", FILTER_SANITIZE_STRING, true);\r\n',c+='$_show_only = filterInput(INPUT_GET, "show-only", FILTER_SANITIZE_SPECIAL_CHARS, true);\r\n\r\n',c+="// You can comment two lines below in case you don't want to use it.\r\n",c+="$_permission = $cms->getPermission($_userLevel, $_module_name);\r\n",c+='if($_permission == "")\r\n',c+="{\r\n",c+='	include_once dirname(__FILE__)."/lib.inc/forbidden.php";\r\n',c+="	exit();\r\n",c+="}\r\n",c+="$cms->createUserLog($_POST, $_userID, $_module_name, $_action);\r\n\r\n",c+="$int_i = 0; $int_j = 0; $int_k = 0;\r\n";var u=getInsertFields(e),f=getUpdateFields(e),h=arrayUnique(u.concat(f));for(n in h)c+="$r_"+h[n]+' = "";\r\n';for(n in t.withNote&&(c+='$r_apv_note = "";\r\n'),c+="\r\n",c+="if(isset($_POST['special_action']))\r\n{\r\n	if(@$_POST['special_action'] == 'save-order')\r\n	{\r\n		$sort_data = trim(@$_POST['sort_data']);\r\n		$sort_offset = 1*trim(@$_POST['offset']);\r\n		$arr = explode(\",\", $sort_data);\r\n		if(count($arr))\r\n		{\r\n			foreach($arr as $key=>$val)\r\n			{\r\n				$sort_order = $key + $sort_offset + 1;\r\n				$_query = $query1->newQuery()\r\n						->update(\"`$_table_name`\")\r\n						->set(\"`sort_order` = $sort_order\")\r\n						->where(\"`$_pkey_name` = '$val'\")\r\n						->toString();\r\n				$db_rs = $database1->prepare($_query);\r\n				$db_rs->execute();\r\n			}\r\n		}\r\n		exit();\r\n	}\r\n}\r\n",c+='if($_action == ("insert") || $_action == ("update")) \r\n{\r\n',h)d=getSelectedFilterType(e,h[n]),c+="	$r_"+h[n]+' = filterInput(INPUT_POST, "'+h[n]+'", '+d+", true);\r\n";for(n in t.withNote&&(c+='	$r_apv_note = filterInput(INPUT_POST, "apv_note", FILTER_SANITIZE_SPECIAL_CHARS, true);\r\n'),c+="}\r\n\r\n",o=[],u)o[n]="$r_"+u[n];if(c+="// [INSERT BEGIN]\r\n",c+="// TODO: Here are your code to insert data to database\r\n",c+='if($_action == ("insert") && $_save != "") \r\n{\r\n',c+='	if(false !== stripos($_permission, "insert"))\r\n	{\r\n',c+='		$_query = $query1->newQuery()\r\n			->insert()\r\n			->into("`'+i+'`")\r\n			->fields("(`'+u.join("`, `")+'`)")\r\n			->values("(\'".'+o.join(".\"', '\".")+'."\')")\r\n			->toString();\r\n',c+="		$db_rs = $database1->prepare($_query);\r\n",c+="		$db_rs->execute();\r\n\r\n",c+="		$newID = $cms->getLastID();\r\n",t.withApproval){var v=u,m=o;t.withNote&&(v.push("note_create"),m.push("$r_apv_note")),c+="\r\n",c+="		// [NEED APPROVAL BEGIN]",c+="\r\n",-1==$.inArray(i+"_id",v)&&(v.push(i+"_id"),m.push("$newID")),c+='		$_query = $query1->newQuery()\r\n			->insert()\r\n			->into("`'+i+'_apv`")\r\n			->fields("(`'+v.join("`, `")+'`)")\r\n			->values("(\'".'+m.join(".\"', '\".")+'."\')")\r\n			->toString();\r\n',c+="		$db_rs = $database1->prepare($_query);\r\n",c+="		$db_rs->execute();\r\n\r\n",c+="		$newApvID = $cms->getLastID();\r\n",c+='		$_query = $query1->newQuery()\r\n			->update("`'+i+"_apv`\")\r\n			->set(\"`admin_buat` = '\".$_userID.\"', `waktu_buat` = \".$_now.\", `ip_buat` = '\".$_remoteAddress.\"', `status_data` = '1', `status_approve` = '0', `"+l+'` = \'".$newID."\'")\r\n			->where("`'+i+'_apv_id` = \'".$newApvID."\'")\r\n			->toString();\r\n',c+="		$db_rs = $database1->prepare($_query);\r\n",c+="		$db_rs->execute();\r\n\r\n",c+='		$_query = $query1->newQuery()\r\n			->update("`'+i+'`")\r\n			->set("`draft` = 1, `waiting_for` = 1, `'+i+'_apv_id` = \'".$newApvID."\'")\r\n			->where("`'+l+'` = \'".$newID."\'")	\n			->toString();\r\n',c+="		$db_rs = $database1->prepare($_query);\r\n",c+="		$db_rs->execute();\r\n\r\n",t.withNote&&(c+='		$_query = $query1->newQuery()\r\n			->update("`'+i+'_apv`")\r\n			->set("`note_create` = \'".$r_apv_note."\', ")\r\n			->where("`'+i+'_apv_id` = \'".$newApvID."\'")\r\n			->toString();\r\n',c+="		$db_rs = $database1->prepare($_query);\r\n",c+="		$db_rs->execute();\r\n\r\n"),c+="		// [NEED APPROVAL END]",c+="\r\n",c+="\r\n"}for(n in c+='		header("Location: ".$_self_name."?user_action=detail&'+l+'=".$newID);\r\n',c+="	}\r\n",c+="	else\r\n	{\r\n		// TODO: add your code here when user does not have permission to insert new data\r\n\r\n	}\r\n",c+="}\r\n",c+="// [INSERT END]\r\n",c+="\r\n\r\n",o=[],f)o[n]="r_"+f[n];if(c+="// [UPDATE BEGIN]\r\n",c+="// TODO: Here are your code to update data to database\r\n",c+='if($_action == ("update") && $_save != "") \r\n{\r\n',c+='	if(false !== stripos($_permission, "update"))\r\n	{\r\n',c+='		$_pkey_value = filterInput(INPUT_GET, "'+l+'", '+p+", true);\r\n",t.withApproval){var y=f,b=o;-1==y.indexOf(l)&&(y.push(l),b.push("_pkey_value")),c+="\r\n",c+="		// [NEED APPROVAL BEGIN]",c+="\r\n",c+='		$_query = $query1->newQuery()\r\n			->insert()\r\n			->into("`'+i+'_apv`")\r\n			->fields("(`'+y.join("`, `")+'`)")\r\n			->values("(\'".$'+b.join(".\"', '\".$")+'."\')")\r\n			->toString();\r\n',c+="		$db_rs = $database1->prepare($_query);\r\n",c+="		$db_rs->execute();\r\n\r\n",c+="		$newApvIDForEdit = $cms->getLastID();\r\n",c+='		$_query = $query1->newQuery()\r\n			->update("`'+i+'`")\r\n			->set("`waiting_for` = 2, `'+i+'_apv_id` = \'".$newApvIDForEdit."\'")\r\n			->where("`'+l+'` = \'".$_pkey_value."\'")\r\n			->toString();\r\n',c+="		$db_rs = $database1->prepare($_query);\r\n",c+="		$db_rs->execute();\r\n\r\n",c+='		$_query = $query1->newQuery()\r\n			->update("`'+i+"_apv`\")\r\n			->set(\"`admin_buat_id` = '\".$_userID.\"', `waktu_buat` = \".$_now.\", `ip_buat` = '\".$_remoteAddress.\"', `status_data` = '0', `status_approve` = '0', `"+l+'` = \'".$_pkey_value."\'")\r\n			->where("`'+i+'_apv_id` = \'".$newApvIDForEdit."\'")\r\n			->toString();\r\n',c+="		$db_rs = $database1->prepare($_query);\r\n",c+="		$db_rs->execute();\r\n",t.withNote&&(c+='		$_query = $query1->newQuery()\r\n			->update("`'+i+'_apv`")\r\n			->set("`note_create` = \'".$r_apv_note."\'")\r\n			->where("`'+i+'_apv_id` = \'".$newApvIDForEdit."\'")\r\n			->toString();\r\n',c+="		$database1->prepare($_query);\r\n",c+="		$db_rs->execute();\r\n\r\n"),c+="		// [NEED APPROVAL END]",c+="\r\n",c+="\r\n"}else{var g=[];for(n in f)g.push("`"+f[n]+"` = '\".$r_"+f[n]+".\"'");c+='		$_query = $query1->newQuery()\r\n			->update("`'+i+'`")\r\n			->set("'+g.join(", ")+'")\r\n			->where("`'+l+'` = \'".$_pkey_value."\'")\r\n			->toString();\r\n',c+="		$db_rs = $database1->prepare($_query);\r\n",c+="		$db_rs->execute();\r\n\r\n"}if(c+='		header("Location: ".$_self_name."?user_action=detail&'+l+'=".$_pkey_value);\r\n',c+="	}\r\n",c+="	else\r\n	{\r\n		// TODO: add your code here when user does not have permission to update data\r\n\r\n	}\r\n",c+="}\r\n",c+="// [UPDATE END]\r\n",c+="\r\n\r\n",c+="// [ACTIVATE BEGIN]\r\n",c+="// TODO: Here are your code to activate selected data\r\n",c+="//       You can add filter here or modify the default code\r\n",c+='if($_activate != "")  \r\n{\r\n',c+='	if(false !== stripos($_permission, "update"))\r\n	{\r\n',c+="		try\r\n		{\r\n",c+="			$activate_key_array = $cms->getRequestArray($_POST, $_pkey_name);\r\n",c+="			for($int_i = 0; $int_i < count($activate_key_array); $int_i++)\r\n",c+="			{\r\n",t.withApproval?(c+='				$sqlCommand = $query1->newQuery()\r\n					->update("'+i+'")\r\n					->set("'+i+'_apv_id = -1, waiting_for = 3")\r\n					->where("'+l+" = '\".$cms->escapeSQL($activate_key_array[$int_i]).\"' and "+i+'_apv_id = 0")\r\n					->toString();\r\n',c+="				$db_rs = $database1->prepare($sqlCommand);\r\n",c+="				$db_rs->execute();\r\n"):c+='				$cms->setRecordValue("'+i+'", "'+l+'", $activate_key_array[$int_i], $_na_name, "1");\r\n',c+="			}\r\n",c+='			header("Location: ".$_self_name);\r\n',c+="		}\r\n",c+="		catch(Exception $e)\r\n",c+="		{\r\n",c+="		}\r\n",c+="	}\r\n",c+="	else\r\n	{\r\n		// TODO: add your code here when user does not have permission to update data\r\n\r\n	}\r\n",c+="}\r\n",c+="// [ACTIVATE END]\r\n",c+="\r\n\r\n",c+="// [DEACTIVATE BEGIN]\r\n",c+="// TODO: Here are your code to deactivate selected data\r\n",c+="//       You can add filter here or modify the default code\r\n",c+='if($_deactivate != "") \r\n{\r\n',c+='	if(false !== stripos($_permission, "update"))\r\n	{\r\n',c+="		try\r\n		{\r\n",c+="			$deactivate_key_array = $cms->getRequestArray($_POST, $_pkey_name);\r\n",c+="			for($int_i = 0; $int_i < count($deactivate_key_array); $int_i++)\r\n",c+="			{\r\n",t.withApproval?(c+='				$sqlCommand = $query1->newQuery()\r\n					->update("'+i+'")\r\n					->set("'+i+'_apv_id = -1, waiting_for = 4")\r\n					->where("'+l+" = '\".$cms->escapeSQL($deactivate_key_array[$int_i]).\"' and "+i+'_apv_id = 0")\r\n					->toString();\r\n',c+="				$db_rs = $database1->prepare($sqlCommand);\r\n",c+="				$db_rs->execute();\r\n"):c+='				$cms->setRecordValue("'+i+'", "'+l+'", $deactivate_key_array[$int_i], $_na_name, "0");\r\n',c+="			}\r\n",c+='			header("Location: ".$_self_name);\r\n',c+="		}\r\n",c+="		catch(Exception $e)\r\n",c+="		{\r\n",c+="		}\r\n",c+="	}\r\n",c+="	else\r\n	{\r\n		// TODO: add your code here when user does not have permission to update data\r\n\r\n	}\r\n",c+="}\r\n",c+="// [DEACTIVATE END]\r\n",c+="\r\n\r\n",c+="// [DELETE BEGIN]\r\n",c+="// TODO: Here are your code to deactivate selected data\r\n",c+="//       You can add filter here or modify the default code\r\n",c+='if($_delete != "") \r\n{\r\n',c+='	if(false !== stripos($_permission, "delete"))\r\n	{\r\n',c+="		try\r\n		{\r\n",c+="			$delete_key_array = $cms->getRequestArray($_POST, $_pkey_name);\r\n",c+="			for($int_i = 0; $int_i < count($delete_key_array); $int_i++)\r\n",c+="			{\r\n",t.withApproval?(c+='				$sqlCommand = $query1->newQuery()\r\n					->update("'+i+'")\r\n					->set("'+i+'_apv_id = -1, waiting_for = 5")\r\n					->where("'+l+" = '\".$cms->escapeSQL($delete_key_array[$int_i]).\"' and "+i+'_apv_id = 0")\r\n					->toString();\r\n',c+="				$db_rs = $database1->prepare($sqlCommand);\r\n",c+="				$db_rs->execute();\r\n"):(c+='				$cms->deleteRecord("'+i+'", "'+l+'", $delete_key_array[$int_i]);\r\n',t.withTrash&&(c+='				$cms->updateTrashInfo("'+i+'_trash", "'+l+'", $delete_key_array[$int_i], "'+i+'_trash_id", $_userID, $_remoteAddress);\r\n')),c+="			}\r\n",c+='			header("Location: ".$_self_name);\r\n',c+="		}\r\n",c+="		catch(Exception $e)\r\n",c+="		{\r\n",c+="		}\r\n",c+="	}\r\n",c+="	else\r\n	{\r\n		// TODO: add your code here when user does not have permission to delete data\r\n\r\n	}\r\n",c+="}\r\n",c+="// [DELETE END]\r\n",t.withApproval){var w=f.join(",");c+="\r\n",c+="\r\n",c+='// [APPROVE BEGIN]\r\nif(filterInput(INPUT_POST, "data_approve", FILTER_SANITIZE_STRING, true) != "")\r\n{\r\n	// TODO: Here are your code for approve\r\n	if(false !== stripos($_permission, "approve"))\r\n	{\r\n		$_pkey_value = filterInput(INPUT_POST, "'+l+'", '+p+", true);\r\n",t.withNote&&(c+='		$r_apv_note = filterInput(INPUT_POST, "apv_note", FILTER_SANITIZE_SPECIAL_CHARS, true);\r\n'),c+='		$_apv_values = $cms->getValues("'+i+'", "'+l+'", $_pkey_value, "'+i+'_apv_id as apv_id, waiting_for");\r\n		if(@$_apv_values["apv_id"] != "0")\r\n		{\r\n',c+='			$_apv_id = $_apv_values["apv_id"];\r\n',c+='			if(@$_apv_values["waiting_for"] == "1")\r\n			{\r\n',c+='				$_query = $query1->newQuery()\r\n					->update("`'+i+'`")\r\n					->set("`'+i+'_apv_id` = 0, `draft` = 0, `waiting_for` = 0")\r\n					->where("`'+l+'` = \'".$_pkey_value."\'")\r\n					->toString();\r\n',c+="				$db_rs = $database1->prepare($_query);\r\n",c+="				$db_rs->execute();\r\n\r\n",c+='				$_query = $query1->newQuery()\r\n					->update("`'+i+'_apv`")\r\n					->set("`status_approve` = \'1\', `admin_approve_id` = \'".$_userID."\', `ip_address_approve` = \'".$_remoteAddress."\', `time_approve` = ".$_now)\r\n					->where("`'+i+'_apv_id` = \'".$_apv_id."\'")\r\n					->toString();\r\n',c+="				$db_rs = $database1->prepare($_query);\r\n",c+="				$db_rs->execute();\r\n\r\n",t.withNote&&(c+='				$_query = $query1->newQuery()\r\n					->update("`'+i+'_apv`")\r\n					->set("`note_approve` = \'".$r_apv_note."\'")\r\n					->where("`'+i+'_apv_id` = \'".$_apv_id."\'")\r\n					->toString();\r\n',c+="				$db_rs = $database1->prepare($_query);\r\n",c+="				$db_rs->execute();\r\n\r\n"),c+="			}\r\n",c+='			else if(@$_apv_values["waiting_for"] == "2")\r\n			{\r\n',c+='				$cms->copyData("'+i+'_apv", "'+i+'", "'+w+'", "'+i+'_apv_id", $_apv_id, "'+l+'", $_pkey_value);\r\n',c+='				$_query = $query1->newQuery()\r\n					->update("`'+i+'_apv`")\r\n					->set("`status_approve` = \'1\', `admin_approve_id` = \'".$_userID."\', `ip_address_approve` = \'".$_remoteAddress."\', `time_approve` = ".$_now)\r\n					->where("`'+i+'_apv_id` = \'".$_apv_id."\'")\r\n					->toString();\r\n',c+="				$db_rs = $database1->prepare($_query);\r\n",c+="				$db_rs->execute();\r\n\r\n",t.withNote&&(c+='				$_query = $query1->newQuery()\r\n					->update("`'+i+'_apv`")\r\n					->set("`note_approve` = \'".$r_apv_note."\'")\r\n					->where("`'+i+'_apv_id` = \'".$_apv_id."\'")\r\n					->toString();\r\n',c+="				$db_rs = $database1->prepare($_query);\r\n",c+="				$db_rs->execute();\r\n\r\n"),c+='				$_query = $query1->newQuery()\r\n					->update("`'+i+'`")\r\n					->set("`'+i+'_apv_id` = 0, `draft` = 0, `waiting_for` = 0")\r\n					->where("`'+l+'` = \'".$_pkey_value."\'")\r\n					->toString();\r\n',c+="				$db_rs = $database1->prepare($_query);\r\n",c+="				$db_rs->execute();\r\n\r\n",c+="			}\r\n",c+='			else if(@$_apv_values["waiting_for"] == "3")\r\n			{\r\n',c+='				$_sqlCommand = $query1->newQuery()\r\n					->update("`'+i+'`")\r\n					->set("`aktif` = 1, `'+i+'_apv_id` = 0, `waiting_for` = 0 ")\r\n					->where("`'+l+'` = \'".$_pkey_value."\'")\r\n					->toString();\r\n',c+="				$db_rs = $database1->prepare($_sqlCommand);\r\n",c+="				$db_rs->execute();\r\n",c+="			}\r\n",c+='			else if(@$_apv_values["waiting_for"] == "4")\r\n			{\r\n',c+='				$_sqlCommand = $query1->newQuery()\r\n					->update("`'+i+'`")\r\n					->set("`aktif` = 0, `'+i+'_apv_id` = 0, `waiting_for` = 0 ")\r\n					->where("`'+l+'` = \'".$_pkey_value."\'")\r\n					->toString();\r\n',c+="				$db_rs = $database1->prepare($_sqlCommand);\r\n",c+="				$db_rs->execute();\r\n",c+="			}\r\n",c+='			else if(@$_apv_values["waiting_for"] == "5")\r\n			{\r\n',c+='				$_sqlCommand = $query1->newQuery()\r\n					->update("`'+i+'`")\r\n					->set("`'+i+'_apv_id` = 0, `waiting_for` = 0 ")\r\n					->where("`'+l+'` = \'".$_pkey_value."\'")\r\n					->toString();\r\n',c+="				$db_rs = $database1->prepare($_sqlCommand);\r\n",c+="				$db_rs->execute();\r\n",c+='				$cms->deleteRecord("'+i+'", "'+l+'", $_pkey_value);\r\n',t.withTrash&&(c+='				$cms->updateTrashInfo("'+i+'_trash", "'+l+'", $_pkey_value, "'+i+'_trash_id", $_userID, $_remoteAddress);\r\n'),c+="			}\r\n",c+='		}\r\n		header("Location: ".$_self_name."?show-only=need-approval");\r\n	}\r\n}\r\n// [APPROVE END]\r\n\r\n\r\n// [REJECT BEGIN]\r\nif(filterInput(INPUT_POST, "data_reject", FILTER_SANITIZE_STRING, true) != "")\r\n{\r\n	// TODO: Here are your code for approve\r\n	if(false !== stripos($_permission, "approve"))\r\n	{\r\n		$_pkey_value = filterInput(INPUT_POST, "'+l+'", "'+p+'", true);\r\n',t.withNote&&(c+='		$r_apv_note = filterInput(INPUT_POST, "apv_note", FILTER_SANITIZE_SPECIAL_CHARS, true);\r\n'),c+='		$_apv_id = $cms->getValue("'+i+'", "'+l+'", $_pkey_value, "'+i+'_apv_id");\r\n',c+='		if($_apv_id != "0")\r\n',c+="		{\r\n",c+='			$_status_data = $cms->getValue("'+i+'_apv", "'+i+'_apv_id", $_apv_id, "status_data");\r\n',c+='			if($_status_data == "1")\r\n',c+="			{\r\n",c+="				// delete source data\r\n",c+='				$cms->deleteRecord("'+i+'", "'+l+'", $_pkey_value);\r\n',c+='				$_query = $query1->newQuery()\r\n					->update("`'+i+'_apv`")\r\n					->set("`status_approve` = \'-1\', `admin_approve_id` = \'".$_userID."\', `ip_address_approve` = \'".$_remoteAddress."\', `time_approve` = ".$_now)\r\n					->where("`'+i+'_apv_id` = \'".$_apv_id."\'")\r\n					->toString();\r\n',c+="				$db_rs = $database1->prepare($_query);\r\n",c+="				$db_rs->execute();\r\n\r\n",t.withNote&&(c+='				$_query = $query1->newQuery()\r\n					->update("`'+i+'_apv`")\r\n					->set("`note_approve` = \'".$r_apv_note."\'")\r\n					->where("`'+i+'_apv_id` = \'".$_apv_id."\'")\r\n					->toString();\r\n',c+="				$db_rs = $database1->prepare($_query);\r\n",c+="				$db_rs->execute();\r\n\r\n"),c+="			}\r\n",c+="			else\r\n",c+="			{\r\n",c+='				$cms->setRecordValue("'+i+'_apv", "'+i+'_apv_id", $_apv_id, "status_approve", "-1");\r\n',c+='				$_query = $query1->newQuery()\r\n					->update("`'+i+'_apv`")\r\n					->set("`status_approve` = \'-1\', `admin_approve_id` = \'".$_userID."\', `ip_address_approve` = \'".$_remoteAddress."\', `time_approve` = ".$_now)\r\n					->where("`'+i+'_apv_id` = \'".$_apv_id."\'")\r\n					->toString();\r\n',c+="				$db_rs = $database1->prepare($_query);\r\n",c+="				$db_rs->execute();\r\n\r\n",t.withNote&&(c+='				$_query = $query1->newQuery()\r\n					->update("`'+i+'_apv`")\r\n					->set("`note_approve` = \'".$r_apv_note."\'")\r\n					->where("`'+i+'_apv_id` = \'".$_apv_id."\'")\r\n					->toString();\r\n',c+="				$db_rs = $database1->prepare($_query);\r\n",c+="				$db_rs->execute();\r\n\r\n"),c+='				$_query = $query1->newQuery()\r\n					->update("`'+i+'`")\r\n					->set("`'+i+'_apv_id` = 0, `draft` = 0, `waiting_for` = 0")\r\n					->where("`'+l+'` = \'".$_pkey_value."\'")\r\n					->toString();\r\n',c+="				$db_rs = $database1->prepare($_query);\r\n",c+="				$db_rs->execute();\r\n\r\n",c+="			}\r\n",c+="		}\r\n",c+='		header("Location: ".$_self_name."?show-only=need-approval");\r\n',c+="	}\r\n",c+="}\r\n",c+="// [REJECT END]\r\n",c+="\r\n"}c+="?>",c=(c=(c=(c=(c=(c=(c=(c=(c=(c=c.replaceAll("'\"+r_waktu_buat+\"'",'"+r_waktu_buat+"')).replaceAll("'\"+r_waktu_ubah+\"'",'"+r_waktu_ubah+"')).replaceAll("'\".$r_waktu_buat.\"'",'".$r_waktu_buat."')).replaceAll("'\".$r_waktu_ubah.\"'",'".$r_waktu_ubah."')).replaceAll("r_waktu_buat = ",'r_waktu_buat = "now()"; //')).replaceAll("r_waktu_ubah = ",'r_waktu_ubah = "now()"; //')).replaceAll("r_admin_buat = ","r_admin_buat = $_userID; //")).replaceAll("r_admin_ubah = ","r_admin_ubah = $_userID; //")).replaceAll("r_ip_buat = ","r_ip_buat = $_remoteAddress; //")).replaceAll("r_ip_ubah = ","r_ip_ubah = $_remoteAddress; //")}return c}function generateInsertUI(e,t,r){r=r||"php",(t=t||{}).withApproval=t.withApproval||!1,t.withTrash=t.withTrash||!1,t.withNote=t.withNote||!1;var n,a,i,o=getInsertFields(e),s="";getFieldValues(e,"table")[0];var l=getPrimaryKey(e);if(l.length?l[0]:o[0],"jsp"==r){for(n in s+="<%\r\n",s+='if(_action.equals("insert"))\r\n{\r\n',s+="// TODO: Here are your code for insert UI\r\n",s+='if(hasPermission(_userLevel, _module_name, "insert"))\r\n{\r\n',s+='\r\n%><%@ include file="lib.inc/header.jsp" %>\r\n',s+=templateBeforeContent(e),s+="\r\n<!-- content started here -->\r\n\r\n",s+='<form name="insertform" id="insertform" action="" method="post">\r\n',s+='<table class="responsive responsive-two-cols" border="0" cellpadding="0" cellspacing="0" width="100%">\r\n',o)i=getFieldValues(e,"caption_"+o[n]),a=generateInputForInsert(e,o[n],r),s+="	<tr>\r\n		<td>"+i+"</td>\r\n		<td>"+a+"</td>\r\n	</tr>\r\n";t.withNote&&(s+='	<tr>\r\n		<td>Catatan</td>\r\n		<td><textarea id="apv_note" name="apv_note" class="form-control"></textarea></td>\r\n	</tr>\r\n'),s+="</table>\r\n",s+='<table class="responsive responsive-two-cols responsive-button-area" border="0" cellpadding="0" cellspacing="0" width="100%">\r\n',s+="	<tr>\r\n		<td>&nbsp;</td>\r\n		<td>\r\n",s+='			<input type="submit" class="btn btn-success" id="save" name="button_save" value="Simpan">\r\n',s+='			<input type="button" class="btn btn-primary" id="showall" value="Tampilkan Semua" onclick="window.location=\'<%= _self_name %>\'">\r\n',s+="		</td>\r\n	</tr>\r\n",s+="</table>\r\n",s+="</form>\r\n",s+="\r\n<!-- content ended here -->\r\n",s+=templateAfterContent(e),s+='\r\n<%@ include file="lib.inc/footer.jsp" %>',s+="<%\r\n}\r\n",s+="else\r\n{\r\n%>",s+='<%@ include file="lib.inc/header.jsp" %>\r\n',s+=templateBeforeContent(e),s+='\r\n<!-- content started here -->\r\n\r\n	<div class="message-warning-permission"><%= error_message_permission %></div>\r\n',s+="\r\n<!-- content ended here -->\r\n",s+=templateAfterContent(e),s+='\r\n<%@ include file="lib.inc/footer.jsp" %>',s+="<%\r\n}\r\n",s+="}\r\n",s+="%>"}else if("php"==r){for(n in s+="<?php\r\n",s+='if($_action == ("insert"))\r\n{\r\n',s+="// TODO: Here are your code for insert UI\r\n",s+='if(false !== stripos($_permission, "insert"))\r\n{\r\n',s+='include_once dirname(__FILE__)."/lib.inc/header.php";\r\n',s+='include_once dirname(__FILE__)."/lib.inc/form-default-data.php";\r\n',s+='getDefaultData($database1, $_table_name, array("aktif"));\r\n',s+="?>\r\n",s+=templateBeforeContent(e),s+="\r\n<!-- content started here -->\r\n\r\n",s+='<form name="insertform" id="insertform" action="" method="post">\r\n',s+='<table class="responsive responsive-two-cols" border="0" cellpadding="0" cellspacing="0" width="100%">\r\n',o)i=getFieldValues(e,"caption_"+o[n]),a=generateInputForInsert(e,o[n],r),s+="	<tr>\r\n		<td>"+i+"</td>\r\n		<td>"+a+"</td>\r\n	</tr>\r\n";t.withNote&&(s+='	<tr>\r\n		<td>Catatan</td>\r\n		<td><textarea id="apv_note" name="apv_note" class="form-control"></textarea></td>\r\n	</tr>\r\n'),s+="</table>\r\n",s+='<table class="responsive responsive-two-cols responsive-button-area" border="0" cellpadding="0" cellspacing="0" width="100%">\r\n',s+="	<tr>\r\n		<td>&nbsp;</td>\r\n		<td>\r\n",s+='			<input type="submit" class="btn btn-success" id="save" name="button_save" value="Simpan">\r\n',s+='			<input type="button" class="btn btn-primary" id="showall" value="Tampilkan Semua" onclick="window.location=\'<?php echo $_self_name; ?>\'">\r\n',s+="		</td>\r\n	</tr>\r\n",s+="</table>\r\n",s+="</form>\r\n",s+="\r\n<!-- content ended here -->\r\n",s+=templateAfterContent(e),s+='\r\n<?php include_once dirname(__FILE__)."/lib.inc/footer.php"; ?>',s+="<?php\r\n}\r\n",s+="else\r\n{\r\n?>",s+='<?php include_once dirname(__FILE__)."/lib.inc/header.php"; ?>\r\n',s+=templateBeforeContent(e),s+='\r\n<!-- content started here -->\r\n\r\n	<div class="message-warning-permission"><?php echo $error_message_permission ?></div>\r\n',s+="\r\n<!-- content ended here -->\r\n",s+=templateAfterContent(e),s+='\r\n<?php include_once dirname(__FILE__)."/lib.inc/footer.php"; ?>',s+="<?php\r\n}\r\n",s+="}\r\n",s+=""}return s}function generateUpdateUI(e,t,r){r=r||"php",(t=t||{}).withApproval=t.withApproval||!1,t.withTrash=t.withTrash||!1,t.withNote=t.withNote||!1;var n,a,i,o=getUpdateFields(e),s="",l="",p=getFieldValues(e,"table")[0],d=getPrimaryKey(e),c=d.length?d[0]:o[0],u=getSelectedFilterType(e,c);if("jsp"==r){for(n in s+='<%\r\nelse if(_action.equals("update"))\r\n{\r\n',s+="// TODO: Here are your code for update UI\r\n",s+='if(hasPermission(_userLevel, _module_name, "update"))\r\n{\r\n',s+='String _id = filterInput(request, "'+c+'", "'+u+'", true);\r\n',s+="JSONObject _result = null;\r\n\r\n",o)s+="String d_"+(l=o[n])+' = "";\r\n';for(n in s+="int _apv_id = 0;\r\n",s+="int _waiting_for = 0;\r\n",s+='\r\n_query = "select `'+p+"`.* from `"+p+"` where `"+c+'` = \'"+_id+"\'";\r\n',s+='\r\n_query = query1.newQuery()\r\n	.select("`'+p+'`.*")\r\n	.from("`'+p+'`")\r\n	.where("`'+c+'` = \'"+_id+"\'")\r\n	.toString();\r\n',s+="\r\ntry\r\n{\r\n",s+="db_rs = database1.executeQuery(_query);\r\n\r\n",s+="if(db_rs.isBeforeFirst())\r\n{\r\n",s+="db_rs.next();\r\n",o)s+="d_"+(l=o[n])+' = db_rs.getString("'+l+'");\r\n';for(n in s+='_apv_id = db_rs.getInt("'+p+'_apv_id");\r\n',s+='_waiting_for = db_rs.getInt("waiting_for");\r\n',s+='\r\n%><%@ include file="lib.inc/header.jsp" %>\r\n',s+=templateBeforeContent(e),s+="\r\n<!-- content started here -->\r\n\r\n",t.withApproval&&(s+="<%\r\n",s+="if(_waiting_for != 0)\r\n",s+="{\r\n",s+="%>\r\n",s+='	<div class="message-warning-require-approval"><%= approval_waiting_message.get("message"+_waiting_for).toString() %></div>\r\n',s+="<%\r\n",s+="}\r\n",s+="else\r\n",s+="{\r\n",s+="%>\r\n"),s+='<form name="editform" id="editform" action="" method="post">\r\n',s+='<table class="responsive responsive-two-cols" border="0" cellpadding="0" cellspacing="0" width="100%">\r\n',o)i=getFieldValues(e,"caption_"+o[n]),a=generateInputForUpdate(e,o[n],r),s+="	<tr>\r\n		<td>"+i+"</td>\r\n		<td>"+a+"</td>\r\n	</tr>\r\n";t.withNote&&(s+='	<tr>\r\n		<td>Catatan</td>\r\n		<td><textarea id="apv_note" name="apv_note" class="form-control"></textarea></td>\r\n	</tr>\r\n'),s+="</table>\r\n",s+='<table class="responsive responsive-two-cols responsive-button-area" border="0" cellpadding="0" cellspacing="0" width="100%">\r\n',s+="	<tr>\r\n		<td>&nbsp;</td>\r\n		<td>\r\n",s+='			<input type="submit" class="btn btn-success" id="save" name="button_save" value="Simpan">\r\n',s+='			<input type="button" class="btn btn-primary" id="showall" value="Tampilkan Semua" onclick="window.location=\'<%= _self_name %>\'">\r\n',s+="		</td>\r\n	</tr>\r\n",s+="</table>\r\n",s+="</form>\r\n",t.withApproval&&(s+="<%\r\n",s+="}\r\n",s+="%>\r\n"),s+="\r\n<!-- content ended here -->\r\n",s+=templateAfterContent(e),s+='\r\n<%@ include file="lib.inc/footer.jsp" %>',s+="<%\r\n}\r\nelse\r\n{\r\n",s+='%>\r\n<%@ include file="lib.inc/header.jsp" %>\r\n',s+=templateBeforeContent(e),s+='	<div class="alert alert-not-found"><%= pagination_data_not_found %></div>\r\n',s+=templateAfterContent(e),s+='<%@ include file="lib.inc/footer.jsp" %>',s+="\r\n<%",s+="\r\n}\r\n%>",s+="<%\r\n}\r\ncatch(Exception e)\r\n{\r\n",s+="// Catch\r\n",s+="}\r\nfinally\r\n{\r\n",s+="// Finnaly\r\n",s+="}\r\n%>\r\n",s+="<%\r\n}\r\n",s+="else\r\n{\r\n%>",s+='<%@ include file="lib.inc/header.jsp" %>\r\n',s+=templateBeforeContent(e),s+='\r\n<!-- content started here -->\r\n\r\n	<div class="message-warning-permission"><%= error_message_permission %></div>\r\n',s+="\r\n<!-- content ended here -->\r\n",s+=templateAfterContent(e),s+='\r\n<%@ include file="lib.inc/footer.jsp" %>',s+="<%\r\n}\r\n",s+="}\r\n",s+="%>"}else if("php"==r){for(n in s+='\r\nelse if($_action == ("update"))\r\n{\r\n',s+="// TODO: Here are your code for update UI\r\n",s+='if(false !== stripos($_permission, "update"))\r\n{\r\n',s+='$_id = filterInput(INPUT_GET, "'+c+'", '+u+", true);\r\n",s+="$_result = null;\r\n\r\n",o)s+="$d_"+(l=o[n])+' = "";\r\n';for(n in s+='\r\n$_query = "select `'+p+"`.* from `"+p+"` where `"+c+'` = \'".$_id."\'";\r\n',s+='\r\n$_query = $query1->newQuery()\r\n	->select("`'+p+'`.*")\r\n	->from("`'+p+'`")\r\n	->where("`'+c+'` = \'".$_id."\'")\r\n	->toString();\r\n',s+="\r\ntry\r\n{\r\n",s+="$db_rs = $database1->prepare($_query);\r\n",s+="$db_rs->execute();\r\n\r\n",s+="if($db_rs->rowCount())\r\n{\r\n",s+="$db_data = $db_rs->fetch(PDO::FETCH_ASSOC);\r\n",o)s+="$d_"+(l=o[n])+' = $db_data["'+l+'"];\r\n';for(n in s+='$d_apv_id = $db_data["'+p+'_apv_id"];\r\n',s+='$d_waiting_for = $db_data["waiting_for"];\r\n',s+='\r\n?><?php include_once dirname(__FILE__)."/lib.inc/header.php"; ?>\r\n',s+=templateBeforeContent(e),s+="\r\n<!-- content started here -->\r\n\r\n",t.withApproval&&(s+="<?php\r\n",s+="if($d_apv_id != 0)\r\n",s+="{\r\n",s+="?>\r\n",s+='	<div class="message-warning-require-approval"><?php echo $approval_waiting_message[$d_waiting_for];?></div>\r\n',s+="<?php\r\n",s+="}\r\n",s+="else\r\n",s+="{\r\n",s+="?>\r\n"),s+='<form name="editform" id="editform" action="" method="post">\r\n',s+='<table class="responsive responsive-two-cols" border="0" cellpadding="0" cellspacing="0" width="100%">\r\n',o)i=getFieldValues(e,"caption_"+o[n]),a=generateInputForUpdate(e,o[n],r),s+="	<tr>\r\n		<td>"+i+"</td>\r\n		<td>"+a+"</td>\r\n	</tr>\r\n";t.withNote&&(s+='	<tr>\r\n		<td>Catatan</td>\r\n		<td><textarea id="apv_note" name="apv_note" class="form-control"></textarea></td>\r\n	</tr>\r\n'),s+="</table>\r\n",s+='<table class="responsive responsive-two-cols responsive-button-area" border="0" cellpadding="0" cellspacing="0" width="100%">\r\n',s+="	<tr>\r\n		<td>&nbsp;</td>\r\n		<td>\r\n",s+='			<input type="submit" class="btn btn-success" id="save" name="button_save" value="Simpan">\r\n',s+='			<input type="button" class="btn btn-primary" id="showall" value="Tampilkan Semua" onclick="window.location=\'<?php echo $_self_name; ?>\'">\r\n',s+="		</td>\r\n	</tr>\r\n",s+="</table>\r\n",s+="</form>\r\n",t.withApproval&&(s+="<?php\r\n",s+="}\r\n",s+="?>\r\n"),s+="\r\n<!-- content ended here -->\r\n",s+=templateAfterContent(e),s+='\r\n<?php include_once dirname(__FILE__)."/lib.inc/footer.php"; ?>',s+="<?php\r\n}\r\nelse\r\n{\r\n",s+='?>\r\n<?php include_once dirname(__FILE__)."/lib.inc/header.php"; ?>\r\n',s+=templateBeforeContent(e),s+='	<div class="alert alert-not-found"><?php echo $pagination_data_not_found; ?></div>\r\n',s+=templateAfterContent(e),s+='<?php include_once dirname(__FILE__)."/lib.inc/footer.php"; ?>',s+="\r\n<?php",s+="\r\n}\r\n?>",s+="<?php\r\n}\r\ncatch(Exception $e)\r\n{\r\n",s+="// Catch\r\n",s+="}\r\n?>\r\n",s+="<?php\r\n}\r\n",s+="else\r\n{\r\n?>",s+='<?php include_once dirname(__FILE__)."/lib.inc/header.php"; ?>\r\n',s+=templateBeforeContent(e),s+='\r\n<!-- content started here -->\r\n\r\n	<div class="message-warning-permission"><?php echo $error_message_permission; ?></div>\r\n',s+="\r\n<!-- content ended here -->\r\n",s+=templateAfterContent(e),s+='\r\n<?php include_once dirname(__FILE__)."/lib.inc/footer.php"; ?>',s+="<?php\r\n}\r\n",s+="}\r\n",s+=""}return s}function generateDetailUI(e,t,r){r=r||"php",(t=t||{}).withApproval=t.withApproval||!1,t.withTrash=t.withTrash||!1,t.withNote=t.withNote||!1;var n,a,i=getDetailFields(e),o=[],s="",l="",p="",d="",c="",u=getFieldValues(e,"table")[0],f=getPrimaryKey(e),h=f.length?f[0]:i[0],v=getSelectedFilterType(e,h),m="",y="",b="",g=[],w=[],I="",T="";if("jsp"==r){d+='<%\r\nelse if(_action.equals("detail"))\r\n{\r\n',d+="// TODO: Here are your code for detail UI\r\n",d+='String _queryApv = "";\r\n',d+='String _next = filterInput(request, "next", "FILTER_SANITIZE_STRING", true);\r\n',d+='if(hasPermission(_userLevel, _module_name, "detail"))\r\n{\r\n',d+='String _id = filterInput(request, "'+h+'", "'+v+'", true);\r\n',d+="JSONObject _result = null;\r\n\r\n";var S=[],q="";for(n in t.withNote&&(d+='String d_note_create = "";\r\n',d+='String d_note_approve = "";\r\n'),t.withApproval&&(d+="int d_apv_id = 0;\r\n",d+="int d_waiting_for = 0;\r\n",S.push("`"+u+"`.`"+u+"_apv_id`"),S.push("`"+u+"`.`waiting_for`")),i)d+="String d_"+(c=i[n])+' = "";\r\n',"select"==(s=getSelectedElementType(e,c))?((p=c).length>3&&(p=p.substr(0,p.length-3)),l="(select `"+p+"`.`nama` from `"+p+"` where `"+p+"`.`"+c+"` = `"+u+"`.`"+c+"`) as `"+c+"`",o.push(l),l="(select `"+p+"`.`nama` from `"+p+"` where `"+p+"`.`"+c+"` = `"+u+"_apv`.`"+c+"`) as `"+c+"`",g.push(l)):(S.push("`"+u+"`.`"+c+"`"),w.push("`"+u+"_apv`.`"+c+"`"));for(n in t.withNote&&w.push("coalesce(`"+u+"_apv`.`note_create`, '') as `note_create`"),l=o.length?', "+\r\n"'+o.join(', "+\r\n"')+' "+\r\n"':" ",T=g.length?', "+\r\n"'+g.join(', "+\r\n"')+' "+\r\n"':" ",q=S.join(", "),I=w.join(", "),d+="\r\n",d+='_query = query1.newQuery()\r\n	.select("'+q+l+'")\r\n	.from("`'+u+'`")\r\n	.where("`'+h+'` = \'"+_id+"\'")\r\n	.toString();\r\n',d+="\r\ntry\r\n{\r\n",d+="\r\ndb_rs = database1.executeQuery(_query);\r\n\r\n",d+="if(db_rs.isBeforeFirst())\r\n{\r\n",d+="db_rs.next();\r\n",t.withApproval&&(d+='d_apv_id = db_rs.getInt("'+u+'_apv_id");\r\n',d+='d_waiting_for = db_rs.getInt("waiting_for");\r\n'),i)d+="d_"+(c=i[n])+' = db_rs.getString("'+c+'");\r\n';if(d+='\r\n%><%@ include file="lib.inc/header.jsp" %>\r\n',d+=templateBeforeContent(e),d+="\r\n<!-- content started here -->\r\n\r\n",d+='<form name="detailform" id="detailform" action="" method="post">\r\n',t.withApproval){for(n in d+="<%\r\n",d+="ResultSet _apvData = null;\r\n",d+="boolean _needApproval = false;\r\n",d+="if(d_apv_id > 0)\r\n",d+="{\r\n",d+='_queryApv = query1.newQuery()\r\n	.select("'+I+T+'")\r\n	.from("`'+u+'_apv`")\r\n	.where("`'+u+'_apv_id` = \'"+d_apv_id+"\'")\r\n	.toString();\r\n',d+="_apvData = cms.getRecord(_queryApv);\r\n",d+="if(_apvData != null)\r\n",d+="{\r\n",d+="	_needApproval = true;\r\n",d+="}\r\n",d+="}\r\n",d+="\r\n",d+='if(d_apv_id > 0 && !_next.equals(""))\r\n',d+="{\r\n",d+="%>\r\n",d+='<script type="text/javascript">\r\n',d+="	$(document).ready(function(){\r\n",d+="	compareData('.responsive-three-cols');\r\n",d+="});\r\n",d+="</script>\r\n",d+='<table class="responsive responsive-three-cols" border="0" cellpadding="0" cellspacing="0" width="100%">\r\n',d+='	<tr class="row-label-three-cols">\r\n',d+="		<td><span>Label</span></td>\r\n",d+="		<td><span>Current Data</span></td>\r\n",d+="		<td><span>Draft</span></td>\r\n",d+="	</tr>\r\n",i)a=getFieldValues(e,"caption_"+i[n]),"checkbox"==(b=getSelectedElementType(e,i[n]))?(m="(d_"+i[n]+' == null)?"Tidak":((d_'+i[n]+'.equals("1"))?"Ya":"Tidak")',y='(_apvData.getString("'+i[n]+'") == null)?"Tidak":((_apvData.getString("'+i[n]+'").equals("1"))?"Ya":"Tidak")'):(m="d_"+i[n],y='_apvData.getString("'+i[n]+'")'),d+="	<tr>\r\n",d+="		<td><span>"+a+"</span></td>\r\n",d+='		<td><span class="compare"><%= '+m+" %></span></td>\r\n",d+='		<td><span class="compare"><%= '+y+" %></span></td>\r\n",d+="	</tr>\r\n";t.withNote&&(d+='	<%\r\n	d_note_create = _apvData.getString("note_create");\r\n	%>\r\n	<tr>\r\n		<td>Catatan</td>\r\n		<td><textarea id="apv_note" name="apv_note" class="form-control ta-min-10" placeholder="Approval note here..."></textarea></td>\r\n		<td><textarea class="form-control ta-min-10" readonly="readonly"><%= escapeHTML(d_note_create) %></textarea></td>\r\n	</tr>\r\n'),d+="</table>\r\n",d+="<%\r\n",d+="}\r\n",d+="else\r\n",d+="{\r\n",d+="%>\r\n"}for(n in d+="<%\r\n",d+='if(d_waiting_for > 0 && !_next.equals(""))\r\n',d+="{\r\n",d+="%>\r\n",d+='	<div class="message-warning-require-approval"><%= approval_waiting_message.get("message"+d_waiting_for).toString() %></div>\r\n',d+="<%\r\n",d+="}\r\n",d+="%>\r\n",d+='<table class="responsive responsive-two-cols" border="0" cellpadding="0" cellspacing="0" width="100%">\r\n',i)a=getFieldValues(e,"caption_"+i[n]),m="checkbox"==(b=getSelectedElementType(e,i[n]))?"(d_"+i[n]+' == null)?"Tidak":((d_'+i[n]+'.equals("1"))?"Ya":"Tidak")':"d_"+i[n],d+="	<tr>\r\n",d+="		<td>"+a+"</td>\r\n",d+="		<td><%= "+m+" %></td>\r\n",d+="	</tr>\r\n";d+="</table>\r\n",t.withApproval&&(d+="<%\r\n",d+="}\r\n",d+="%>\r\n"),d+='<table class="responsive responsive-two-cols responsive-button-area" border="0" cellpadding="0" cellspacing="0" width="100%">\r\n',d+="	<tr>\r\n		<td>&nbsp;</td>\r\n		<td>\r\n",t.withApproval&&(d+="<%\r\n",d+='if(d_waiting_for != 0 && !_next.equals("") && hasPermission(_userLevel, _module_name, "approve"))\r\n',d+="{\r\n",d+='	if(!_next.equals(""))\r\n	{\r\n		if(!_next.equals("reject"))\r\n		{\r\n%>\r\n',d+='			<input type="button" class="btn btn-success" id="approve" name="button_approve" value="Approve" onclick="approveData(\'<%= _self_name %>\', \''+h+"', '<%= _id %>', $('#apv_note').val())\">\r\n",d+="<%\r\n		}\r\n",d+='		if(!_next.equals("approve"))\r\n		{\r\n%>\r\n',d+='			<input type="button" class="btn btn-danger" id="reject" name="button_reject" value="Reject" onclick="rejectData(\'<%= _self_name %>\', \''+h+"', '<%= _id %>', $('#apv_note').val())\">\r\n",d+="<%\r\n		}\r\n	}\r\n",d+="}\r\n",d+='else if(hasPermission(_userLevel, _module_name, "update"))\r\n',d+="{\r\n",d+="%>\r\n",d+='			<input type="button" class="btn btn-success" id="edit" name="button_edit" value="Ubah" onclick="window.location=\'<%= _self_name %>?user_action=update&'+h+"=<%= _id %>'\">\r\n",d+="<%\r\n",d+="}\r\n",d+="%>\r\n"),d+='			<input type="button" class="btn btn-primary" id="showall" value="Tampilkan Semua" onclick="window.location=\'<%= _self_name %>\'">\r\n',d+="		</td>\r\n	</tr>\r\n",d+="</table>\r\n",d+="</form>\r\n",d+="\r\n<!-- content ended here -->\r\n",d+=templateAfterContent(e),d+='\r\n<%@ include file="lib.inc/footer.jsp" %>',d+="<%\r\n}\r\nelse\r\n{\r\n",d+='%>\r\n<%@ include file="lib.inc/header.jsp" %>\r\n',d+=templateBeforeContent(e),d+='	<div class="alert alert-not-found"><%= pagination_data_not_found %></div>\r\n',d+=templateAfterContent(e),d+='<%@ include file="lib.inc/footer.jsp" %>',d+="\r\n<%",d+="\r\n}\r\n%>",d+="<%\r\n}\r\ncatch(Exception e)\r\n{\r\n",d+="// Catch\r\n",d+="}\r\nfinally\r\n{\r\n",d+="// Finnaly\r\n",d+="}\r\n%>\r\n",d+="<%\r\n}\r\n",d+="else\r\n{\r\n%>",d+='<%@ include file="lib.inc/header.jsp" %>\r\n',d+=templateBeforeContent(e),d+='\r\n<!-- content started here -->\r\n\r\n	<div class="message-warning-permission"><%= error_message_permission %></div>\r\n',d+="\r\n<!-- content ended here -->\r\n",d+=templateAfterContent(e),d+='\r\n<%@ include file="lib.inc/footer.jsp" %>',d+="<%\r\n}\r\n",d+="}\r\n",d+="%>"}else if("php"==r){d+='\r\nelse if($_action == ("detail"))\r\n{\r\n',d+="// TODO: Here are your code for detail UI\r\n",d+='$_queryApv = "";\r\n',d+='$_next = filterInput(INPUT_GET, "next", FILTER_SANITIZE_STRING, true);\r\n',d+='if(false !== stripos($_permission, "detail"))\r\n{\r\n',d+='$_id = filterInput(INPUT_GET, "'+h+'", '+v+", true);\r\n",d+="$_result = null;\r\n\r\n";var S=[],q="";for(n in t.withNote&&(d+='$d_note_create = "";\r\n',d+='$d_note_approve = "";\r\n'),t.withApproval&&(d+="$d_"+u+'_apv_id = "";\r\n',d+='$d_waiting_for = "";\r\n',S.push("coalesce(`"+u+"`.`"+u+"_apv_id`, 0) as `"+u+"_apv_id`"),S.push("coalesce(`"+u+"`.`waiting_for`, 0) as `waiting_for`")),i)d+="$d_"+(c=i[n])+' = "";\r\n',"select"==(s=getSelectedElementType(e,c))?((p=c).length>3&&(p=p.substr(0,p.length-3)),l="(select `"+p+"`.`nama` from `"+p+"` where `"+p+"`.`"+c+"` = `"+u+"`.`"+c+"`) as `"+c+"`",o.push(l),l="(select `"+p+"`.`nama` from `"+p+"` where `"+p+"`.`"+c+"` = `"+u+"_apv`.`"+c+"`) as `"+c+"`",g.push(l)):(S.push("`"+u+"`.`"+c+"`"),w.push("`"+u+"_apv`.`"+c+"`"));for(n in t.withApproval&&(S.push("`"+u+"`.`waiting_for`"),S.push("`"+u+"`.`"+u+"_apv_id`")),t.withNote&&w.push("coalesce(`"+u+"_apv`.`note_create`, '') as `note_create`"),l=o.length?', ".\r\n"'+o.join(', ".\r\n"')+' ".\r\n"':" ",T=g.length?', ".\r\n"'+g.join(', ".\r\n"')+' ".\r\n"':" ",q=S.join(", "),I=w.join(", "),d+="\r\n",d+='$_query = $query1->newQuery()\r\n	->select("'+q+l+'")\r\n	->from("`'+u+'`")\r\n	->where("`'+h+'` = \'".$_id."\'")\r\n	->toString();\r\n',d+="\r\ntry\r\n{\r\n",d+="\r\n$db_rs = $database1->prepare($_query);\r\n",d+="\r\n$db_rs->execute();\r\n\r\n",d+="if($db_rs->rowCount())\r\n{\r\n",d+="$db_data = $db_rs->fetch(PDO::FETCH_ASSOC);\r\n",t.withApproval&&(d+="$d_"+u+'_apv_id = $db_data["'+u+'_apv_id"];\r\n',d+='$d_waiting_for = $db_data["waiting_for"];\r\n'),i)d+="$d_"+(c=i[n])+' = $db_data["'+c+'"];\r\n';if(d+='\r\n?><?php include_once dirname(__FILE__)."/lib.inc/header.php"; ?>\r\n',d+=templateBeforeContent(e),d+="\r\n<!-- content started here -->\r\n\r\n",d+='<form name="detailform" id="detailform" action="" method="post">\r\n',t.withApproval){for(n in d+="<?php\r\n",d+="$_apvData = null;\r\n",d+="$_needApproval = false;\r\n",d+='$_apv_id = $cms->getValue("'+u+'", "'+h+'", $_id, "'+u+'_apv_id");\r\n',d+="if($_apv_id == null) $_apv_id = 0;\r\n",d+="if($_apv_id > 0)\r\n",d+="{\r\n",d+='$_queryApv = $query1->newQuery()\r\n	->select("'+I+T+'")\r\n	->from("`'+u+'_apv`")\r\n	->where("`'+u+'_apv_id` = \'".$_apv_id."\'")\r\n	->toString();\r\n',d+="$_apvData = $cms->getRecord($_queryApv);\r\n",d+="if($_apvData != null)\r\n",d+="{\r\n",d+="	$_needApproval = true;\r\n",d+="}\r\n",d+="}\r\n",d+="\r\n",d+='if($_needApproval && $_next != "")\r\n',d+="{\r\n",d+="?>\r\n",d+='<script type="text/javascript">\r\n',d+="	$(document).ready(function(){\r\n",d+="	compareData('.responsive-three-cols');\r\n",d+="});\r\n",d+="</script>\r\n",d+='<table class="responsive responsive-three-cols" border="0" cellpadding="0" cellspacing="0" width="100%">\r\n',d+='	<tr class="row-label-three-cols">\r\n',d+="		<td><span>Label</span></td>\r\n",d+="		<td><span>Current Data</span></td>\r\n",d+="		<td><span>Draft</span></td>\r\n",d+="	</tr>\r\n",i)a=getFieldValues(e,"caption_"+i[n]),"checkbox"==(b=getSelectedElementType(e,i[n]))?(m="($d_"+i[n]+' == "1")?"Ya":"Tidak"',y='($_apvData["'+i[n]+'"] == "1")?"Ya":"Tidak"'):(m="$d_"+i[n],y='$_apvData["'+i[n]+'"]'),d+="	<tr>\r\n",d+="		<td><span>"+a+"</span></td>\r\n",d+='		<td><span class="compare"><?php echo '+m+"; ?></span></td>\r\n",d+='		<td><span class="compare"><?php echo '+y+"; ?></span></td>\r\n",d+="	</tr>\r\n";t.withNote&&(d+='	<?php\r\n	$d_note_create = $_apvData["note_create"];\r\n	?>\r\n	<tr>\r\n		<td>Catatan</td>\r\n		<td><textarea id="apv_note" name="apv_note" class="form-control ta-min-10" placeholder="Approval note here..."></textarea></td>\r\n		<td><textarea class="form-control ta-min-10" readonly="readonly"><?php echo $cms->escapeHTML($d_note_create); ?></textarea></td>\r\n	</tr>\r\n'),d+="</table>\r\n",d+="<?php\r\n",d+="}\r\n",d+="else\r\n",d+="{\r\n",d+='if($d_waiting_for > 0 && $_next != "")\r\n',d+="{\r\n",d+="?>\r\n",d+='	<div class="message-warning-require-approval"><?php echo $approval_waiting_message[$d_waiting_for];?></div>\r\n',d+="<?php\r\n",d+="}\r\n",d+="?>\r\n"}for(n in d+='<table class="responsive responsive-two-cols" border="0" cellpadding="0" cellspacing="0" width="100%">\r\n',i)a=getFieldValues(e,"caption_"+i[n]),m="checkbox"==(b=getSelectedElementType(e,i[n]))?"($d_"+i[n]+' == "1")?"Ya":"Tidak"':"$d_"+i[n],d+="	<tr>\r\n",d+="		<td>"+a+"</td>\r\n",d+="		<td><?php echo "+m+"; ?></td>\r\n",d+="	</tr>\r\n";d+="</table>\r\n",t.withApproval&&(d+="<?php\r\n",d+="}\r\n",d+="?>\r\n"),d+='<table class="responsive responsive-two-cols responsive-button-area" border="0" cellpadding="0" cellspacing="0" width="100%">\r\n',d+="	<tr>\r\n		<td>&nbsp;</td>\r\n		<td>\r\n",t.withApproval&&(d+="<?php\r\n",d+="if($d_"+u+'_apv_id != 0 && $_next != "" && $cms->hasPermission($_userLevel, $_module_name, "approve"))\r\n',d+="{\r\n",d+='	if($_next != "")\r\n	{\r\n		if($_next != ("reject"))\r\n		{\r\n?>\r\n',d+='			<input type="button" class="btn btn-success" id="approve" name="button_approve" value="Approve" onclick="approveData(\'<?php echo $_self_name; ?>\', \''+h+"', '<?php echo $_id; ?>', $('#apv_note').val())\">\r\n",d+="<?php\r\n		}\r\n",d+='		if($_next != ("approve"))\r\n		{\r\n?>\r\n',d+='			<input type="button" class="btn btn-danger" id="reject" name="button_reject" value="Reject" onclick="rejectData(\'<?php echo $_self_name; ?>\', \''+h+"', '<?php echo $_id; ?>', $('#apv_note').val())\">\r\n",d+="<?php\r\n		}\r\n	}\r\n",d+="}\r\n",d+='else if(false !== stripos($_permission, "update"))\r\n',d+="{\r\n",d+="?>\r\n",d+='			<input type="button" class="btn btn-success" id="edit" name="button_edit" value="Ubah" onclick="window.location=\'<?php echo $_self_name; ?>?user_action=update&'+h+"=<?php echo $_id; ?>'\">\r\n",d+="<?php\r\n",d+="}\r\n",d+="?>\r\n"),d+='			<input type="button" class="btn btn-primary" id="showall" value="Tampilkan Semua" onclick="window.location=\'<?php echo $_self_name; ?>\'">\r\n',d+="		</td>\r\n	</tr>\r\n",d+="</table>\r\n",d+="</form>\r\n",d+="\r\n<!-- content ended here -->\r\n",d+=templateAfterContent(e),d+='\r\n<?php include_once dirname(__FILE__)."/lib.inc/footer.php"; ?>',d+="<?php\r\n}\r\nelse\r\n{\r\n",d+='?>\r\n<?php include_once dirname(__FILE__)."/lib.inc/header.php"; ?>\r\n',d+=templateBeforeContent(e),d+='	<div class="alert alert-not-found"><?php echo $pagination_data_not_found; ?></div>\r\n',d+=templateAfterContent(e),d+='<?php include_once dirname(__FILE__)."/lib.inc/footer.php"; ?>',d+="\r\n<?php",d+="\r\n}\r\n?>",d+="<?php\r\n}\r\ncatch(Exception $e)\r\n{\r\n",d+="// Catch\r\n",d+="}\r\n",d+="}\r\n",d+="else\r\n{\r\n?>",d+='<?php include_once dirname(__FILE__)."/lib.inc/header.php"; ?>\r\n',d+=templateBeforeContent(e),d+='\r\n<!-- content started here -->\r\n\r\n	<div class="message-warning-permission"><?php echo $error_message_permission; ?></div>\r\n',d+="\r\n<!-- content ended here -->\r\n",d+=templateAfterContent(e),d+='\r\n<?php include_once dirname(__FILE__)."/lib.inc/footer.php"; ?>',d+="<?php\r\n}\r\n",d+="}\r\n",d+=""}return d}function generateListUI(e,t,r){r=r||"php",(t=t||{}).withApproval=t.withApproval||!1,t.withTrash=t.withTrash||!1,t.withNote=t.withNote||!1,t.defaultOrderDesc=t.defaultOrderDesc||!1,t.sortOrder=t.sortOrder||!1;var n,a,i=t.sortOrder,o="",s=getListFields(e),l=[],p="",d="",c="",u="",f="",h=getFieldValues(e,"table")[0],v=getPrimaryKey(e),m=v.length?v[0]:s[0],y="",b="",g=generateListFilter(e,h,r);if("jsp"==r){u+="<%\r\nelse\r\n{\r\n",u+="// TODO: Here are your code for list UI\r\n",u+='boolean _hasPermissionInsert = hasPermission(_userLevel, _module_name, "insert");\r\n',u+='boolean _hasPermissionUpdate = hasPermission(_userLevel, _module_name, "update");\r\n',u+='boolean _hasPermissionDelete = hasPermission(_userLevel, _module_name, "delete");\r\n',u+='if(hasPermission(_userLevel, _module_name, "list"))\r\n{\r\n',u+='String _id = "";\r\n',u+="int int_n = 0;\r\n",u+="int int_no = 0;\r\n",u+='int _offset = Integer.parseInt(filterInput(request, "offset", "FILTER_SANITIZE_NUMBER_UINT", true));\r\n',u+="JSONObject _result = null;\r\n",u+='String _q = filterInput(request, "q", "FILTER_SANITIZE_SPECIAL_CHARS", true);\r\n',u+='String _qNoEscape = filterInput(request, "q", "FILTER_SANITIZE_SPECIAL_CHARS", false);\r\n',u+='String _filterSort = "'+s.join("|")+'";\r\n',u+='String _orderByColumn = chooseOneFrom(_filterSort, filterInput(request, "orderby", "FILTER_SANITIZE_STRING", true), false);\r\n',u+='String _orderMethod = chooseOneFrom("asc|desc",  filterInput(request, "ordermethod", "FILTER_SANITIZE_STRING", true), true);\r\n',u+="\r\n",u+=g.variables,u+=g.queries;var w=[],I="";for(n in u+="\r\n",t.withApproval&&(u+="String d_"+h+'_apv_id = "";\r\n'),s)u+="String d_"+(f=s[n])+' = "";\r\n',"select"==(p=getSelectedElementType(e,f))?((c=f).length>3&&(c=c.substr(0,c.length-3)),d="(select `"+c+"`.`nama` from `"+c+"` where `"+c+"`.`"+f+"` = `"+h+"`.`"+f+"`) as `"+f+"`",l.push(d)):w.push("`"+h+"`.`"+f+"`");for(n in d=l.length?', "+\r\n"'+l.join(', "+\r\n"')+' "+\r\n"':" ",I=w.join(", "),-1==s.indexOf(m)&&(I="`"+h+"`.`"+m+"`, "+I),t.withApproval&&(I+=", coalesce(`"+h+"`.`"+h+"_apv_id`, '0') as `"+h+"_apv_id` "),u+="\r\n",u+='String sql_query = "";\r\n',u+='String sql_field = "'+I+d+'";\r\n',u+='String sql_from = "`'+h+'`";\r\n',u+='String sql_where = "(1=1)";\r\n',u+='String sql_orderBy = "`"+_orderByColumn+"` "+_orderMethod;\r\n',u+='String sql_limit = "limit "+pagination_record_per_page+" offset "+_offset;\r\n',u+="\r\n",t.withApproval&&(u+='if(_show_only.equals("need-approval"))\r\n',u+="{\r\n",u+='	sql_where += " and `'+h+"`.`"+h+"_apv_id` != '0' \";\r\n",u+="}\r\n\r\n"),u+="// filter from search\r\n",u+='if(!sql_additional_filter.equals(""))\r\n',u+="{\r\n",u+="	sql_where += sql_additional_filter;\r\n",u+="}\r\n",u+="\r\n",u+="// add you additional filter here\r\n",u+="\r\n",u+="\r\n",u+='String sql_count = query1.newQuery()\r\n	.select("count(*)").as("`num`")\r\n	.from(sql_from)\r\n	.where(sql_where)\r\n	.toString();\r\n',u+="\r\npagination_max_record = cms.getRowCount(sql_count);\r\n",u+="// build final query here\r\n",u+="query1.newQuery()\r\n	.select(sql_field)\r\n	.from(sql_from)\r\n	.where(sql_where);\r\n",u+='if(!_orderByColumn.equals(""))\r\n',u+="{\r\n",u+="	query1.orderBy(sql_orderBy);\r\n",u+="}\r\n",i?(u+="else\r\n",u+="{\r\n",u+='	query1.orderBy("`sort_order` asc");\r\n',u+="}\r\n"):t.defaultOrderDesc&&(u+="else\r\n",u+="{\r\n",u+='	query1.orderBy("`"+_pkey_name+"` desc");\r\n',u+="}\r\n"),u+="query1.limit(pagination_record_per_page);\r\n",u+="query1.offset(_offset);\r\n",u+="sql_query = query1.toString();\r\n",u+='\r\n%><%@ include file="lib.inc/header.jsp" %>\r\n',u+=templateBeforeContent(e),u+="\r\n<!-- content started here -->\r\n\r\n",i?u+="<link rel=\"stylesheet\" type=\"text/css\" href=\"vendors/sort-table/css.css\" />\r\n<script type=\"text/javascript\" src=\"vendors/sort-table/Sortable.js\"></script>\r\n<script type=\"text/javascript\">\r\n$(document).ready(function(e){\r\n    createSortTable();\r\n    createPagination();\r\n    $(document).on('change', '#searchform select', function(e){\r\n		$(this).closest('form').submit();\r\n	});\r\n    $(document).on('click', '.recipe-table__add-row-btn', function (e) {\r\n        var $el = $(e.currentTarget);\r\n        var $tableBody = $('#recipeTableBody');\r\n        var htmlString = $('#rowTemplate').html();\r\n        $tableBody.append(htmlString);\r\n        return false;\r\n    });\r\n\r\n    $(document).on('click', '.recipe-table__del-row-btn', function (e) {\r\n        var $el = $(e.currentTarget);\r\n        var $row = $el.closest('tr');\r\n        $row.remove();\r\n        return false;\r\n    });\r\n 	Sortable.create(\r\n        $('#recipeTableBody')[0],\r\n        {\r\n            animation: 150,\r\n            scroll: true,\r\n            handle: '.drag-handler',\r\n            onEnd: function () {\r\n            	saveOrder();\r\n            }\r\n        }\r\n    );\r\n});\r\nfunction saveOrder()\r\n{\r\n	var sort_data = [];\r\n	var offset = parseInt($('#recipeTable tbody').attr('data-offset') || '0');\r\n	var no = offset;\r\n	$('#recipeTable tbody tr').each(function(e){\r\n		no++;\r\n		$(this).find('.cell-no').text(no);\r\n		$(this).find('.cell-order').text(no);\r\n		sort_data.push($(this).attr('data-id'));\r\n	});\r\n	$.post('<%= _self_name %>', {special_action:'save-order', offset:offset, sort_data:sort_data.join(\",\")}, function(answer){\r\n	});\r\n}\r\n</script>\r\n":u+="<script type=\"text/javascript\">\r\n$(document).ready(function(e){\r\n    createSortTable();\r\n    createPagination();\r\n    $(document).on('change', '#searchform select', function(e){\r\n    $(this).closest('form').submit();\r\n    });\r\n});\r\n</script>\r\n",u+='\r\n<div class="search-bar">\r\n	<form name="searchform" id="searchform" method="get" action="">\r\n    	<!-- add some filters here -->\r\n        <span class="searchform-control">\r\n'+g.elements+(g.elements.length>10?'        	<input type="submit" class="btn btn-success" value="Cari">\r\n':""),u+="			<%\r\n",u+="			if(_hasPermissionInsert)\r\n",u+="			{\r\n",u+="			%>\r\n",u+='				<input type="button" class="btn btn-primary" value="Tambah" onclick="window.location=\'<%= _self_name %>?user_action=insert\'">\r\n',u+="			<%\r\n",u+="			}\r\n",u+="			%>\r\n",u+="		</span>\r\n	</form>\r\n</div>\r\n",u+="<%\r\ntry\r\n{\r\ndb_rs = database1.executeQuery(sql_query);\r\nif(db_rs.isBeforeFirst())\r\n{\r\n%>\r\n",u+='<form name="mainformdata" id="mainformdata" method="post" action="">\r\n',u+='\r\n<div data-pagination="true" data-self-name="<%= _self_name %>" data-max-record="<%= pagination_max_record %>" data-record-per-page="<%= pagination_record_per_page %>" data-hide="<%= (pagination_max_record <= pagination_record_per_page)?"true":"false" %>"></div>\r\n\r\n',u+='<div class="row-table-container">\r\n',i?u+='<table class="table table-striped jambo_table recipe-table" id="recipeTable" border="0" cellpadding="0" cellspacing="0" width="100%" data-table-sort="true" data-self-name="<%= _self_name %>">\r\n':u+='<table class="table table-striped jambo_table" border="0" cellpadding="0" cellspacing="0" width="100%" data-table-sort="true" data-self-name="<%= _self_name %>">\r\n',u+="	<thead>\r\n",u+="		<tr>\r\n",u+='			<td width="16" align="center"><input type="checkbox" class="checkbox-select-all" data-selector=".checkbox-'+m+'" value="1"></td>\r\n',u+='			<td width="16" align="center"><span class="fa fa-edit"></span></td>\r\n',u+='			<td width="16" align="center"><span class="fa fa-folder"></span></td>\r\n',u+='			<td width="25">No</td>\r\n',s)a=getFieldValues(e,"caption_"+s[n]),u+='			<td class="col-sort" data-col-name="'+s[n]+'"><a href="#">'+a+"</a></td>\r\n";for(n in t.withApproval&&(u+='		<%\r\n		if(_permission.contains("approve"))\r\n		{\r\n		%>\r\n			<td>Approval</td>\r\n		<%\r\n		}\r\n		%>\r\n'),u+="		</tr>\r\n",u+="	</thead>\r\n",u+="	<tbody>\r\n",u+="		<%\r\n",u+="		while(db_rs.next())\r\n		{\r\n",u+="			int_n++;\r\n",u+="			int_no = _offset + int_n;\r\n",u+='			_id = db_rs.getString("'+m+'");\r\n\r\n',s)u+="			d_"+(f=s[n])+' = db_rs.getString("'+f+'");\r\n';for(n in t.withApproval&&(u+="			d_"+h+'_apv_id = db_rs.getString("'+h+'_apv_id");\r\n',o=' data-need-approval="<%= (d_'+h+'_apv_id.equals("0"))?"false":"true" %>"'),u+="		%>\r\n",u+="		<tr"+o+' data-id="<%= _id %>">\r\n',u+='			<td width="16" align="center"><input type="checkbox" class="checkbox-'+m+'" name="'+m+'" value="<%= _id %>"></td>\r\n',u+='			<td width="16" align="center"><a href="<%= _self_name %>?user_action=update&'+m+'=<%= _id %>" class="edit-control"><span class="fa fa-edit"></span></a></td>\r\n',u+='			<td width="16" align="center"><a href="<%= _self_name %>?user_action=detail&'+m+'=<%= _id %>" class="detail-control field-master"><span class="fa fa-folder"></span></a></td>\r\n',u+='			<td align="right" class="cell-no"><%= int_no %></td>\r\n',s)y="checkbox"==(b=getSelectedElementType(e,s[n]))?"(d_"+s[n]+' == null)?"Tidak":((d_'+s[n]+'.equals("1"))?"Ya":"Tidak")':"d_"+s[n],i&&"sort_order"==s[n]?u+='			<td><a class="field-slave cell-order"><%= '+y+" %></a></td>\r\n":u+='			<td><a class="field-slave"><%= '+y+" %></a></td>\r\n";if(t.withApproval){var T="d_"+h+"_apv_id";u+='		<%\r\n		if(_permission.contains("approve"))\r\n		{\r\n		%>\r\n',u+='			<td nowrap="nowrap"><%\r\n			if(!'+T+'.equals("0"))\r\n			{\r\n			%>\r\n				<a href="<%= _self_name %>?user_action=detail&'+m+'=<%= _id %>&next=approve" class="btn btn-on-tbl btn-success" data-id="<%= _id %>" data-action="approve">Approve</a>\r\n				<a href="<%= _self_name %>?user_action=detail&'+m+'=<%= _id %>&next=reject" class="btn btn-on-tbl btn-warning" data-id="<%= _id %>" data-action="reject">Reject</a>\r\n			<%\r\n			}\r\n			%></td>\r\n',u+="		<%\r\n		}\r\n		%>\r\n"}u+="		</tr>\r\n",u+="		<%\r\n",u+="		}\r\n",u+="		%>\r\n",u+="	</tbody>\r\n",u+="</table>\r\n",u+="</div>\r\n",u+='\r\n<div data-pagination="true" data-self-name="<%= _self_name %>" data-max-record="<%= pagination_max_record %>" data-record-per-page="<%= pagination_record_per_page %>" data-hide="<%= (pagination_max_record <= pagination_record_per_page)?"true":"false" %>"></div>\r\n',u+='<div class="button-area">\r\n',u+="<%\r\n",u+="if(_hasPermissionUpdate)\r\n",u+="{\r\n",u+="%>\r\n",u+='	<input type="submit" class="btn btn-success" name="data_activate" value="Aktifkan">\r\n',u+='	<input type="submit" class="btn btn-warning" name="data_deactivate" value="Nonaktifkan">\r\n',u+="<%\r\n",u+="}\r\n",u+="if(_hasPermissionDelete)\r\n",u+="{\r\n",u+="%>\r\n",u+='	<input type="submit" class="btn btn-danger" name="data_delete" value="Hapus" onclick="return confirm(\'<%= warning_message_delete %>\')">\r\n',u+="<%\r\n",u+="}\r\n",u+="%>\r\n",u+="</div>\r\n",u+="</form>\r\n",u+='<%\r\n}\r\nelse\r\n{\r\n%>\r\n	<div class="alert alert-not-found"><%= pagination_data_not_found %></div>\r\n<%\r\n}\r\n}\r\ncatch(Exception e)\r\n{\r\n	e.printStackTrace();\r\n	%>\r\n	<div class="message-error-database"><%= error_message_fail_access_db %></div>\r\n	<%\r\n}\r\nfinally\r\n{\r\n}\r\n%>\r\n',u+="\r\n<!-- content ended here -->\r\n",u+=templateAfterContent(e),u+='\r\n<%@ include file="lib.inc/footer.jsp" %>',u+="<%\r\n}\r\n",u+="else\r\n{\r\n%>",u+='<%@ include file="lib.inc/header.jsp" %>\r\n',u+=templateBeforeContent(e),u+='\r\n<!-- content started here -->\r\n\r\n	<div class="message-warning-permission"><%= error_message_permission %></div>\r\n',u+="\r\n<!-- content ended here -->\r\n",u+=templateAfterContent(e),u+='\r\n<%@ include file="lib.inc/footer.jsp" %>',u+="<%\r\n}\r\n",u+="}\r\n",u+="%>"}else if("php"==r){u+="\r\nelse\r\n{\r\n",u+="// TODO: Here are your code for list UI\r\n",u+='$_hasPermissionInsert = (stripos($_permission, "insert") !== false);\r\n',u+='$_hasPermissionUpdate = (stripos($_permission, "update") !== false);\r\n',u+='$_hasPermissionDelete = (stripos($_permission, "delete") !== false);\r\n',u+='if(false !== stripos($_permission, "list"))\r\n{\r\n',u+='$_id = "";\r\n',u+="$int_n = 0;\r\n",u+="$int_no = 0;\r\n",u+='$_offset = 1 * (filterInput(INPUT_GET, "offset", FILTER_SANITIZE_NUMBER_UINT, true));\r\n',u+="$_result = null;\r\n",u+='$_q = filterInput(INPUT_GET, "q", FILTER_SANITIZE_SPECIAL_CHARS, true);\r\n',u+='$_qNoEscape = filterInput(INPUT_GET, "q", FILTER_SANITIZE_SPECIAL_CHARS, false);\r\n',u+='$_filterSort = "'+s.join("|")+'";\r\n',u+='$_orderByColumn = $cms->chooseOneFrom($_filterSort, filterInput(INPUT_GET, "orderby", FILTER_SANITIZE_STRING, true), false);\r\n',u+='$_orderMethod = $cms->chooseOneFrom("asc|desc",  filterInput(INPUT_GET, "ordermethod", FILTER_SANITIZE_STRING, true), true);\r\n',u+="\r\n",u+=g.variables,u+=g.queries;var w=[],I="";for(n in u+="\r\n",t.withApproval&&(u+="$d_"+h+'_apv_id = "";\r\n',u+='$d_waiting_for = "";\r\n',w.push("coalesce(`"+h+"`.`"+h+"_apv_id`, 0) as `"+h+"_apv_id`"),w.push("coalesce(`"+h+"`.`waiting_for`, 0) as `waiting_for`")),s)u+="$d_"+(f=s[n])+' = "";\r\n',"select"==(p=getSelectedElementType(e,f))?((c=f).length>3&&(c=c.substr(0,c.length-3)),d="(select `"+c+"`.`nama` from `"+c+"` where `"+c+"`.`"+f+"` = `"+h+"`.`"+f+"`) as `"+f+"`",l.push(d)):w.push("`"+h+"`.`"+f+"`");for(n in d=l.length?', ".\r\n"'+l.join(', ".\r\n"')+' ".\r\n"':" ",I=w.join(", "),-1==s.indexOf(m)&&(I="`"+h+"`.`"+m+"`, "+I),u+="\r\n",u+='$sql_query = "";\r\n',u+='$sql_field = "'+I+d+'";\r\n',u+='$sql_from = "`'+h+'`";\r\n',u+='$sql_where = "(1=1)";\r\n',u+='$sql_orderBy = "`".$_orderByColumn."` ".$_orderMethod;\r\n',u+='$sql_limit = "limit ".$pagination_record_per_page." offset ".$_offset;\r\n',u+="\r\n",t.withApproval&&(u+='if($_show_only == ("need-approval"))\r\n',u+="{\r\n",u+='	$sql_where .= " and `'+h+"`.`"+h+"_apv_id` != '0' \";\r\n",u+="}\r\n\r\n"),u+="// filter from search\r\n",u+='if($sql_additional_filter != "")\r\n',u+="{\r\n",u+="	$sql_where .= $sql_additional_filter;\r\n",u+="}\r\n",u+="\r\n",u+="// add you additional filter here\r\n",u+="\r\n",u+="\r\n",u+='$sql_count = $query1->newQuery()\r\n	->select("count(*)")->alias("`num`")\r\n	->from($sql_from)\r\n	->where($sql_where)\r\n	->toString();\r\n',u+="\r\n$pagination_max_record = $cms->getRowCount($sql_count);\r\n",u+="// build final query here\r\n",u+="$query1->newQuery()\r\n	->select($sql_field)\r\n	->from($sql_from)\r\n	->where($sql_where);\r\n",u+='if($_orderByColumn != "")\r\n',u+="{\r\n",u+="	$query1->orderBy($sql_orderBy);\r\n",u+="}\r\n",i?(u+="else\r\n",u+="{\r\n",u+='	$query1->orderBy("`sort_order` asc");\r\n',u+="}\r\n"):t.defaultOrderDesc&&(u+="else\r\n",u+="{\r\n",u+='	$query1->orderBy("`".$_pkey_name."` desc");\r\n',u+="}\r\n"),u+="$query1->limit($pagination_record_per_page);\r\n",u+="$query1->offset($_offset);\r\n",u+="$sql_query = $query1->toString();\r\n",u+='\r\n?><?php include_once dirname(__FILE__)."/lib.inc/header.php"; ?>\r\n',u+=templateBeforeContent(e),u+="\r\n<!-- content started here -->\r\n\r\n",i?u+="<link rel=\"stylesheet\" type=\"text/css\" href=\"vendors/sort-table/css.css\" />\r\n<script type=\"text/javascript\" src=\"vendors/sort-table/Sortable.js\"></script>\r\n<script type=\"text/javascript\">\r\n$(document).ready(function(e){\r\n    createSortTable();\r\n    createPagination();\r\n    $(document).on('change', '#searchform select', function(e){\r\n		$(this).closest('form').submit();\r\n	});\r\n    $(document).on('click', '.recipe-table__add-row-btn', function (e) {\r\n        var $el = $(e.currentTarget);\r\n        var $tableBody = $('#recipeTableBody');\r\n        var htmlString = $('#rowTemplate').html();\r\n        $tableBody.append(htmlString);\r\n        return false;\r\n    });\r\n\r\n    $(document).on('click', '.recipe-table__del-row-btn', function (e) {\r\n        var $el = $(e.currentTarget);\r\n        var $row = $el.closest('tr');\r\n        $row.remove();\r\n        return false;\r\n    });\r\n 	Sortable.create(\r\n        $('#recipeTableBody')[0],\r\n        {\r\n            animation: 150,\r\n            scroll: true,\r\n            handle: '.drag-handler',\r\n            onEnd: function () {\r\n            	saveOrder();\r\n            }\r\n        }\r\n    );\r\n});\r\nfunction saveOrder()\r\n{\r\n	var sort_data = [];\r\n	var offset = parseInt($('#recipeTable tbody').attr('data-offset') || '0');\r\n	var no = offset;\r\n	$('#recipeTable tbody tr').each(function(e){\r\n		no++;\r\n		$(this).find('.cell-no').text(no);\r\n		$(this).find('.cell-order').text(no);\r\n		sort_data.push($(this).attr('data-id'));\r\n	});\r\n	$.post('<?php echo $_self_name;?>', {special_action:'save-order', offset:offset, sort_data:sort_data.join(\",\")}, function(answer){\r\n	});\r\n}\r\n</script>\r\n":u+="<script type=\"text/javascript\">\r\n$(document).ready(function(e){\r\n    createSortTable();\r\n    createPagination();\r\n    $(document).on('change', '#searchform select', function(e){\r\n    $(this).closest('form').submit();\r\n    });\r\n});\r\n</script>\r\n",u+='\r\n<div class="search-bar">\r\n	<form name="searchform" id="searchform" method="get" action="">\r\n    	<!-- add some filters here -->\r\n        <span class="searchform-control">\r\n'+g.elements+(g.elements.length>10?'        	<input type="submit" class="btn btn-success" value="Cari">\r\n':""),u+="			<?php\r\n",u+="			if($_hasPermissionInsert)\r\n",u+="			{\r\n",u+="			?>\r\n",u+='				<input type="button" class="btn btn-primary" value="Tambah" onclick="window.location=\'<?php echo $_self_name; ?>?user_action=insert\'">\r\n',u+="			<?php\r\n",u+="			}\r\n",u+="			?>\r\n",u+="		</span>\r\n	</form>\r\n</div>\r\n",u+="<?php\r\ntry\r\n{\r\n$db_rs = $database1->prepare($sql_query);\r\n$db_rs->execute();\r\n$db_max_row = $db_rs->rowCount();\r\nif($db_max_row)\r\n{\r\n?>\r\n",u+='<form name="mainformdata" id="mainformdata" method="post" action="">\r\n',u+='\r\n<div data-pagination="true" data-self-name="<?php echo $_self_name; ?>" data-max-record="<?php echo $pagination_max_record; ?>" data-record-per-page="<?php echo $pagination_record_per_page; ?>" data-hide="<?php echo ($pagination_max_record <= $pagination_record_per_page)?"true":"false"; ?>"></div>\r\n\r\n',u+='<div class="row-table-container">\r\n',i?u+='<table class="table table-striped jambo_table recipe-table" id="recipeTable" border="0" cellpadding="0" cellspacing="0" width="100%" data-table-sort="true" data-self-name="<?php echo $_self_name; ?>">\r\n':u+='<table class="table table-striped jambo_table" border="0" cellpadding="0" cellspacing="0" width="100%" data-table-sort="true" data-self-name="<?php echo $_self_name; ?>">\r\n',u+="	<thead>\r\n",u+="		<tr>\r\n",i&&(u+='			<td class="drag-handler"></td>\r\n'),u+='			<td width="16" align="center"><input type="checkbox" class="checkbox-select-all" data-selector=".checkbox-'+m+'" value="1"></td>\r\n',u+='			<td width="16" align="center"><span class="fa fa-edit"></span></td>\r\n',u+='			<td width="16" align="center"><span class="fa fa-folder"></span></td>\r\n',u+='			<td width="25">No</td>\r\n',s)a=getFieldValues(e,"caption_"+s[n]),u+='			<td class="col-sort" data-col-name="'+s[n]+'"><a href="#">'+a+"</a></td>\r\n";for(n in t.withApproval&&(u+='		<?php\r\n		if(stripos($_permission, "approve") !== false)\r\n		{\r\n		?>\r\n			<td>Approval</td>\r\n		<?php\r\n		}\r\n		?>\r\n'),u+="		</tr>\r\n",u+="	</thead>\r\n",i?u+='	<tbody id="recipeTableBody" data-offset="<?php echo $_offset;?>">\r\n':u+="	<tbody>\r\n",u+="		<?php\r\n",u+="		$db_data = $db_rs->fetchAll(PDO::FETCH_ASSOC);\r\n",u+="		for($db_i = 0; $db_i < $db_max_row; $db_i++)\r\n		{\r\n",u+="			$int_n++;\r\n",u+="			$int_no = $_offset + $int_n;\r\n",u+='			$_id = $db_data[$db_i]["'+m+'"];\r\n\r\n',s)u+="			$d_"+(f=s[n])+' = $db_data[$db_i]["'+f+'"];\r\n';for(n in t.withApproval&&(u+="			$d_"+h+'_apv_id = $db_data[$db_i]["'+h+'_apv_id"];\r\n',u+='			$d_waiting_for = $db_data[$db_i]["waiting_for"];\r\n',o=' data-need-approval="<?php echo ($d_'+h+'_apv_id == "0")?"false":"true" ?>"'),u+="		?>\r\n",u+="		<tr"+o+' data-id="<?php echo $_id ?>">\r\n',i&&(u+='			<td class="drag-handler"></td>\r\n'),u+='			<td width="16" align="center"><input type="checkbox" class="checkbox-'+m+'" name="'+m+'[]" value="<?php echo $_id ?>"></td>\r\n',u+='			<td width="16" align="center"><a href="<?php echo $_self_name; ?>?user_action=update&'+m+'=<?php echo $_id; ?>" class="edit-control"><span class="fa fa-edit"></span></a></td>\r\n',u+='			<td width="16" align="center"><a href="<?php echo $_self_name; ?>?user_action=detail&'+m+'=<?php echo $_id; ?>" class="detail-control field-master"><span class="fa fa-folder"></span></a></td>\r\n',u+='			<td align="right" class="cell-no"><?php echo $int_no ?></td>\r\n',s)y="checkbox"==(b=getSelectedElementType(e,s[n]))?"($d_"+s[n]+' == "1")?"Ya":"Tidak"':"$d_"+s[n],i&&"sort_order"==s[n]?u+='			<td><a class="field-slave cell-order"><?php echo '+y+" ?></a></td>\r\n":u+='			<td><a class="field-slave"><?php echo '+y+" ?></a></td>\r\n";if(t.withApproval){var T="d_"+h+"_apv_id";u+='		<?php\r\n		if(stripos($_permission, "approve") !== false)\r\n		{\r\n		?>\r\n',u+='			<td nowrap="nowrap"><?php\r\n			if($'+T+' != ("0"))\r\n			{\r\n			?>\r\n				<a href="<?php echo $_self_name; ?>?user_action=detail&'+m+'=<?php echo $_id ?>&next=approve" class="btn btn-on-tbl btn-success" data-id="<?php echo $_id ?>" data-action="approve">Approve</a>\r\n				<a href="<?php echo $_self_name; ?>?user_action=detail&'+m+'=<?php echo $_id ?>&next=reject" class="btn btn-on-tbl btn-warning" data-id="<?php echo $_id ?>" data-action="reject">Reject</a>\r\n			<?php\r\n			}\r\n			?></td>\r\n',u+="		<?php\r\n		}\r\n		?>\r\n"}u+="		</tr>\r\n",u+="		<?php\r\n",u+="		}\r\n",u+="		?>\r\n",u+="	</tbody>\r\n",u+="</table>\r\n",u+="</div>\r\n",u+='\r\n<div data-pagination="true" data-self-name="<?php echo $_self_name; ?>" data-max-record="<?php echo $pagination_max_record ?>" data-record-per-page="<?php echo $pagination_record_per_page; ?>" data-hide="<?php echo ($pagination_max_record <= $pagination_record_per_page)?"true":"false" ?>"></div>\r\n',u+='<div class="button-area">\r\n',u+="<?php\r\n",u+="if($_hasPermissionUpdate)\r\n",u+="{\r\n",u+="?>\r\n",u+='	<input type="submit" class="btn btn-success" name="data_activate" value="Aktifkan">\r\n',u+='	<input type="submit" class="btn btn-warning" name="data_deactivate" value="Nonaktifkan">\r\n',u+="<?php\r\n",u+="}\r\n",u+="if($_hasPermissionDelete)\r\n",u+="{\r\n",u+="?>\r\n",u+='	<input type="submit" class="btn btn-danger" name="data_delete" value="Hapus" onclick="return confirm(\'<?php echo $warning_message_delete ?>\')">\r\n',u+="<?php\r\n",u+="}\r\n",u+="?>\r\n",u+="</div>\r\n",u+="</form>\r\n",u+='<?php\r\n}\r\nelse\r\n{\r\n?>\r\n	<div class="alert alert-not-found"><?php echo $pagination_data_not_found ?></div>\r\n<?php\r\n}\r\n}\r\ncatch(Exception $e)\r\n{\r\n	?>\r\n	<div class="message-error-database"><?php echo $error_message_fail_access_db ?></div>\r\n	<?php\r\n}\r\n?>\r\n',u+="\r\n<!-- content ended here -->\r\n",u+=templateAfterContent(e),u+='\r\n<?php include_once dirname(__FILE__)."/lib.inc/footer.php"; ?>',u+="<?php\r\n}\r\n",u+="else\r\n{\r\n?>",u+='<?php include_once dirname(__FILE__)."/lib.inc/header.php"; ?>\r\n',u+=templateBeforeContent(e),u+='\r\n<!-- content started here -->\r\n\r\n	<div class="message-warning-permission"><?php echo $error_message_permission ?></div>\r\n',u+="\r\n<!-- content ended here -->\r\n",u+=templateAfterContent(e),u+='\r\n<?php include_once dirname(__FILE__)."/lib.inc/footer.php"; ?>',u+="<?php\r\n}\r\n",u+="}\r\n",u+="?>"}return u}function generateListFilter(e,t,r){r=r||"php";var n,a,i,o,s=getListFilter(e),l="",p="",d="";if("jsp"==r)for(n in d+='String sql_additional_filter = "";\r\n\r\n',s)o=a=s[n].name,caption=getFieldValues(e,"caption_"+a),o.length>3&&(o=o.substr(0,o.length-3)),i=s[n].type,l+="String s_"+a+' = filterInput(request, "'+a+'", "FILTER_SANITIZE_STRING", true);\r\n',p+='			<span class="group-together">\r\n			<span class="searchform-label">'+caption+"</span>\r\n","text"==i?(p+='			<input type="text" class="input-text-search" name="'+a+'" id="'+a+'" value="<%= filterInput(request, "'+a+'", "FILTER_SANITIZE_STRING", false) %>">\r\n',d+="if(!s_"+a+'.equals(""))\r\n{\r\n	sql_additional_filter += " and LOWER(`'+t+"`.`"+a+"`) like LOWER('%\"+s_"+a+'+"%\') ";\r\n}\r\n'):(p+='			<select class="select-search" name="'+a+'" id="'+a+'">\r\n				<option value="">- Pilih -</option>\r\n				<%= cms.createDropDownMenu("'+o+'", "'+a+'", "nama", filterInput(request, "'+a+'", "FILTER_SANITIZE_STRING", true)) %>\r\n			</select>\r\n',d+="if(!s_"+a+'.equals(""))\r\n{\r\n	sql_additional_filter += " and `'+t+"`.`"+a+"` = '\"+s_"+a+'+"\' ";\r\n}\r\n'),p+="			</span>\r\n";else if("php"==r)for(n in d+='$sql_additional_filter = "";\r\n\r\n',s)o=a=s[n].name,caption=getFieldValues(e,"caption_"+a),o.length>3&&(o=o.substr(0,o.length-3)),i=s[n].type,l+="$s_"+a+' = filterInput(INPUT_GET, "'+a+'", FILTER_SANITIZE_STRING, true);\r\n',p+='			<span class="group-together">\r\n			<span class="searchform-label">'+caption+"</span>\r\n","text"==i?(p+='			<input type="text" class="input-text-search" name="'+a+'" id="'+a+'" value="<?php echo filterInput(INPUT_GET, "'+a+'", FILTER_SANITIZE_STRING, false) ?>">\r\n',d+="if($s_"+a+' != "")\r\n{\r\n	$sql_additional_filter .= " and LOWER(`'+t+"`.`"+a+"`) like LOWER('%\".$s_"+a+'."%\') ";\r\n}\r\n'):(p+='			<select class="select-search" name="'+a+'" id="'+a+'">\r\n				<option value="">- Pilih -</option>\r\n				<?php echo $cms->createDropDownMenu("'+o+'", "'+a+'", "nama", filterInput(INPUT_GET, "'+a+'", FILTER_SANITIZE_STRING, true)) ?>\r\n			</select>\r\n',d+="if($s_"+a+' != "")\r\n{\r\n	$sql_additional_filter .= " and `'+t+"`.`"+a+"` = '\".$s_"+a+'."\' ";\r\n}\r\n'),p+="			</span>\r\n";return{elements:p,variables:l,queries:d}}function getListFilter(e){var t,r,n,a=getFieldValues(e,"field"),i=[];for(t in a)void 0!==(n=getFieldValues(e,"list_filter_"+(r=a[t])))[0]&&i.push({name:r,type:n});return i}function templateBeforeContent(e){return'<div class="content-wrapper">\r\n'}function templateAfterContent(e){return"</div>\r\n"}function generateInputForInsert(e,t,r){r=r||"php";var n=t;n.length>3&&(n=n.substr(0,n.length-3));var a=getSelectedDataType(e,t),i=getSelectedElementType(e,t),o=isInputRequired(e,t),s=convertDataTypeToElement(i,a,o);if(s.attr({name:t,id:t}),"select"==i){var l=s[0].outerHTML;return"jsp"==r?l.replace("</select>",'\r\n				<option value="">- Pilih -</option>\r\n				<%= cms.createDropDownMenu("'+n+'", "'+t+'", "nama") %>\r\n			</select>'):l.replace("</select>",'\r\n				<option value="">- Pilih -</option>\r\n				<?php echo $cms->createDropDownMenu("'+n+'", "'+t+'", "nama") ?>\r\n			</select>')}return"checkbox"==i?(s.attr({value:"1"}),"<label>"+s[0].outerHTML+" "+t.replaceAll("_"," ").capitalize().prettify().trim()+"</label>"):(!1,s[0].outerHTML)}function generateInputForUpdate(e,t,r){r=r||"php";var n=t;n.length>3&&(n=n.substr(0,n.length-3));var a=getSelectedDataType(e,t),i=getSelectedElementType(e,t),o=isInputRequired(e,t),s=convertDataTypeToElement(i,a,o);if(s.attr({name:t,id:t}),"jsp"==r){if("select"==i){var l=s[0].outerHTML;return l.replace("</select>",'\r\n				<option value="">- Pilih -</option>\r\n				<%= cms.createDropDownMenu("'+n+'", "'+t+'", "nama", d_'+t+") %>\r\n			</select>")}if("text"==i){var p=s[0].outerHTML;return p.replace(">",' value="<%= d_'+t+' %>">')}if("textarea"==i){var d=s[0].outerHTML;return d.replace("</textarea>","<%= d_"+t+" %></textarea>")}if("checkbox"==i){s.attr({value:"1"});var c=s[0].outerHTML,u="<label>"+(c=c.replace(">","<%= (d_"+t+' == null)?"":((d_'+t+'.equals("1"))?" checked=\\"checked\\"":"") %>>'))+" "+t.replaceAll("_"," ").capitalize().prettify().trim()+"</label>";return u}}else if("php"==r){if("select"==i){var l=s[0].outerHTML;return l.replace("</select>",'\r\n				<option value="">- Pilih -</option>\r\n				<?php echo $cms->createDropDownMenu("'+n+'", "'+t+'", "nama", $d_'+t+"); ?>\r\n			</select>")}if("text"==i){var p=s[0].outerHTML;return p.replace(">",' value="<?php echo $d_'+t+'; ?>">')}if("textarea"==i){var d=s[0].outerHTML;return d.replace("</textarea>","<?php echo $d_"+t+"; ?></textarea>")}if("checkbox"==i){s.attr({value:"1"});var c=s[0].outerHTML,u="<label>"+(c=c.replace(">","<?php echo ($d_"+t+' == "1")?" checked=\\"checked\\"":""; ?>>'))+" "+t.replaceAll("_"," ").capitalize().prettify().trim()+"</label>";return u}}return s[0].outerHTML}function getPrimaryKey(e){var t,r,n,a=getFieldValues(e,"field"),i=[];for(t in a)void 0!==(n=getFieldValues(e,"include_key_"+(r=a[t])))[0]&&i.push(r);return i}function getSelectedDataType(e,t){return getFieldValues(e,"data_type_"+t)[0]||"text"}function getSelectedElementType(e,t){return getFieldValues(e,"element_type_"+t)[0]||"text"}function isInputRequired(e,t){return!!(getFieldValues(e,"include_required_"+t)||[]).length}function convertDataTypeToElement(e,t,r){var n;switch(e){case"text":default:(n=$("<input />")).attr({type:"text"});break;case"textarea":(n=$("<textarea />")).addClass("form-control");break;case"select":case"enum":(n=$("<select />")).addClass("form-control");break;case"checkbox":(n=$("<input />")).attr({type:"checkbox"});break;case"radio":(n=$("<input />")).attr({type:"radio"})}switch(t){case"text":default:"text"==e&&n.attr({type:"text",class:"form-control input-text input-text-plain"});break;case"email":"text"==e&&n.attr({type:"email",class:"form-control input-text input-text-email"});break;case"password":"text"==e&&n.attr({type:"password",class:"form-control input-text input-text-password"});break;case"int":"text"==e&&n.attr({type:"number",class:"form-control input-text input-text-plain"});break;case"float":"text"==e&&n.attr({type:"number",step:"any",class:"form-control input-text input-text-plain"});break;case"time":"text"==e&&n.attr({type:"text",class:"form-control timepicker input-text input-text-time"});break;case"datetime":"text"==e&&n.attr({type:"text",class:"form-control datetimepicker input-text input-text-datetime"});break;case"date":"text"==e&&n.attr({type:"text",class:"form-control datepicker input-text input-text-date"});break;case"color":"text"==e&&n.attr({type:"text",class:"form-control colorpicker-element input-text input-text-color"});break;case"tel":"text"==e&&n.attr({type:"tel",class:"form-control input-text input-text-tel"})}return r&&n.attr({required:"required"}),n}function getFieldValues(e,t){var r,n,a=[];for(r in e)(n=e[r]).name==t&&a.push(n.value);return a}function getInsertFields(e){var t,r,n,a=getFieldValues(e,"field"),i=[];for(t in a)void 0!==(n=getFieldValues(e,"include_insert_"+(r=a[t])))[0]&&i.push(r);return i}function getUpdateFields(e){var t,r,n,a=getFieldValues(e,"field"),i=[];for(t in a)void 0!==(n=getFieldValues(e,"include_edit_"+(r=a[t])))[0]&&i.push(r);return i}function getDetailFields(e){var t,r,n,a=getFieldValues(e,"field"),i=[];for(t in a)void 0!==(n=getFieldValues(e,"include_detail_"+(r=a[t])))[0]&&i.push(r);return i}function getListFields(e){var t,r,n,a=getFieldValues(e,"field"),i=[];for(t in a)void 0!==(n=getFieldValues(e,"include_list_"+(r=a[t])))[0]&&i.push(r);return i}function getSelectedFilterType(e,t){return $('select[name="filter_type_'+t+'"]').val()}function getSelectedDataTypeForServer(e,t){var r="String",n=$('select[name="data_type_'+t+'"]').val();switch(n){case"text":case"email":case"password":case"date":case"time":case"datetime":case"color":case"tel":default:r="String";break;case"int":r="int";break;case"float":r="double"}return r}String.prototype.replaceAll=function(e,t){return this.replace(RegExp(e,"g"),t)},$(document).ready(function(e){$(document).on("change click","#formgenerator input, #formgenerator select",function(e){var t=$(this).closest("form"),r=$("#formdatabase");saveState(t,r)}),$(document).on("submit","#formgenerator",function(e){var t=$(this).serializeArray(),r={withApproval:$("#with_approval")[0].checked,withTrash:$("#with_trash")[0].checked,withNote:$("#with_approval_note")[0].checked,defaultOrderDesc:$("#pkeydesc")[0].checked,sortOrder:$("#manualsortorder")[0].checked},n="",a="",i="";n="",n+=generateAuthentification(t,i="php"),n+=generateController(t,r,i),n+=generateInsertUI(t,r,i),n+=generateUpdateUI(t,r,i),n+=generateDetailUI(t,r,i),n+=generateListUI(t,r,i),n=(n=n.replaceAll("Default Data","Default")).replaceAll("Sort Order","Order"),$("#quote")[0].checked||(n=finalizeString(n)),a="",a+=generateAuthentification(t,i="jsp"),a+=generateController(t,r,i),a+=generateInsertUI(t,r,i),a+=generateUpdateUI(t,r,i),a+=generateDetailUI(t,r,i),a+=generateListUI(t,r,i),a=(a=a.replaceAll("Default Data","Default")).replaceAll("Sort Order","Order"),$("#quote")[0].checked||(a=finalizeString(a)),initCodeMirror(),$(".tabs").find(' > ul > li > a[href="#sql-query"]').click(),editorSQL.getDoc().setValue(SQLFromServer),$(".tabs").find(' > ul > li > a[href="#result-jsp"]').click(),editorJSP.getDoc().setValue(a),$(".tabs").find(' > ul > li > a[href="#result-php"]').click(),editorPHP.getDoc().setValue(n),e.preventDefault()}),$(document).on("click","#load_table",function(e){var t=$('.config-table [name="table"]');$.ajax({url:"database-table-list.php",type:"GET",dataType:"JSON",success:function(e){var r,n;for(r in t.replaceWith($('<select name="table" id="table"></select>')),e)n=e[r].table_name,$('.config-table [name="table"]').append('<option value="'+n+'">'+n+"</option>")},error:function(e,t){}})}),$(document).on("click","#load_structure",function(e){var t=".main-table tbody",r=$('.config-table [name="host"]').val(),n=$('.config-table [name="port"]').val(),a=$('.config-table [name="username"]').val(),i=$('.config-table [name="password"]').val(),o=$('.config-table [name="database"]').val(),s=$('.config-table [name="table"]').val();""!=o&&""!=s?(loadJSONFromServer(t,"structure.php",r,n,a,i,o,s),$(".label-for-host").text(r),$(".label-for-database").text(o),$(".label-for-table").text(s),$(".define-wrapper").css({display:"block"}),$(".tabs").find(' > ul > li > a[href="#define"]').click(),$('#formgenerator input[name="table"]').val(s),setTimeout(function(){var e=isKeyWord(s),r=$(t).find(".reserved").length>0;e||r?($("#quote").attr("data-reserved","true"),$("#quote")[0].checked=!0):$("#quote").attr("data-reserved","false")},1e3)):alert("Please complete form first.")}),$(document).on("change","#quote",function(e){$("#quote")[0].checked||"true"!=$(this).attr("data-reserved")||alert("This table contain PostgreSQL reserved word. You must quote table and field name.")}),$(document).on("change keyup blur",'#formdatabase input[type="text"], #formdatabase input[type="password"]',function(e){var t=$(this).attr("name"),r=$(this).val();window.localStorage.setItem("sg_"+t,r)}),$(document).on("change",".list_filter",function(e){var t=$(this),r=t.attr("value"),n=t.attr("name");if(t[0].checked){var a=getContraVal(r);$('[name="'+n+'"][value="'+a+'"]')[0].checked=!1,console.log(a)}}),loadConfig()});var SQLFromServer="";function loadJSONFromServer(e,t,r,n,a,i,o,s){$(e).empty(),$.ajax({url:t,data:{host:r,port:n,username:a,password:i,database:o,table:s},type:"POST",dataType:"JSON",success:function(t){var r,n,a,i,o=t.fields;SQLFromServer=Base64.decode(t.query);var s=!1;for(r in o)"sort_order"==(n=o[r].column_name)&&(s=!0),i=generateRow(n,a={type:o[r].data_type}),$(e).append(i);s?$("#manualsortorder").parent().css({display:"inline"}):($("#manualsortorder").parent().css({display:"none"}),$("#manualsortorder")[0].checked=!1),loadState(getSavedData($("#formdatabase")),$("#formdatabase"),$("#formgenerator"))}})}function generateSelectFilter(e,t){(t=t||{}).type=t.type||"text";var r,n,a,i,o=t.type,s={FILTER_SANITIZE_NUMBER_INT:["bit","varbit","smallint","int","integer","bigint","smallserial","serial","bigserial","bool","boolean"],FILTER_SANITIZE_NUMBER_FLOAT:["numeric","double","real","money"],FILTER_SANITIZE_SPECIAL_CHARS:["char","character","varchar","character varying","text","date","timestamp","time"]};r=$('<select name="filter_type_'+e+'" id="filter_type_'+e+'">\r\n<option value="FILTER_SANITIZE_NUMBER_INT">NUMBER_INT</option>\r\n<option value="FILTER_SANITIZE_NUMBER_UINT">NUMBER_UINT</option>\r\n<option value="FILTER_SANITIZE_NUMBER_OCTAL">NUMBER_OCTAL</option>\r\n<option value="FILTER_SANITIZE_NUMBER_HEXADECIMAL">NUMBER_HEXADECIMAL</option>\r\n<option value="FILTER_SANITIZE_NUMBER_FLOAT">NUMBER_FLOAT</option>\r\n<option value="FILTER_SANITIZE_STRING">STRING</option>\r\n<option value="FILTER_SANITIZE_STRING_INLINE">STRING_INLINE</option>\r\n<option value="FILTER_SANITIZE_NO_DOUBLE_SPACE">NO_DOUBLE_SPACE</option>\r\n<option value="FILTER_SANITIZE_STRIPPED">STRIPPED</option>\r\n<option value="FILTER_SANITIZE_SPECIAL_CHARS">SPECIAL_CHARS</option>\r\n<option value="FILTER_SANITIZE_ALPHA">ALPHA</option>\r\n<option value="FILTER_SANITIZE_ALPHANUMERIC">ALPHANUMERIC</option>\r\n<option value="FILTER_SANITIZE_ALPHANUMERICPUNC">ALPHANUMERICPUNC</option>\r\n<option value="FILTER_SANITIZE_STRING_BASE64">STRING_BASE64</option>\r\n<option value="FILTER_SANITIZE_EMAIL">EMAIL</option>\r\n<option value="FILTER_SANITIZE_URL">URL</option>\r\n<option value="FILTER_SANITIZE_IP">IP</option>\r\n<option value="FILTER_SANITIZE_ENCODED">ENCODED</option>\r\n<option value="FILTER_SANITIZE_COLOR">COLOR</option>\r\n<option value="FILTER_SANITIZE_MAGIC_QUOTES">MAGIC_QUOTES</option>\r\n<option value="FILTER_SANITIZE_PASSWORD">PASSWORD</option>\r\n</select>\r\n');var l="FILTER_SANITIZE_SPECIAL_CHARS",p=!1;for(n in s){for(i in a=s[n])if(-1!=o.indexOf(a[i])){l=n,p=!0;break}if(p)break}return r.find("option").each(function(e,t){$(this).removeAttr("selected")}),r.find('option[value="'+l+'"]').attr("selected","selected"),r[0].outerHTML}function generateSelectType(e,t){(t=t||{}).type=t.type||"text";var r,n,a,i,o=t.type,s={int:["bit","varbit","smallint","int","integer","bigint","smallserial","serial","bigserial","bool","boolean"],float:["numeric","double","real","money"],text:["char","character","varchar","character varying","text","enum"],date:["date"],datetime:["datetime","timestamp"],time:["time"]};r=$('<select name="data_type_'+e+'" id="data_type_'+e+'">\r\n<option value="text" title="&lt;input type=&quot;text&quot;&gt;">text</option>\r\n<option value="email" title="&lt;input type=&quot;email&quot;&gt;">email</option>\r\n<option value="tel" title="&lt;input type=&quot;tel&quot;&gt;">tel</option>\r\n<option value="password" title="&lt;input type=&quot;password&quot;&gt;">password</option>\r\n<option value="int" title="&lt;input type=&quot;number&quot;&gt;">int</option>\r\n<option value="float" title="&lt;input type=&quot;number&quot; step=&quot;any&quot;&gt;">float</option>\r\n<option value="date" title="&lt;input type=&quot;text&quot;&gt;">date</option>\r\n<option value="time" title="&lt;input type=&quot;text&quot;&gt;">time</option>\r\n<option value="datetime" title="&lt;input type=&quot;text&quot;&gt;">datetime</option>\r\n<option value="color" title="&lt;input type=&quot;text&quot;&gt;">color</option>\r\n</select>\r\n');var l="FILTER_SANITIZE_SPECIAL_CHARS",p=!1;for(n in s){for(i in a=s[n])if(-1!=o.indexOf(a[i])){l=n,p=!0;break}if(p)break}return r.find("option").each(function(e,t){$(this).removeAttr("selected")}),r.find('option[value="'+l+'"]').attr("selected","selected"),r[0].outerHTML}function arrayUnique(e){var t,r=[];for(t=0;t<e.length;t++)-1==r.indexOf(e[t])&&r.push(e[t]);return r}function isKeyWord(e){e=e.toString();var t,r=keyWords.split(",");for(t in r)if(e.equalIgnoreCase(r[t]))return!0;return!1}String.prototype.equalIgnoreCase=function(e){return this.toLowerCase()==e.toLowerCase()};var keyWords="absolute,action,add,after,aggregate,alias,all,allocate,alter,analyse,analyze,and,any,are,array,as,asc,assertion,at,authorization,avg,before,begin,between,binary,bit,bit_length,blob,boolean,both,breadth,by,call,cascade,cascaded,case,cast,catalog,char,character,character_length,char_length,check,class,clob,close,coalesce,collate,collation,column,commit,completion,connect,connection,constraint,constraints,constructor,continue,convert,corresponding,count,create,cross,cube,current,current_date,current_path,current_role,current_time,current_timestamp,current_user,cursor,cycle,data,date,day,deallocate,dec,decimal,declare,default,deferrable,deferred,delete,depth,deref,desc,describe,descriptor,destroy,destructor,deterministic,diagnostics,dictionary,disconnect,distinct,do,domain,double,drop,dynamic,each,else,end,end-exec,equals,escape,every,except,exception,exec,execute,exists,external,extract,false,fetch,first,float,for,foreign,found,free,from,full,function,general,get,global,go,goto,grant,group,grouping,having,host,hour,identity,ignore,immediate,in,indicator,initialize,initially,inner,inout,input,insensitive,insert,int,integer,intersect,interval,into,is,isolation,iterate,join,key,language,large,last,lateral,leading,left,less,level,like,limit,local,localtime,localtimestamp,locator,lower,map,match,max,min,minute,modifies,modify,month,names,national,natural,nchar,nclob,new,next,no,none,not,null,nullif,numeric,object,octet_length,of,off,offset,old,on,only,open,operation,option,or,order,ordinality,out,outer,output,overlaps,pad,parameter,parameters,partial,path,placing,position,postfix,precision,prefix,preorder,prepare,preserve,primary,prior,privileges,procedure,public,read,reads,real,recursive,ref,references,referencing,relative,restrict,result,return,returns,revoke,right,role,rollback,rollup,routine,row,rows,savepoint,schema,scope,scroll,search,second,section,select,sequence,session,session_user,set,sets,size,smallint,some,space,specific,specifictype,sql,sqlcode,sqlerror,sqlexception,sqlstate,sqlwarning,start,state,statement,static,structure,substring,sum,system_user,table,temporary,terminate,than,then,time,timestamp,timezone_hour,timezone_minute,to,trailing,transaction,translate,translation,treat,trigger,trim,true,under,union,unique,unknown,unnest,update,upper,usage,user,using,value,values,varchar,variable,varying,view,when,whenever,where,with,without,work,write,year,zone";function generateRow(e,t){var r;return"<tr"+(isKeyWord(e)?' class="reserved"':"")+'>\r\n  <td class="field-name">'+e+'<input type="hidden" name="field" value="'+e+'"></td>\r\n  <td><input type="text" name="caption_'+e+'" value="'+e.replaceAll("_"," ").capitalize().prettify().trim()+'" autocomplete="off" spellcheck="false"></td>\r\n  <td align="center"><input type="checkbox" class="include_insert" name="include_insert_'+e+'" value="1" checked="checked"></td>\r\n  <td align="center"><input type="checkbox" class="include_edit" name="include_edit_'+e+'" value="1" checked="checked"></td>\r\n  <td align="center"><input type="checkbox" class="include_detail" name="include_detail_'+e+'" value="1" checked="checked"></td>\r\n  <td align="center"><input type="checkbox" class="include_list" name="include_list_'+e+'" value="1" checked="checked"></td>\r\n  <td align="center"><input type="checkbox" class="include_key" name="include_key_'+e+'" value="1"></td>\r\n  <td align="center"><input type="checkbox" class="include_required" name="include_required_'+e+'" value="1"></td>\r\n  <td align="center"><input type="radio" name="element_type_'+e+'" value="text" checked="checked"></td>\r\n  <td align="center"><input type="radio" name="element_type_'+e+'" value="textarea"></td>\r\n  <td align="center"><input type="radio" name="element_type_'+e+'" value="select"></td>\r\n  <td align="center"><input type="radio" name="element_type_'+e+'" value="checkbox"></td>\r\n  <td align="center"><input type="checkbox" name="list_filter_'+e+'" value="text" class="list_filter"></td>\r\n  <td align="center"><input type="checkbox" name="list_filter_'+e+'" value="select" class="list_filter"></td>\r\n  <td>\r\n'+generateSelectType(e,t)+"  </td>\r\n  <td>\r\n"+generateSelectFilter(e,t)+"  </td>\r\n</tr>\r\n"}String.prototype.replaceAll=function(e,t,r){return this.replace(RegExp(e.replace(/([\/\,\!\\\^\$\{\}\[\]\(\)\.\*\+\?\|\<\>\-\&])/g,"\\$&"),r?"gi":"g"),"string"==typeof t?t.replace(/\$/g,"$$$$"):t)},String.prototype.capitalize=function(){return this.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})},String.prototype.prettify=function(){var e,t,r=this.split(" ");for(e in r)switch(t=r[e]){case"Id":r[e]="";break;case"Ip":r[e]="IP"}return r.join(" ")};