let initielized=!1,currentEntity="",currentModule="",currentEntity2Translated="",lastErrorLine=-1,ajaxPending=0;function increaseAjaxPending(){ajaxPending++,updatePendingBar()}function decreaseAjaxPending(){ajaxPending--,updatePendingBar()}function resetWorkspaceSearch(){$("#search-workspace").val(""),doFilterWorkspace($("#search-workspace"))}function resetApplicationSearch(){$("#search-application").val(""),doFilterApplication($("#search-application"))}function updatePendingBar(){$(".ajax-pending").css("width",20*ajaxPending+"px")}let keyWords="absolute,action,add,after,aggregate,alias,all,allocate,alter,analyse,analyze,and,any,are,array,as,asc,assertion,at,authorization,avg,before,begin,between,binary,bit,bit_length,blob,boolean,both,breadth,by,call,cascade,cascaded,case,cast,catalog,char,character,character_length,char_length,check,class,clob,close,coalesce,collate,collation,column,commit,completion,connect,connection,constraint,constraints,constructor,continue,convert,corresponding,count,create,cross,cube,current,current_date,current_path,current_role,current_time,current_timestamp,current_user,cursor,cycle,data,date,day,deallocate,dec,decimal,declare,default,deferrable,deferred,delete,depth,deref,desc,describe,descriptor,destroy,destructor,deterministic,diagnostics,dictionary,disconnect,distinct,do,domain,double,drop,dynamic,each,else,end,end-exec,equals,escape,every,except,exception,exec,execute,exists,external,extract,false,fetch,first,float,for,foreign,found,free,from,full,function,general,get,global,go,goto,grant,group,grouping,having,host,hour,identity,ignore,immediate,in,indicator,initialize,initially,inner,inout,input,insensitive,insert,int,integer,intersect,interval,into,is,isolation,iterate,join,key,language,large,last,lateral,leading,left,less,level,like,limit,local,localtime,localtimestamp,locator,lower,map,match,max,min,minute,modifies,modify,month,names,national,natural,nchar,nclob,new,next,no,none,not,null,nullif,numeric,object,octet_length,of,off,offset,old,on,only,open,operation,option,or,order,ordinality,out,outer,output,overlaps,pad,parameter,parameters,partial,path,placing,position,postfix,precision,prefix,preorder,prepare,preserve,primary,prior,privileges,procedure,public,read,reads,real,recursive,ref,references,referencing,relative,restrict,result,return,returns,revoke,right,role,rollback,rollup,routine,row,rows,savepoint,schema,scope,scroll,search,second,section,select,sequence,session,session_user,set,sets,size,smallint,some,space,specific,specifictype,sql,sqlcode,sqlerror,sqlexception,sqlstate,sqlwarning,start,state,statement,static,structure,substring,sum,system_user,table,temporary,terminate,than,then,time,timestamp,timezone_hour,timezone_minute,to,trailing,transaction,translate,translation,treat,trigger,trim,true,under,union,unique,unknown,unnest,update,upper,usage,user,using,value,values,varchar,variable,varying,view,when,whenever,where,with,without,work,write,year,zone";function doFilterWorkspace(e){let t=$(e).val().toLowerCase().trim();$(".workspace-card > div").filter(function(){$(this).toggle($(this).find(".card-title").text().toLowerCase().includes(t))})}function doFilterApplication(e){let t=$(e).val().toLowerCase().trim();$(".application-card > div").filter(function(){$(this).toggle($(this).find(".card-title").text().toLowerCase().includes(t))})}String.prototype.equalIgnoreCase=function(e){return this.toLowerCase()==e.toLowerCase()},String.prototype.replaceAll=function(e,t,a){return this.replace(RegExp(e.replace(/([\/\,\!\\\^\$\{\}\[\]\(\)\.\*\+\?\|\<\>\-\&])/g,"\\$&"),a?"gi":"g"),"string"==typeof t?t.replace(/\$/g,"$$$$"):t)},String.prototype.replaceAll=function(e,t,a){return this.replace(RegExp(e.replace(/([\/\,\!\\\^\$\{\}\[\]\(\)\.\*\+\?\|\<\>\-\&])/g,"\\$&"),a?"gi":"g"),"string"==typeof t?t.replace(/\$/g,"$$$$"):t)},String.prototype.capitalize=function(){return this.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()})},String.prototype.prettify=function(){let e,t,a=this.split(" ");for(e=0;e<a.length;e++)switch(t=a[e]){case"Id":a[e]="";break;case"Ip":a[e]="IP"}return a.join(" ")},String.prototype.replaceAll=function(e,t){return this.replace(RegExp(e,"g"),t)},jQuery(function(){$(document).on("change",".multiple-selection",function(e){let t=$(this).val();$(".multiple-selection").val(t)}),$(document).on("click","#vscode",function(){let e=$("#current_application option:selected").attr("data-directory");window.location="vscode://file/"+e}),$(document).on("click","#load_table",function(e){e.preventDefault(),loadTable()}),$(document).on("click","#load_column",function(e){e.preventDefault();let t=$('[name="source_table"]').val(),a=$("table.main-table tbody");loadColumn(t,a)}),$(document).on("change",'select[name="source_table"]',function(e){let t=$(this).val(),a=$(this).find("option:selected").attr("data-primary-key")||"";updateTableName(t+".php",t,t,t,a)}),$(document).on("click",".button-save-application-config",function(e){e.preventDefault();let t=$(this).closest(".modal").find("form"),a=t.serializeArray(),n={name:t.find('[name="application_name"]').val(),architecture:t.find('[name="application_architecture"]').val(),base_application_directory:t.find('[name="application_base_directory"]').val(),description:t.find('[name="description"]').val(),database:{},sessions:{},entity_info:{},module_location:[]};for(let i in t.find(".path-manager tbody tr").each(function(e){let t=$(this).find('[name^="name"]'),a=$(this).find('[name^="path"]'),i=$(this).find('[name^="checked"]');n.module_location.push({name:t.val(),path:a.val(),active:i[0].checked})}),a){let l=a[i].name;-1!==l.indexOf("database_")&&(n.database[l.substring(9)]=a[i].value),-1!==l.indexOf("sessions_")&&(n.sessions[l.substring(9)]=a[i].value),-1!==l.indexOf("entity_info_")&&(n.entity_info[l.substring(12)]=a[i].value)}n.application_id=t.find('[name="application_id"]').val(),updateCurrentApplivation(n),$("#modal-application-setting").modal("hide")}),$(document).on("click","#generate_script",function(e){e.preventDefault(),asyncAlert("Do you want to generate the module and entities and replace the existing files?","Confirmation",[{caption:"Yes",fn(){generateScript($(".main-table tbody"))},class:"btn-primary"},{caption:"No",fn(){},class:"btn-secondary"}])}),$(document).on("click","#switch_application",function(e){e.preventDefault(),switchApplication($("#current_application").val())}),$(document).on("change",".input-field-filter",function(e){let t=$(this)[0].checked,a=$(this).attr("value");t?($(this).closest("tr").find('.input-field-filter[value!="'+a+'"]')[0].checked=!1,prepareReferenceFilter(a,$(this))):$(this).closest("tr").find(".reference_button_filter").css("display","none")}),$(document).on("change",".input-element-type",function(e){let t=$(this).attr("value");prepareReferenceData(t,$(this))}),$(document).on("click",".reference_button_data",function(e){e.preventDefault(),$("#modal-create-reference-data").find(".modal-title").text("Create Data Reference"),$("#modal-create-reference-data").attr("data-reference-type","data");let t=$(this).closest("tr").attr("data-field-name"),a=$(this).siblings("input").attr("name");$("#modal-create-reference-data").attr("data-input-name",a),$("#modal-create-reference-data").attr("data-field-name",t),$("#modal-create-reference-data").find(".modal-body").empty(),$("#modal-create-reference-data").find(".modal-body").append(getReferenceResource());let n=$('[name="'+a+'"]').val();if(n.length<60&&loadReference(t,a,function(e){null!=e&&deserializeForm(e)}),n.length>20){let i=parseJsonData(n);"object"!=typeof i&&(i={}),deserializeForm(i)}$("#modal-create-reference-data").modal("show")}),$(document).on("click",".reference_button_filter",function(e){e.preventDefault(),$("#modal-create-reference-data").find(".modal-title").text("Create Filter Reference"),$("#modal-create-reference-data").attr("data-reference-type","filter");let t=$(this).closest("tr").attr("data-field-name"),a=$(this).siblings("input").attr("name");$("#modal-create-reference-data").attr("data-input-name",a),$("#modal-create-reference-data").attr("data-field-name",t),$("#modal-create-reference-data").find(".modal-body").empty(),$("#modal-create-reference-data").find(".modal-body").append(getReferenceResource());let n=$('[name="'+a+'"]').val().trim();if(n.length<60&&loadReference(t,a,function(e){null!=e&&deserializeForm(e)}),n.length>20){let i=parseJsonData(n);"object"!=typeof i&&(i={}),deserializeForm(i)}$("#modal-create-reference-data").modal("show")}),$(document).on("click","#apply_reference",function(e){let t=$("#modal-create-reference-data").attr("data-input-name"),a=JSON.stringify(serializeForm());$('[name="'+t+'"]').val(a),$("#modal-create-reference-data").modal("hide")}),$(document).on("click","#save_to_cache",function(e){let t=$("#modal-create-reference-data").attr("data-field-name"),a=$("#modal-create-reference-data").attr("data-input-name"),n=JSON.stringify(serializeForm());saveReference(t,a,n)}),$(document).on("click","#load_from_cache",function(e){let t=$("#modal-create-reference-data").attr("data-field-name"),a=$("#modal-create-reference-data").attr("data-input-name");loadReference(t,a,function(e){null!=e&&deserializeForm(e)})}),$(document).on("click",".reference_type",function(e){let t=$(this).val();selectReferenceType({type:t})}),$(document).on("click",".btn-add-column",function(e){let t=$(this).closest("table");addColumn(t)}),$(document).on("click",".btn-remove-last-column",function(e){let t=$(this).closest("table");removeLastColumn(t)}),$(document).on("click",".btn-add-row",function(e){let t=$(this).closest("table");addRow(t)}),$(document).on("click",".btn-remove-row",function(e){let t=$(this).closest("tbody").find("tr").length;if(t>1){let a=$(this).closest("tr");asyncAlert("Do you want to remove this row?","Deletion Confirmation",[{caption:"Yes",fn(){a.remove()},class:"btn-primary"},{caption:"No",fn(){},class:"btn-secondary"}])}else 1==t&&"true"==$(this).closest("table").attr("data-empty-on-remove")&&$(this).closest("tr").find(":input").each(function(e){$(this).val("")})}),$(document).on("change",'.map-section input[type="checkbox"]',function(e){$(this)[0].checked&&$(this).closest("tr").siblings().each(function(){$(this).find('input[type="checkbox"]')[0].checked=!1})}),$(document).on("change",".entity-container-query .entity-checkbox",function(e){let t=getEntitySelection(),a=$(".entity-merge")[0].checked;getEntityQuery(t,a)}),$(document).on("change",".entity-merge",function(e){let t=getEntitySelection(),a=$(".entity-merge")[0].checked;getEntityQuery(t,a)}),$(document).on("change",".entity-check-controll",function(e){let t=$(this)[0].checked;$(".entity-checkbox-query").each(function(){$(this)[0].checked=t});let a=getEntitySelection(),n=$(".entity-merge")[0].checked;getEntityQuery(a,n)}),$(document).on("click","#create_new_app",function(e){e.preventDefault();let t=$(this).closest(".modal"),a=t.find('[name="application_name"]').val().trim(),n=t.find('[name="application_architecture"]').val().trim(),i=t.find('[name="application_description"]').val().trim(),l=t.find('[name="application_id"]').val().trim(),o=t.find('[name="application_directory"]').val().trim(),r=t.find('[name="application_namespace"]').val().trim(),c=t.find('[name="application_workspace_id"]').val().trim(),d=t.find('[name="application_author"]').val().trim(),s=t.find('[name="magic_app_version"]').val().trim(),p=[];$("#modal-create-application table.path-manager tbody tr").each(function(){let e=$(this),t=e.find('td:nth-child(1) input[type="text"]').val(),a=e.find('td:nth-child(2) input[type="text"]').val(),n=e.find('td:nth-child(3) input[type="checkbox"]')[0].checked;p.push({name:t,path:a,active:n})}),""!=a&&""!=l&&""!=o&&""!=d&&(increaseAjaxPending(),$.ajax({method:"POST",url:"lib.ajax/application-create.php",dataType:"html",data:{id:l,name:a,architecture:n,description:i,directory:o,namespace:r,workspace_id:c,author:d,paths:p,magic_app_version:s},success:function(e){loadAllResource(),decreaseAjaxPending()},error:function(e,t){decreaseAjaxPending()}})),$(t).modal("hide")}),$("#modal-workspace").on("show.bs.modal",function(e){resetWorkspaceSearch()}),$("#modal-update-path").on("show.bs.modal",function(e){increaseAjaxPending(),$.ajax({method:"POST",url:"lib.ajax/application-path.php",data:{action:"get"},success:function(e){for(decreaseAjaxPending();$("#modal-update-path table.path-manager > tbody > tr").length>1;)$("#modal-update-path table.path-manager > tbody > tr:last").remove();for(let t in e){if(t>0){let a=$("#modal-update-path table.path-manager > tbody > tr:first").clone();$("#modal-update-path table.path-manager > tbody").append(a)}let n=$("#modal-update-path table.path-manager > tbody > tr:nth-child("+(parseInt(t)+1)+")");n.find('input[type="text"].location-path').val(e[t].path),n.find('input[type="text"].location-name').val(e[t].name),n.find('input[type="checkbox"]')[0].checked=e[t].active}fixPathForm()}})}),$(document).on("click","#update_module_path",function(e){e.preventDefault();let t=[];$("#modal-update-path table.path-manager tbody tr").each(function(){let e=$(this),a=e.find('td:nth-child(1) input[type="text"]').val(),n=e.find('td:nth-child(2) input[type="text"]').val(),i=e.find('td:nth-child(3) input[type="checkbox"]')[0].checked;t.push({name:a,path:n,active:i})});let a=$("#current_module_location");t.length>0&&(increaseAjaxPending(),$.ajax({method:"POST",url:"lib.ajax/application-path.php",data:{action:"update",paths:t},success:function(e){for(let t in decreaseAjaxPending(),a.empty(),e)a[0].options[a[0].options.length]=new Option(e[t].name+" - "+e[t].path,e[t].path),e[t].active&&a.val(e[t].path);for(;$("#modal-update-path table.path-manager tbody tr").length>1;)$("#modal-update-path table.path-manager tbody tr:last-child").remove();$('#modal-update-path table.path-manager tbody tr input[type="text"]').val("")}})),$("#modal-update-path").modal("hide")}),$(document).on("click","#update_current_location",function(e){e.preventDefault();let t=$("#current_module_location");increaseAjaxPending(),$.ajax({method:"POST",url:"lib.ajax/application-path.php",data:{action:"default",selected_path:t.val()},success:function(e){for(let a in decreaseAjaxPending(),t.empty(),e)t[0].options[t[0].options.length]=new Option(e[a].name+" - "+e[a].path,e[a].path),e[a].active&&t.val(e[a].path)}})}),$(document).on("click",".entity-container-file .entity-li a",function(e){e.preventDefault();let t=$(this).attr("data-entity-name"),a=$(this);getEntityFile([t],function(){$(".entity-container-file .entity-li").removeClass("selected-file"),a.closest("li").addClass("selected-file")})}),$(document).on("click",".module-list-file .file-li a",function(e){e.preventDefault();let t=$(this).attr("data-file-name"),a=$(this);getModuleFile(t,function(){$(".file-li").removeClass("selected-file"),a.parent().addClass("selected-file")})}),$(document).on("click",".entity-container-query .entity-li a",function(e){e.preventDefault();let t=$(this).attr("data-entity-name");getEntityQuery([t])}),$(document).on("click","#button_save_module_file",function(e){e.preventDefault(),saveModule()}),$(document).on("click","#button_save_entity_file",function(e){e.preventDefault(),saveEntity()}),$(document).on("click","#button_save_entity_file_as",function(e){e.preventDefault(),saveEntityAs()}),$(document).on("click","#button_save_entity_query",function(e){e.preventDefault(),saveQuery()}),$("tbody.data-table-manual-sort").each(function(e){let t=$(this)[0];Sortable.create(t,{animation:150,scroll:!0,handle:".data-sort-handler",onEnd:function(){}})}),$(document).on("click",".add_subfix",function(e){let t=$(".rd-entity-name").val();t.endsWith("Min")||(t+="Min",$(".rd-entity-name").val(t))}),$(document).on("click",".generate_entity",function(e){let t=$(".rd-entity-name").val(),a=$(".rd-table-name").val();asyncAlert("Are you sure you want to generate the entity and replace the existing file?","Entity Generation Confirmation",[{caption:"Yes",fn(){increaseAjaxPending(),$.ajax({method:"POST",url:"lib.ajax/entity-generator.php",data:{entityName:t,tableName:a},success:function(e){decreaseAjaxPending(),updateEntityFile(),updateEntityQuery(!0),updateEntityRelationshipDiagram()}})},class:"btn-primary"},{caption:"No",fn(){},class:"btn-secondary"}])}),$(document).on("change",".map-key",function(e){onChangeMapKey($(this))}),$(document).on("keyup",".map-key",function(e){onChangeMapKey($(this))}),$(document).on("change","#export_to_excel",function(e){$(this)[0].checked&&($("#export_to_csv")[0].checked=!1,$("#export_use_temporary")[0].disabled=!0)}),$(document).on("change","#export_to_csv",function(e){$(this)[0].checked?($("#export_to_excel")[0].checked=!1,$("#export_use_temporary")[0].disabled=!1):$("#export_use_temporary")[0].disabled=!0}),$(document).on("change",".entity-container-relationship .entity-checkbox",function(e){loadDiagramMultiple()}),$(document).on("click",".reload-diagram",function(e){loadDiagramMultiple()}),$(document).on("click",".entity-container-relationship .entity-li a",function(e){e.preventDefault();let t=[];(t=addDiagramOption(t)).push("entity[]="+$(this).attr("data-entity-name")),t.push("rnd="+new Date().getTime());let a=$("<img />");a.attr("src","lib.ajax/entity-relationship-diagram.php?"+t.join("&")),$(".erd-image").empty().append(a);let n="lib.ajax/entity-relationship-diagram-map.php?"+t.join("&");$('[name="erd-map"]').load(n,function(e){a.attr("usemap","#erd-map")})}),$(document).on("click",".btn-move-up",function(e){let t=$(this).closest("tr");t.prev().length&&t.insertBefore(t.prev())}),$(document).on("click",".btn-move-down",function(e){let t=$(this).closest("tr");t.next().length&&t.insertAfter(t.next())}),$(document).on("click","table.path-manager .path-remover",function(e){if($(this).closest("tbody").find("tr").length>1){let t=$(this).closest("tr");asyncAlert("Deleting this path will not remove the directory or its files. <br>Do you want to delete this path?","Deletion Confirmation",[{caption:"Yes",fn(){t.remove()},class:"btn-primary"},{caption:"No",fn(){},class:"btn-secondary"}])}fixPathForm()}),$(document).on("click","table.path-manager .add-path",function(e){let t=$(this).closest("table").find("tbody tr:first").clone();t.find('input[type="text"]').val(""),t.find('input[type="checkbox"]').removeAttr("checked"),$(this).closest("table").find("tbody").append(t),fixPathForm()}),$(document).on("change",'[name="application_namespace"]',function(e){let t=$(this),a=t.val();"MagicObject"==a||"MagicApp"==a?t.addClass("invalid-input"):t.removeClass("invalid-input")}),$(document).on("click",".create-new-application",function(e){resetApplicationSearch();let t=$("#modal-create-application"),a=t.find("#create_new_app");a[0].disabled=!0,$('[name="application_name"]').val(""),$('[name="application_id"]').val(""),$('[name="application_directory"]').val(""),$('[name="application_workspace_id"]').val(""),$('[name="application_namespace"]').val(""),$('[name="application_author"]').val(""),$('[name="magic_app_version"]').empty(),increaseAjaxPending(),$.ajax({type:"GET",url:"lib.ajax/application-new.php",success:function(e){if(decreaseAjaxPending(),0==e.application_workspace.length){t.find(".alert").length>0&&t.find(".alert").remove();let n=$("<div />");n.addClass("alert alert-warning"),n.html("Please select a workspace before creating a new application."),t.find("form").prepend(n),a[0].disabled=!0}else{for(let i of($('[name="application_name"]').val(e.application_name),$('[name="application_id"]').val(e.application_id),$('[name="application_architecture"]').val(e.application_architecture),$('[name="application_directory"]').val(e.application_directory),$('[name="application_namespace"]').val(e.application_namespace),$('[name="application_workspace_id"]').empty(),e.application_workspace)){let l=$("<option />");l.text(i.label),l.attr("value",i.value),i.selected&&l.attr("selected","selected"),$('[name="application_workspace_id"]').append(l)}for(let o in $('[name="application_author"]').val(e.application_author),$('[name="application_description"]').val(e.application_description),e.magic_app_versions){let r=e.magic_app_versions[o].latest;$('[name="magic_app_version"]')[0].appendChild(new Option(e.magic_app_versions[o].value,e.magic_app_versions[o].key,r,r))}loadAllResource(),a[0].disabled=!1}}})}),$(document).on("click",".container-translate-entity .entity-list .entity-li a",function(e){e.preventDefault(),e.stopPropagation();let t=$(this);currentEntity2Translated=$(this).attr("data-entity-name"),translateEntity(function(){$(".container-translate-entity .entity-list .entity-li").removeClass("selected-file"),t.closest("li").addClass("selected-file")})}),$(document).on("click","#button-save-entity-translation",function(e){let t=transEd2.getDoc().getValue(),a=$(".entity-name").val(),n=$(".entity-property-name").val(),i=$(".target-language").val();increaseAjaxPending(),$.ajax({method:"POST",url:"lib.ajax/entity-translate.php",dataType:"json",data:{userAction:"set",entityName:a,translated:t,propertyNames:n,targetLanguage:i},success:function(e){decreaseAjaxPending()}})}),$(document).on("click","#button-save-module-translation",function(e){let t=transEd4.getDoc().getValue(),a=$(".module-property-name").val(),n=$(".target-language").val();increaseAjaxPending(),$.ajax({method:"POST",url:"lib.ajax/module-translate.php",dataType:"json",data:{userAction:"set",translated:t,propertyNames:a,targetLanguage:n},success:function(e){decreaseAjaxPending()}})}),$(document).on("change",".target-language",function(e){let t=$(this).val(),a=$(this).attr("data-translate-for");$(".target-language").val(t),reloadTranslate(a)}),$(document).on("change",".filter-translate",function(e){let t=$(this).val(),a=$(this).attr("data-translate-for");$(".filter-translate").val(t),reloadTranslate(a)}),$(document).on("change",".select-module",function(e){let t=$(this)[0].checked;$(this).closest(".module-group").find("ul li").each(function(e){$(this).find('input[type="checkbox"]')[0].checked=t}),translateModule()}),$(document).on("change",".module-for-translate",function(e){translateModule()}),$(document).on("click","table.language-manager .add-language",function(e){let t=$(this).closest("table").find("tbody tr:first").clone();t.find('input[type="text"]').val(""),t.find('input[type="checkbox"]').removeAttr("checked"),$(this).closest("table").find("tbody").append(t),fixLanguageForm()}),$(document).on("click","table.language-manager .language-remover",function(e){if($(this).closest("tbody").find("tr").length>1){let t=$(this).closest("tr");asyncAlert("Deleting this language will not remove the directory or its files. <br>Do you want to delete this language?","Deletion Confirmation",[{caption:"Yes",fn(){t.remove()},class:"btn-primary"},{caption:"No",fn(){},class:"btn-secondary"}])}fixLanguageForm()}),$("#modal-update-language").on("show.bs.modal",function(e){increaseAjaxPending(),$.ajax({method:"POST",url:"lib.ajax/application-language.php",data:{action:"get"},success:function(e){for(;$("#modal-update-language table.language-manager > tbody > tr").length>1;)$("#modal-update-language table.language-manager > tbody > tr:last").remove();for(let t in e){if(decreaseAjaxPending(),t>0){let a=$("#modal-update-language table.language-manager > tbody > tr:first").clone();$("#modal-update-language table.language-manager > tbody").append(a)}let n=$("#modal-update-language table.language-manager > tbody > tr:nth-child("+(parseInt(t)+1)+")");n.find('input[type="text"].language-name').val(e[t].name),n.find('input[type="text"].language-code').val(e[t].code),n.find('input[type="checkbox"]')[0].checked=e[t].active}fixLanguageForm()}})}),$(document).on("click","#update-application-language",function(e){e.preventDefault();let t=[];$("#modal-update-language table.language-manager tbody tr").each(function(){let e=$(this),a=e.find('td:nth-child(1) input[type="text"]').val(),n=e.find('td:nth-child(2) input[type="text"]').val(),i=e.find('td:nth-child(3) input[type="checkbox"]')[0].checked;t.push({name:a,code:n,active:i})});let a=$(".target-language");t.length>0&&(increaseAjaxPending(),$.ajax({method:"POST",url:"lib.ajax/application-language.php",data:{action:"update",languages:t},success:function(e){for(let t in decreaseAjaxPending(),a.empty(),e)for(let n=0;n<a.length;n++)a[n].options[a[n].options.length]=new Option(e[t].name+" - "+e[t].code,e[t].code),e[t].active&&a.val(e[t].code);for(;$("#modal-update-language table.language-manager tbody tr").length>1;)$("#modal-update-language table.language-manager tbody tr:last-child").remove();$('#modal-update-language table.language-manager tbody tr input[type="text"]').val("")}})),$("#modal-update-language").modal("hide")}),$(document).on("click",".button-execute-query",function(e){e.preventDefault();let t=$(this).closest(".modal");asyncAlert("Do you want to execute the queries on the current database?","Query Execution Confirmation",[{caption:"Yes",fn(){let e=cmEditorSQLExecute.getDoc().getValue();$(".button-execute-query")[0].disabled=!0,increaseAjaxPending(),$.ajax({method:"POST",url:"lib.ajax/query-execute.php",data:{action:"execute",query:e},success:function(e){decreaseAjaxPending();let a=getEntitySelection(),n=$(".entity-merge")[0].checked;getEntityQuery(a,n),t.modal("hide")}})},class:"btn-primary"},{caption:"No",fn(){},class:"btn-secondary"}])}),$(document).on("click",".default-language",function(e){e.preventDefault();let t=$(".target-language");increaseAjaxPending(),$.ajax({method:"POST",url:"lib.ajax/application-language.php",data:{action:"default",selected_language:t.val()},success:function(e){for(let a in decreaseAjaxPending(),t.empty(),e)for(let n=0;n<t.length;n++)t[n].options[t[n].options.length]=new Option(e[a].name+" - "+e[a].code,e[a].code),e[a].active&&t.val(e[a].code)}})}),$(document).on("click","area",function(e){e.preventDefault();let t=$(this).attr("data-type"),a={},n="",i="";if("area-relation"==t){i="lib.ajax/entity-relationship.php",n="Entity Relationship";let l=$(this).attr("data-namespace"),o=$(this).attr("data-entity"),r=$(this).attr("data-table-name"),c=$(this).attr("data-column-name"),d=$(this).attr("data-reference-namespace"),s=$(this).attr("data-reference-entity"),p=$(this).attr("data-reference-table-name"),u=$(this).attr("data-reference-column-name");a={dataType:t,namespaceName:l,entityName:o,tableName:r,columnName:c,referenceNamespaceName:d,referenceEntityName:s,referenceTableName:p,referenceColumnName:u}}else{i="lib.ajax/entity-detail.php",n="Entity Detail";let m=$(this).attr("data-namespace"),f=$(this).attr("data-entity"),h=$(this).attr("data-table-name");a={dataType:t,namespaceName:m,entityName:f,tableName:h}}$(".entity-detail").empty(),$(".entity-detail").append('<div style="text-align: center;"><span class="animation-wave"><span></span></span></div>'),$("#modal-entity-detail .modal-title").html(n),$("#modal-entity-detail").modal("show"),increaseAjaxPending(),$.ajax({type:"GET",dataType:"html",url:i,data:a,success:function(e){decreaseAjaxPending(),$(".entity-detail").empty(),$(".entity-detail").append(e)}})}),$(document).on("click",".button-application-setting",function(e){e.preventDefault();let t=$("#modal-application-setting .button-save-application-config");t[0].disabled=!0;let a=$(this).closest(".application-item").attr("data-application-id");$("#modal-application-setting").modal("show"),$("#modal-application-setting .application-setting").empty(),increaseAjaxPending(),$.ajax({type:"GET",url:"lib.ajax/application-setting.php",data:{applicationId:a},dataType:"html",success:function(e){decreaseAjaxPending(),$("#modal-application-setting .application-setting").empty().append(e),setTimeout(function(){$("#modal-application-setting .application-setting").find('[name="database_password"]').val("")},2e3),loadAllResource(),t[0].disabled=!1}})}),$(document).on("click",".button-application-database",function(e){e.preventDefault();let t=$(this).closest(".application-item").attr("data-application-id");$("#modal-database-explorer .database-explorer").html('<iframe src="database-explorer/?applicationId='+t+'"></iframe>'),$("#modal-database-explorer").modal("show")}),$(document).on("click","#button_explore_database",function(e){e.preventDefault(),$("#modal-database-explorer .database-explorer").html('<iframe src="database-explorer/"></iframe>'),$("#modal-database-explorer").modal("show")}),$(document).on("click",".button-application-menu",function(e){e.preventDefault();let t=$("#modal-application-menu .button-save-menu");t[0].disabled=!0;let a=$(this).closest(".application-item").attr("data-application-id"),n=$("#modal-application-menu");n.find(".modal-body").empty(),n.find(".modal-body").append('<div style="text-align: center;"><span class="animation-wave"><span></span></span></div>'),n.attr("data-application-id",a),n.modal("show"),increaseAjaxPending(),$.ajax({type:"GET",url:"lib.ajax/application-menu.php",data:{applicationId:a},dataType:"html",success:function(e){decreaseAjaxPending(),$("#modal-application-menu .modal-body").empty().append(e),loadAllResource(),t[0].disabled=!1,initMenu()}})}),$(document).on("click","#modal-application-menu .button-save-menu",function(e){e.preventDefault();let t=$(this).closest(".modal"),a=t.attr("data-application-id"),n=JSON.stringify(serializeMenu());increaseAjaxPending(),$.ajax({type:"POST",url:"lib.ajax/application-menu-update.php",data:{applicationId:a,data:n},success:function(e){decreaseAjaxPending(),t.modal("hide"),loadMenu()}})}),$(document).on("click","#modal-application-menu .button-add-menu",function(e){e.preventDefault(),$("#new_menu").val(""),$("#modal-application-menu-add").modal("show"),setTimeout(function(){$("#new_menu").val(""),$("#new_menu").focus()},600)}),$(document).on("click","#modal-application-menu-add .button-apply-new-menu",function(e){e.preventDefault();let t=$(this).closest(".modal"),a=!1,n=$("#new_menu").val(),i=serializeMenu();for(let l in i)i[l].label.toLowerCase()==n.toLowerCase()&&(a=!0);if(a)$("#new_menu").select();else{let o="";o+='<li class="sortable-menu-item">\r\n',o+='<span class="sortable-icon icon-move-up" onclick="moveUp(this)"></span>\r\n',o+='<span class="sortable-icon icon-move-down" onclick="moveDown(this)"></span>\r\n',o+='<span class="sortable-icon icon-edit" onclick="editMenu(this)"></span>\r\n',o+='<a class="app-menu app-menu-text" href="#">'+n+"</a>\r\n",o+='<span class="sortable-toggle-icon"></span>\r\n',o+='<ul class="sortable-submenu">\r\n',o+="</ul>\r\n";let r=$(o+="</li>\r\n");$(".sortable-menu").append(r),r.find(".sortable-toggle-icon")[0].addEventListener("click",function(){this.parentNode.classList.toggle("expanded")}),document.querySelectorAll(".sortable-submenu-item").forEach(e=>{e.setAttribute("draggable",!0),e.addEventListener("dragstart",dragStart),e.addEventListener("dragover",dragOver),e.addEventListener("drop",dropToSubmenu)}),r[0].addEventListener("dragover",dragOver),r[0].addEventListener("drop",dropToMenu),t.modal("hide")}}),$(document).on("click",".button-workspace-scan",function(e){e.preventDefault();let t=$(this).closest(".workspace-item").attr("data-workspace-id");resetWorkspaceSearch(),increaseAjaxPending(),$.ajax({type:"GET",url:"lib.ajax/workspace-scan.php",data:{workspaceId:t},success:function(e){decreaseAjaxPending(),loadAllResource()}})}),$(document).on("click",".button-workspace-default",function(e){e.preventDefault();let t=$(this).closest(".workspace-item").attr("data-workspace-id")||"";resetWorkspaceSearch(),increaseAjaxPending(),$.ajax({type:"POST",url:"lib.ajax/workspace-default.php",data:{workspaceId:t},success:function(e){decreaseAjaxPending(),onSetDefaultWorkspace(),$('meta[name="workspace-id"]').attr("content",t),window.localStorage.setItem("workspace-id",t),resetCheckActiveWorkspace()}})}),$(document).on("click",".button-application-default",function(e){e.preventDefault();let t=$(this).closest(".application-item").attr("data-application-id")||"";resetApplicationSearch(),increaseAjaxPending(),$.ajax({type:"POST",url:"lib.ajax/application-default.php",data:{applicationId:t},success:function(e){decreaseAjaxPending(),onSetDefaultApplication(),$('meta[name="application-id"]').attr("content",t),window.localStorage.setItem("application-id",t),resetCheckActiveApplication()}})}),$(document).on("click",".button-application-open",function(e){e.preventDefault();let t=$(this).closest(".application-item").attr("data-path");window.location="vscode://file/"+t}),$(document).on("click",".button-workspace-open",function(e){e.preventDefault();let t=$(this).closest(".workspace-item").attr("data-path");window.location="vscode://file/"+t}),$(document).on("click",".refresh-application-list, .refresh-workspace-list",function(e){e.preventDefault(),resetApplicationSearch(),loadAllResource()}),$(document).on("click",".button-save-workspace",function(e){e.preventDefault();let t=$(this).closest(".modal"),a=t.find('[name="workspace_name"]').val(),n=t.find('[name="workspace_description"]').val(),i=t.find('[name="workspace_directory"]').val(),l=t.find('[name="php_path"]').val();increaseAjaxPending(),$.ajax({type:"POST",url:"lib.ajax/workspace-create.php",data:{workspaceName:a,workspaceDirectory:i,workspaceDescription:n,phpPath:l},success:function(e){decreaseAjaxPending(),t.modal("hide"),loadAllResource()},error(e){decreaseAjaxPending(),console.log(e)}})}),$(document).on("click",".sortable-menu-item > a, .sortable-submenu-item > a",function(e){e.preventDefault()}),$(document).on("dblclick",".sortable-menu-item > a, .sortable-submenu-item > a",function(e){e.preventDefault();let t=$(this).siblings(".icon-edit")[0];editMenu(t)}),$(document).on("blur",'.sortable-menu-item > input[type="text"], .sortable-submenu-item > input[type="text"]',function(e){e.preventDefault();let t=$(this),a=$(this).siblings("a.app-menu-text");t.css({display:"none"}),a.text(t.val()),a.css({display:""})}),$(document).on("click","#button_execute_entity_query",function(e){e.preventDefault(),$("#modal-query-executor").find("textarea").val(cmEditorSQL.getSelection()),cmEditorSQLExecute.setValue(cmEditorSQL.getSelection()),cmEditorSQLExecute.refresh(),$(".button-execute-query")[0].disabled=!0,$("#modal-query-executor").modal("show")}),$(document).on("change","table select[name=database_driver]",function(e){let t=$(this).find("option:selected").attr("data-base");$(this).closest("table").find("tr.database-credential").attr("data-current-database-type",t)}),$(document).on("blur keyup",'input[type="number"]',function(e){isNaN($(this).val())||""===$(this).val().trim()?$(this).addClass("input-invalid-value"):$(this).removeClass("input-invalid-value")}),$(document).on("click","#test-database-connection",function(e){let t=$(this).closest("table"),a={testConnection:"test"};t.find(":input").each(function(e){void 0!=$(this).attr("name")&&""!=$(this).attr("name")&&(a[$(this).attr("name")]=$(this).val())}),increaseAjaxPending(),$.ajax({type:"POST",url:"lib.ajax/database-test.php",data:a,dataType:"json",success:function(e){decreaseAjaxPending(),e.conneted1?e.conneted2?($("#create-database").css({display:"none"}),showAlertUI("Database Connection Test","Successfully connected to the database.")):($("#create-database").css({display:"inline"}),showAlertUI("Database Connection Test","Successfully connected to the server, but database not found.")):($("#create-database").css({display:"none"}),showAlertUI("Database Connection Test","Invalid database credentials."))},error:function(e,t,a){decreaseAjaxPending(),$("#create-database").css("display","none"),showAlertUI("Database Connection Test","There was an error connecting to the server: "+a)}})}),$(document).on("click","#create-database",function(e){let t=$(this).closest("table"),a={createDatabase:"create"};t.find(":input").each(function(e){void 0!=$(this).attr("name")&&""!=$(this).attr("name")&&(a[$(this).attr("name")]=$(this).val())}),increaseAjaxPending(),$.ajax({type:"POST",url:"lib.ajax/database-create.php",data:a,dataType:"json",success:function(e){decreaseAjaxPending(),e.conneted1?e.conneted2?($("#create-database").css({display:"none"}),showAlertUI("Database Connection Test","Successfully created and connected to the database.")):($("#create-database").css({display:"inline"}),showAlertUI("Database Connection Test","Successfully connected to the server, but database creation failed.")):($("#create-database").css({display:"none"}),showAlertUI("Database Connection Test","Invalid database credentials."))},error:function(e,t,a){decreaseAjaxPending(),$("#create-database").css("display","none"),showAlertUI("Database Connection Test","There was an error connecting to the server: "+a)}})}),$(document).on("click",".use-original",function(e){$(".entity-info-key").each(function(e){$(this).val($(this).attr("data-original"))})}),$(document).on("click",".use-indonesian",function(e){$(".entity-info-key").each(function(e){$(this).val($(this).attr("data-indonesian"))})}),$(document).on("keyup","#search-workspace",function(e){doFilterWorkspace($(this))}),$(document).on("keyup","#search-application",function(e){doFilterApplication($(this))});let e=$('meta[name="workspace-id"]').attr("content")||"",t=$('meta[name="application-id"]').attr("content")||"";window.localStorage.setItem("workspace-id",e),window.localStorage.setItem("application-id",t),loadAllResource(),resetCheckActiveWorkspace(),resetCheckActiveApplication()});let toCheckActiveWorkspace=setInterval("",1e7),toCheckActiveApplication=setInterval("",1e7),checkIntervalWorkspace=1e4,checkIntervalApplication=12e3;function resetCheckActiveWorkspace(){clearInterval(toCheckActiveWorkspace),toCheckActiveWorkspace=setInterval(function(){let e=window.localStorage.getItem("workspace-id")||"",t=$('meta[name="workspace-id"]').attr("content");""!=e&&""!=t&&t!=e&&loadAllResource()},checkIntervalWorkspace)}function resetCheckActiveApplication(){clearInterval(toCheckActiveApplication),toCheckActiveApplication=setInterval(function(){let e=window.localStorage.getItem("application-id")||"",t=$('meta[name="application-id"]').attr("content");""!=e&&""!=t&&t!=e&&loadAllResource()},checkIntervalApplication)}function loadWorkspaceList(){increaseAjaxPending(),$.ajax({type:"GET",url:"lib.ajax/workspace-list.php",success:function(e){decreaseAjaxPending(),$(".workspace-card").empty().append(e);let t=$('.workspace-item[data-selected="true"]').attr("data-workspace-id")||"";window.localStorage.setItem("workspace-id",t),$('meta[name="workspace-id"]').attr("content",t)}})}function loadApplicationList(){increaseAjaxPending(),$.ajax({type:"GET",url:"lib.ajax/application-list.php",success:function(e){decreaseAjaxPending(),$(".application-card").empty().append(e);let t=$('.application-item[data-selected="true"]').attr("data-application-id")||"";window.localStorage.setItem("application-id",t),$('meta[name="application-id"]').attr("content",t)}})}function loadLanguageList(){increaseAjaxPending(),$.ajax({type:"GET",url:"lib.ajax/application-path-list.php",dataType:"json",success:function(e){for(let t in decreaseAjaxPending(),$('[name="current_module_location"]').empty(),e)$('[name="current_module_location"]')[0].append(new Option(e[t].name+" - "+e[t].path,e[t].path,e[t].active,e[t].active))}})}function loadPathList(){increaseAjaxPending(),$.ajax({type:"GET",url:"lib.ajax/application-language-list.php",dataType:"json",success:function(e){decreaseAjaxPending(),setLanguage(e)}})}function updateQuery(){clearEditorSQL(),clearEditorSQLExecute()}function loadAllResource(){loadWorkspaceList(),loadApplicationList(),loadTable(),loadPathList(),loadLanguageList(),loadMenu(),updateEntityQuery(!1),updateEntityRelationshipDiagram(),updateEntityFile(),updateModuleFile(),initTooltip()}function onSetDefaultWorkspace(){loadWorkspaceList(),loadApplicationList(),loadTable(),loadMenu(),updateEntityQuery(!1),updateEntityRelationshipDiagram(),updateEntityFile(),updateModuleFile(),initTooltip()}function onSetDefaultApplication(){loadApplicationList(),loadTable(),loadPathList(),loadLanguageList(),loadMenu(),updateEntityQuery(!1),updateEntityRelationshipDiagram(),updateEntityFile(),updateModuleFile(),initTooltip()}function onModuleCreated(){updateEntityQuery(!1),updateEntityRelationshipDiagram(),updateEntityFile(),updateModuleFile(),initTooltip()}function updateErd(){$(".erd-image").empty(),$('[name="erd-map"]').empty()}function initTooltip(){$(document).on("mouseenter",'[name="erd-map"] area, [data-toggle="tooltip"]',function(e){let t=$(this).attr("data-title")||$(this).attr("title"),a=$('<div class="tooltip"></div>').html(t),n="true"==$(this).attr("data-html");$("body").append(a),a.addClass("visible"),n&&a.addClass("multiline"),$(document).on("mousemove",function(e){let t=a.outerWidth(),n=a.outerHeight(),i=e.pageX+15,l=e.pageY+15;i+t>$(window).width()&&(i=e.pageX-t-15),l+n>$(window).height()&&(l=e.pageY-n-15)<0&&(l=0),a.css({left:i,top:l})})}),$(document).on("mouseleave",'[name="erd-map"] area, [data-toggle="tooltip"]',function(e){$(".tooltip").remove(),$(document).off("mousemove")})}function showModal(e,t,a,n){return new Promise((i,l)=>{let o=$("#customAlert"),r=$("#alertOverlay"),c=$("#alertMessage"),d=$("#alertTitle"),s=$("#modalFooter");s.empty(),r.show(),o.modal("show"),c.html(e),d.html(t),a.forEach(e=>{let t=$("<button>").addClass(`btn ${e.class||"btn-secondary"}`).text(e.caption).on("click",()=>{o.modal("hide"),r.hide(),e.fn(),i(e.caption)});s.append(t)}),o.on("hidden.bs.modal",()=>{n&&n()})})}function asyncPrompt(e,t,a,n,i){return new Promise((l,o)=>{let r=$("#customAlert"),c=$("#alertOverlay"),d=$("#alertMessage"),s=$("#alertTitle"),p=$("#modalFooter");p.empty();let u=$("<input>").addClass("form-control").addClass("prompt-input").attr("type","text").attr("placeholder","Enter your text here").val(n);c.show(),r.modal("show");let m=$("<div />").addClass("input-label").text(e);d.empty().append(m),d.append(u),s.html(t),a.forEach(e=>{let t=$("<button>").addClass(`btn ${e.class||"btn-secondary"}`).text(e.caption).on("click",()=>{r.modal("hide"),c.hide(),"OK"===e.caption?l(u.val()):l(e.caption),e.fn()});p.append(t)}),r.on("hidden.bs.modal",()=>{i&&i()})})}async function asyncAlert(e,t,a){await showModal(e,t,a,function(){$("#alertOverlay").css({display:"none"}),$(".modal").css({overflow:"","overflow-y":"auto"})})}async function getUserInput(e,t,a,n){await asyncPrompt(e,t,a,n,function(){$("#alertOverlay").css({display:"none"}),$(".modal").css({overflow:"","overflow-y":"auto"})})}let timeoutEditMenu=setTimeout("",100);function initMenu(){document.querySelectorAll(".sortable-toggle-icon").forEach(e=>{e.addEventListener("click",function(){this.parentNode.classList.toggle("expanded")})}),document.querySelectorAll(".sortable-submenu-item").forEach(e=>{e.setAttribute("draggable",!0),e.addEventListener("dragstart",dragStart),e.addEventListener("dragover",dragOver),e.addEventListener("drop",dropToSubmenu)}),document.querySelectorAll(".icon-move-down").forEach(e=>{e.setAttribute("draggable",!0),e.addEventListener("dragstart",dragStart)}),document.querySelectorAll(".sortable-menu-item").forEach(e=>{e.addEventListener("dragover",dragOver),e.addEventListener("drop",dropToMenu)})}function editMenu(e){let t=$(e),a=t.closest("li"),n=t.siblings(".app-menu-text");a.find("input")&&a.find("input").remove();let i=$("<input />");i.attr({type:"text",class:"form-control"}),n.css("display","none"),n.before(i),i.val(n.text()),i.focus(),i.select(),i.focus()}let draggedItem=null;function dragStart(e){if(e.target.classList.contains("sortable-submenu-item"))draggedItem=e.target,e.dataTransfer.effectAllowed="move";else{let t=e.target.closest(".sortable-submenu-item");null!=t&&(draggedItem=t,t.dataTransfer&&(t.dataTransfer.effectAllowed="move"))}}function dragOver(e){e.preventDefault()}function dropToMenu(e){if(e.preventDefault(),draggedItem){if(0===e.target.classList.length){let t=e.target.closest(".sortable-menu-item");t&&(t.querySelector(".sortable-submenu").appendChild(draggedItem),t.classList.remove("expanded"),t.classList.add("expanded"))}if(e.target.classList.contains("sortable-menu-item")){if(!e.target.querySelector(".sortable-submenu")){let a=document.createElement("ul");a.classList.add("sortable-submenu"),e.target.appendChild(a)}e.target.querySelector(".sortable-submenu").appendChild(draggedItem),e.target.classList.remove("expanded"),e.target.classList.add("expanded")}(e.target.classList.contains("sortable-submenu")||e.target.classList.contains("icon-move"))&&(e.target.appendChild(draggedItem),e.target.parentNode.classList.remove("expanded"),e.target.parentNode.classList.add("expanded")),draggedItem=null}}function dropToSubmenu(e){(e.preventDefault(),e.target.classList.contains("sortable-submenu-item"))?e.offsetY>e.target.offsetHeight/2?e.target.parentNode.insertBefore(draggedItem,e.target.nextSibling):e.target.parentNode.insertBefore(draggedItem,e.target):e.target.classList.contains("sortable-submenu")&&e.target.appendChild(draggedItem)}function serializeMenu(){let e=[];return document.querySelectorAll(".sortable-menu-item").forEach(t=>{let a={label:t.querySelector("a.app-menu-text").textContent,submenus:[]};t.querySelectorAll(".sortable-submenu-item").forEach(e=>{a.submenus.push({label:e.querySelector("a.app-menu-text").textContent,link:e.querySelector("a.app-menu-text").getAttribute("href")})}),e.push(a)}),e}function moveUp(e){let t=e.closest(".sortable-submenu-item")||e.closest(".sortable-menu-item"),a=t.previousElementSibling;a&&t.parentNode.insertBefore(t,a)}function moveDown(e){let t=e.closest(".sortable-submenu-item")||e.closest(".sortable-menu-item"),a=t.nextElementSibling;a&&t.parentNode.insertBefore(a,t)}function reloadTranslate(e){"module"==e?translateModule():"entity"==e&&translateEntity()}function translateEntity(e){if(""!=(entityName=currentEntity2Translated)){let t=$(".target-language").val(),a=$(".filter-translate").val();increaseAjaxPending(),$.ajax({method:"POST",url:"lib.ajax/entity-translate.php",dataType:"json",data:{userAction:"get",entityName:entityName,targetLanguage:t,filter:a},success:function(e){decreaseAjaxPending();let t=[],a=[],n=[];for(let i in e)t.push(e[i].original),a.push(e[i].translated),n.push(e[i].propertyName);transEd1.getDoc().setValue(t.join("\r\n")),transEd2.getDoc().setValue(a.join("\r\n")),$(".entity-property-name").val(n.join("|")),$(".entity-name").val(entityName),focused={},transEd1.removeLineClass(lastLine1,"background","highlight-line"),transEd2.removeLineClass(lastLine1,"background","highlight-line"),lastLine1=-1}})}void 0!==e&&e()}function translateModule(){let e=$(".target-language").val(),t=$(".filter-translate").val(),a=[];$(".module-for-translate").each(function(e){$(this)[0].checked&&a.push($(this).val())}),increaseAjaxPending(),$.ajax({method:"POST",url:"lib.ajax/module-translate.php",dataType:"json",data:{userAction:"get",modules:a,translated:null,propertyNames:null,targetLanguage:e,filter:t},success:function(e){decreaseAjaxPending();let t=[],a=[],n=[];for(let i in e)t.push(e[i].original),a.push(e[i].translated),n.push(e[i].propertyName);transEd3.getDoc().setValue(t.join("\r\n")),transEd4.getDoc().setValue(a.join("\r\n")),$(".module-property-name").val(n.join("|")),focused={},transEd3.removeLineClass(lastLine2,"background","highlight-line"),transEd4.removeLineClass(lastLine2,"background","highlight-line"),lastLine2=-1}})}function upperCamelize(e){return e.replaceAll("_"," ").capitalize().prettify().replaceAll(" ","").trim()}function hasKey(e,t){let a=e.length,n;for(n=0;n<a;n++)if(e[n].value==t)return!0;return!1}function loadState(e,t,a){let n;for(n in a.find("tbody tr").each(function(t,n){let i=$(this).find('input[type="hidden"][name="field"]').val();hasKey(e,i)&&$(a).find('input[name$="'+i+'"]').each(function(e,t){$(this)[0].checked=!1})}),e){let i=$(a).find(":input[name="+e[n].name+"]");if(i.length){let l=e[n].value,o=e[n].name,r=i.prop("tagName").toString().toLowerCase(),c=i.attr("type");"radio"==c?$(a).find('[name="'+o+'"][value="'+l+'"]')[0].checked=!0:"checkbox"==c&&null!=l&&0!=l&&"0"!=l?$(a).find('[name="'+o+'"]')[0].checked=!0:"select"==r&&i.val(e[n].value)}}}function fixPathForm(){let e=0;$("table.path-manager tbody tr").each(function(){let t=$(this);t.find('td:nth-child(1) input[type="text"]').attr("name","name["+e+"]"),t.find('td:nth-child(2) input[type="text"]').attr("name","path["+e+"]"),t.find('td:nth-child(3) input[type="checkbox"]').attr("name","checked["+e+"]"),e++})}function fixLanguageForm(){let e=0;$("table.language-manager tbody tr").each(function(){let t=$(this);t.find('td:nth-child(1) input[type="text"]').attr("name","language_name["+e+"]"),t.find('td:nth-child(2) input[type="text"]').attr("name","language_code["+e+"]"),t.find('td:nth-child(3) input[type="checkbox"]').attr("name","checked["+e+"]"),e++})}function addDiagramOption(e){return e.push("maximum_level="+$('[name="maximum_level"]').val()),e.push("maximum_column="+$('[name="maximum_column"]').val()),e.push("margin_x="+$('[name="margin_x"]').val()),e.push("margin_y="+$('[name="margin_y"]').val()),e.push("entity_margin_x="+$('[name="entity_margin_x"]').val()),e.push("entity_margin_y="+$('[name="entity_margin_y"]').val()),e.push("zoom="+$('[name="zoom"]').val()),e}function loadDiagramMultiple(){let e=[];e=addDiagramOption(e),$(".entity-container-relationship .entity-checkbox").each(function(t){$(this)[0].checked&&e.push("entity[]="+$(this).val())}),e.push("rnd="+new Date().getTime());let t=$("<img />"),a="lib.ajax/entity-relationship-diagram.php?"+e.join("&"),n="lib.ajax/entity-relationship-diagram-map.php?"+e.join("&");t.attr("src",a),$(".erd-image").empty().append(t),$('[name="erd-map"]').load(n,function(e){t.attr("usemap","#erd-map")})}function downloadSVG(){let e=document.querySelector(".erd-image img").getAttribute("src");window.open(e)}function downloadPNG(){let e=document.querySelector(".erd-image img"),t=e.getAttribute("src"),a=document.createElement("canvas"),n=a.getContext("2d");a.width=e.width,a.height=e.height;let i=new Image;i.onload=function(){n.drawImage(i,0,0),URL.revokeObjectURL(t);let e=a.toDataURL("image/png");window.open(e)},i.src=t}function onChangeMapKey(e){let t=e.val();"label"==t.toLowerCase()||"value"==t.toLowerCase()||"default"==t.toLowerCase()?e.hasClass("input-invalid-value")||(e.addClass("input-invalid-value"),setTimeout(function(){e.val("data-"+t.toLowerCase()),onChangeMapKey(e)},500)):e.hasClass("input-invalid-value")&&e.removeClass("input-invalid-value")}function showAlertUI(e,t){$("#alert-dialog .modal-title").text(e),$("#alert-dialog .modal-body").html(t),$("#alert-dialog").modal("show")}function closeAlertUI(){$("#alert-dialog").modal("hide")}function saveModule(){if(""!=currentModule){$("#button_save_module_file").attr("disabled","disabled");let e=cmEditorModule.getDoc().getValue();increaseAjaxPending(),$.ajax({type:"POST",url:"lib.ajax/module-update.php",data:{content:e,module:currentModule},dataType:"html",success:function(e){decreaseAjaxPending(),$("#button_save_module_file").removeAttr("disabled")}})}else showAlertUI("Alert","No file open")}function saveEntity(){if(""!=currentEntity){$("#button_save_entity_file").attr("disabled","disabled");let e=cmEditorFile.getDoc().getValue();increaseAjaxPending(),$.ajax({type:"POST",url:"lib.ajax/entity-update.php",dataType:"json",data:{content:e,entity:currentEntity},success:function(t){decreaseAjaxPending(),$("#button_save_entity_file").removeAttr("disabled"),updateEntityFile(function(){setEntityFile(e)}),updateEntityQuery(!0),updateEntityRelationshipDiagram(),removeHilightLineError(),addHilightLineError(t.error_line-1),t.success||(showAlertUI(t.title,t.message),setTimeout(function(){closeAlertUI()},5e3))}})}else showAlertUI("Alert","No file open")}function saveEntityAs(){if(""!=currentEntity){let e=cmEditorFile.getDoc().getValue();getUserInput("New Etity Name","Save Entity As",[{caption:"Yes",fn(){let t=$(".prompt-input").val();increaseAjaxPending(),$.ajax({type:"POST",url:"lib.ajax/entity-save-as.php",dataType:"json",data:{content:e,entity:currentEntity,newEntity:t},success:function(e){decreaseAjaxPending(),updateEntityFile(),updateEntityQuery(!0),updateEntityRelationshipDiagram(),removeHilightLineError(),addHilightLineError(e.error_line-1),e.success||(showAlertUI(e.title,e.message),setTimeout(function(){closeAlertUI()},5e3))}})},class:"btn-primary"},{caption:"No",fn(){},class:"btn-secondary"}],currentEntity)}else showAlertUI("Alert","No file open")}function addHilightLineError(e){-1!=e&&cmEditorFile.addLineClass(e,"background","highlight-line"),lastErrorLine=e}function removeHilightLineError(){-1!=lastErrorLine&&cmEditorFile.removeLineClass(lastErrorLine,"background","highlight-line")}function saveQuery(){let e=new Blob([cmEditorSQL.getDoc().getValue()],{type:"application/x-sql;charset=utf-8"}),t=new Date().getTime()+".sql",a=URL.createObjectURL(e),n=document.createElement("a");n.href=a,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(a)}function getEntitySelection(){let e=[];return $(".entity-checkbox").each(function(){$(this)[0].checked&&e.push($(this).val())}),e}function getEntityQuery(e,t){increaseAjaxPending(),$.ajax({type:"POST",url:"lib.ajax/entity-query.php",data:{entity:e,merged:t?1:0},dataType:"text",success:function(e){decreaseAjaxPending(),cmEditorSQL.getDoc().setValue(e),setTimeout(function(){cmEditorSQL.refresh()},1),$("#button_save_entity_query").removeAttr("disabled")}})}function getEntityFile(e,t){increaseAjaxPending(),$.ajax({type:"POST",url:"lib.ajax/entity-file.php",data:{entity:e},dataType:"text",success:function(a){decreaseAjaxPending(),cmEditorFile.getDoc().setValue(a),setTimeout(function(){cmEditorFile.refresh()},1),$("#button_save_entity_file").removeAttr("disabled"),currentEntity=e[0],t&&t()}})}function getModuleFile(e,t){increaseAjaxPending(),$.ajax({type:"GET",url:"lib.ajax/module-file.php",data:{module:e},dataType:"html",success:function(a){decreaseAjaxPending(),cmEditorModule.getDoc().setValue(a),setTimeout(function(){cmEditorModule.refresh()},1),$("#button_save_module_file").removeAttr("disabled"),currentModule=e,t&&t()}})}function updateEntityQuery(e){e=e||!1,increaseAjaxPending(),$.ajax({type:"GET",url:"lib.ajax/entity-list-with-checkbox.php",data:{autoload:e},dataType:"html",success:function(t){decreaseAjaxPending(),$(".entity-container-query .entity-list").empty().append(t);let a=getEntitySelection(),n=$(".entity-merge");n.length>0&&e&&getEntityQuery(a,n[0].checked)}})}function updateEntityRelationshipDiagram(){increaseAjaxPending(),$.ajax({type:"GET",url:"lib.ajax/entity-list-for-diagram.php",dataType:"html",success:function(e){decreaseAjaxPending(),$(".entity-container-relationship .entity-list").empty().append(e),updateErd()}})}function updateEntityFile(e){increaseAjaxPending(),$.ajax({type:"GET",url:"lib.ajax/entity-list.php",dataType:"html",success:function(t){decreaseAjaxPending(),$(".entity-container-file .entity-list").empty().append(t),$(".container-translate-entity .entity-list").empty().append(t),clearEntityFile(),"function"==typeof e&&e(),clearTtransEd3(),clearTtransEd4()}})}function updateModuleFile(){increaseAjaxPending(),$.ajax({type:"GET",url:"lib.ajax/module-list-file.php",dataType:"html",success:function(e){decreaseAjaxPending(),$(".module-container .module-list-file").empty().append(e),clearModuleFile()}}),increaseAjaxPending(),$.ajax({type:"GET",url:"lib.ajax/module-list-translate.php",dataType:"html",success:function(e){decreaseAjaxPending(),$(".container-translate-module .module-list-translate").empty().append(e),clearTtransEd1(),clearTtransEd2()}})}function saveReference(e,t,a){increaseAjaxPending(),$.ajax({type:"POST",url:"lib.ajax/reference-save.php",data:{fieldName:e,key:t,value:a},dataType:"json",success:function(e){decreaseAjaxPending()}})}function loadReference(e,t,a){increaseAjaxPending(),$.ajax({type:"GET",url:"lib.ajax/reference-load.php",data:{fieldName:e,key:t},dataType:"json",success:function(e){decreaseAjaxPending(),a(e)}})}function updateTableName(e,t,a,n,i){e=e.replaceAll("_","-"),t=t.replaceAll("_","-"),a=ucWord(a.replaceAll("_"," "));let l=upperCamelize(n),o=n+"_apv",r=n+"_trash";$(this).attr("data-value",n),$('[name="primary_key_master"]').val(i),$('[name="entity_master_name"]').val(l),$('[name="entity_approval_name"]').val(l+"Apv"),$('[name="entity_trash_name"]').val(l+"Trash"),$('[name="table_approval_name"]').val(o),$('[name="primary_key_approval"]').val(o+"_id"),$('[name="table_trash_name"]').val(r),$('[name="primary_key_trash"]').val(r+"_id"),$('[name="module_file"]').val(e),$('[name="module_code"]').val(t),$('[name="module_name"]').val(a)}function ucWord(e){return(e=e.toLowerCase()).replace(/(^([a-zA-Z\p{M}]))|([ -][a-zA-Z\p{M}])/g,function(e){return e.toUpperCase()})}function prepareReferenceData(e,t){let a=t.closest("tr");"select"==e?a.find(".reference_button_data").css("display","inline"):a.find(".reference_button_data").css("display","none")}function prepareReferenceFilter(e,t){let a=t.closest("tr");"select"==e?a.find(".reference_button_filter").css("display","inline"):a.find(".reference_button_filter").css("display","none")}function switchApplication(e){increaseAjaxPending(),$.ajax({type:"post",url:"lib.ajax/application-switch.php",dataType:"json",data:{currentApplication:e},success:function(e){decreaseAjaxPending(),window.location.reload()}})}function generateScript(e){let t=[];$(e).find("tr").each(function(e){let a=$(this).attr("data-field-name"),n=$(this).find("input.input-field-name").val(),i=$(this).find("input.include_insert")[0].checked,l=$(this).find("input.include_edit")[0].checked,o=$(this).find("input.include_detail")[0].checked,r=$(this).find("input.include_list")[0].checked,c=$(this).find("input.include_export")[0].checked,d=$(this).find("input.include_key")[0].checked,s=$(this).find("input.include_required")[0].checked,p=$(this).find("input.input-element-type:checked").val(),u=$(this).find("input.input-field-filter:checked").length>0?$(this).find("input.input-field-filter:checked").val():null,m=$(this).find("select.input-field-data-type").val(),f=$(this).find("select.input-data-filter").val(),h=parseJsonData($(this).find("input.reference-data").val()),y=parseJsonData($(this).find("input.reference-filter").val());t.push({fieldName:a,fieldLabel:n,includeInsert:i,includeEdit:l,includeDetail:o,includeList:r,includeExport:c,isKey:d,isInputRequired:s,elementType:p,filterElementType:u,dataType:m,inputFilter:f,referenceData:h,referenceFilter:y})});let a=$("#subquery")[0].checked&&!0,n=$("#with_approval")[0].checked&&!0,i=$("#with_trash")[0].checked&&!0,l=$("#manualsortorder")[0].checked&&!0,o=$("#export_to_excel")[0].checked&&!0,r=$("#export_to_csv")[0].checked&&!0,c=$("#activate_deactivate")[0].checked&&!0,d=$("#with_approval_note")[0].checked&&!0,s=$('[name="approval_position"]:checked').val(),p=$('[name="approval_by_other_user"]:checked').val(),u=$('[name="approval_type"]:checked').val(),m=$("#ajax_support")[0].checked&&!0,f={mainEntity:{entityName:$('[name="entity_master_name"]').val(),tableName:$('[name="source_table"]').val(),primaryKey:$('[name="primary_key_master"]').val()},approvalRequired:n,trashRequired:i};n&&(f.approvalEntity={entityName:$('[name="entity_approval_name"]').val(),tableName:$('[name="table_approval_name"]').val(),primaryKey:$('[name="primary_key_approval"]').val()}),i&&(f.trashEntity={entityName:$('[name="entity_trash_name"]').val(),tableName:$('[name="table_trash_name"]').val(),primaryKey:$('[name="primary_key_trash"]').val()});let h=getSpecificationModule(),y=getSortableModule(),g={entity:f,fields:t,specification:h,sortable:y,features:{subquery:a,activateDeactivate:c,sortOrder:l,exportToExcel:o,exportToCsv:r,approvalRequired:n,approvalNote:d,trashRequired:i,approvalType:u,approvalPosition:s,approvalByAnotherUser:p,ajaxSupport:m},moduleCode:$('[name="module_code"]').val(),moduleName:$('[name="module_name"]').val(),moduleFile:$('[name="module_file"]').val(),moduleAdMenu:$('[name="module_as_menu"]').val(),moduleMenu:$('[name="module_menu"]').val(),target:$("#current_module_location").val(),updateEntity:$('[name="update_entity"]')[0].checked};generateAllCode(g)}function getSpecificationModule(){let e=[];return $(".table-data-filter").find("tbody").find("tr").each(function(t){let a=$(this);if(a.find(".data-filter-column-name").length&&a.find(".data-filter-column-value").length){let n=a.find(".data-filter-column-name").val()||"",i=a.find(".data-filter-column-value").val()||"",l=a.find(".data-filter-column-comparison").val()||"";""==l&&(l="equals"),n=n?n.trim():"",i=i?i.trim():"",n.length>0&&e.push({column:n,value:i,comparison:l})}}),e}function getSortableModule(){let e=[];return $(".table-data-order").find("tbody").find("tr").each(function(t){let a=$(this);if(a.find(".data-order-column-name").length&&a.find(".data-order-order-type").length){let n=a.find(".data-order-column-name").val(),i=a.find(".data-order-order-type").val();n=n?n.trim():"",i=i?i.trim():"",n.length>0&&e.push({sortBy:n,sortType:i})}}),e}function parseJsonData(e){if("string"!=typeof e)return null;try{let t=JSON.parse(e);if("object"==typeof t)return t}catch(a){}return null}function parseJsonData(e){if("string"!=typeof e)return null;try{let t=JSON.parse(e);if("object"==typeof t)return t}catch(a){}return null}function generateAllCode(e){increaseAjaxPending(),$.ajax({type:"post",url:"lib.ajax/script-generator.php",dataType:"json",data:e,success:function(e){decreaseAjaxPending(),updateEntityFile(),updateEntityQuery(!0),updateEntityRelationshipDiagram(),e.success&&(onModuleCreated(),showToast(e.title,e.message),setTimeout(function(){closeAlertUI()},2e3))}})}function showToast(e,t){let a="toast-"+new Date().getTime(),n=`
    <div class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-autohide="true" data-delay="3000" id="${a}">
      <div class="toast-header">
        <strong class="mr-auto">${e}&nbsp;&nbsp;</strong>
        <small>just now</small>
        <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="toast-body">
        ${t}
      </div>
    </div>
  `;$(".toast-container").prepend(n);let i=$("#"+a)[0];new bootstrap.Toast(i).show(),$(i).on("hidden.bs.toast",function(){$(i).remove()})}function updateCurrentApplivation(e){increaseAjaxPending(),$.ajax({type:"POST",url:"lib.ajax/application-update.php",data:e,success:function(e){for(let t in decreaseAjaxPending(),$('select[name="source_table"]').empty(),e)$('select[name="source_table"]')[0].append(new Option(e[t].table_name,e[t].table_name));let a=$('select[name="source_table"]').attr("data-value");null!=a&&""!=a&&$('select[name="source_table"]').val(a),loadAllResource()}})}function loadTable(){increaseAjaxPending(),$.ajax({type:"post",url:"lib.ajax/database-table-list.php",dataType:"json",success:function(e){for(let t in decreaseAjaxPending(),$('select[name="source_table"]').empty(),$('select[name="source_table"]')[0].append(new Option("- Select Table -","")),e)e.hasOwnProperty(t)&&$('select[name="source_table"]')[0].append(new Option(e[t].table_name,e[t].table_name));$('select[name="source_table"]').find("option").each(function(t){let a=$(this).attr("value")||"";""!=a&&void 0!==e[a]&&void 0!==e[a].primary_key&&void 0!==e[a].primary_key[0]&&$(this).attr("data-primary-key",e[a].primary_key[0])});let a=$('select[name="source_table"]').attr("data-value");null!=a&&""!=a&&$('select[name="source_table"]').val(a)}})}function loadMenu(){increaseAjaxPending(),$.ajax({type:"get",url:"lib.ajax/application-menu-json.php",dataType:"json",success:function(e){for(let t in decreaseAjaxPending(),$('select[name="module_menu"]').empty(),e)e.hasOwnProperty(t)&&$('select[name="module_menu"]')[0].append(new Option(e[t].label,e[t].label))}})}function loadColumn(e,t){increaseAjaxPending(),$.ajax({type:"post",url:"lib.ajax/database-column-list.php",data:{table_name:e},dataType:"json",success:function(e){decreaseAjaxPending(),$(t).empty();let a=e.fields,n,i,l,o,r=e.skipped_insert_edit;for(n in a)o=generateRow(i=a[n].column_name,l={data_type:a[n].data_type,column_type:a[n].column_type},r),$(t).append(o);if(void 0!==e.primary_keys&&e.primary_keys.length)for(let c in e.primary_keys){let d=e.primary_keys[c];$('[data-field-name="'+d+'"]').find('[name="include_key_'+d+'"]')[0].checked=!0}$('[name="module_load_previous"]')[0].checked?loadSavedModuleData($("#module_file").val(),$("#current_module_location").val(),function(){$(".define-wrapper").css("display","block"),$("#define-column-tab").click()}):($(".define-wrapper").css("display","block"),$("#define-column-tab").click())}})}function restoreForm(e){if(void 0!==e.fields){for(let t in e.fields)if(e.fields.hasOwnProperty(t)){let a=$('.main-table tbody tr[data-field-name="'+e.fields[t].fieldName+'"]');a.length>0&&(a.appendTo(a.parent()),a.find(".include_insert")[0].checked=!0===e.fields[t].includeInsert||"true"==e.fields[t].includeInsert,a.find(".include_edit")[0].checked=!0===e.fields[t].includeEdit||"true"==e.fields[t].includeEdit,a.find(".include_detail")[0].checked=!0===e.fields[t].includeDetail||"true"==e.fields[t].includeDetail,a.find(".include_list")[0].checked=!0===e.fields[t].includeList||"true"==e.fields[t].includeList,a.find(".include_export")[0].checked=!0===e.fields[t].includeExport||"true"==e.fields[t].includeExport,a.find(".include_key")[0].checked=!0===e.fields[t].isKey||"true"==e.fields[t].isKey,a.find(".include_required")[0].checked=!0===e.fields[t].isInputRequired||"true"==e.fields[t].isInputRequired,a.find('.input-element-type[value="'+e.fields[t].elementType+'"]')[0].checked=!0,"select"==e.fields[t].elementType&&(a.find(".reference-data").val(JSON.stringify(e.fields[t].referenceData)),a.find(".reference_button_data").css("display","inline")),"select"==e.fields[t].filterElementType&&(a.find(".reference-filter").val(JSON.stringify(e.fields[t].referenceFilter)),a.find(".reference_button_filter").css("display","inline"),a.find('.input-field-filter[value="select"]')[0].checked=!0),"text"==e.fields[t].filterElementType&&(a.find('.input-field-filter[value="text"]')[0].checked=!0),a.find(".input-field-data-type").val(e.fields[t].dataType),a.find(".input-data-filter").val(e.fields[t].inputFilter))}}let n,i;for(n=0,i="#modal-filter-data tbody tr:last-child";$("#modal-filter-data tbody tr").length>1;)$(i).remove();if($(i).find(".data-filter-column-name").val(""),$(i).find(".data-filter-column-value").val(""),void 0===e.specification||0==e.specification.length)$(i).find(".data-filter-column-name").val(""),$(i).find(".data-filter-column-comparison").val(""),$(i).find(".data-filter-column-value").val("");else for(let l in e.specification)if(e.specification.hasOwnProperty(l)){if(n>0){let o=$(i)[0].outerHTML;$(i).parent().append(o)}let r=e.specification[l].column||"",c=e.specification[l].comparison||"",d=e.specification[l].value||"";$(i).find(".data-filter-column-name").val(r),$(i).find(".data-filter-column-comparison").val(c),$(i).find(".data-filter-column-value").val(d),n++}for(n=0,i="#modal-order-data tbody tr:last-child";$("#modal-order-data tbody tr").length>1;)$(i).remove();if($(i).find(".data-filter-column-name").val(""),$(i).find(".data-filter-column-value").val(""),void 0===e.sortable||0==e.sortable.length)$(i).find(".data-order-column-name").val(""),$(i).find(".data-order-order-type").val("PicoSort::ORDER_TYPE_ASC");else for(let s in e.sortable)if(e.sortable.hasOwnProperty(s)){if(n>0){let p=$(i)[0].outerHTML;$(i).parent().append(p)}$(i).find(".data-order-column-name").val(e.sortable[s].sortBy),$(i).find(".data-order-order-type").val(e.sortable[s].sortType),n++}void 0!==e.features&&($('#modal-module-features [name="subquery"]').length&&($('#modal-module-features [name="subquery"]')[0].checked=!0===e.features.subquery||"true"==e.features.subquery),$('#modal-module-features [name="activate_deactivate"]').length&&($('#modal-module-features [name="activate_deactivate"]')[0].checked=!0===e.features.activateDeactivate||"true"==e.features.activateDeactivate),$('#modal-module-features [name="manualsortorder"]').length&&($('#modal-module-features [name="manualsortorder"]')[0].checked=!0===e.features.sortOrder||"true"==e.features.sortOrder),$('#modal-module-features [name="export_to_excel"]').length&&($('#modal-module-features [name="export_to_excel"]')[0].checked=!0===e.features.exportToExcel||"true"==e.features.exportToExcel),$('#modal-module-features [name="export_to_csv"]').length&&($('#modal-module-features [name="export_to_csv"]')[0].checked=!0===e.features.exportToCsv||"true"==e.features.exportToCsv),$('#modal-module-features [name="with_approval"]').length&&($('#modal-module-features [name="with_approval"]')[0].checked=!0===e.features.approvalRequired||"true"==e.features.approvalRequired),$('#modal-module-features [name="with_approval_note"]').length&&($('#modal-module-features [name="with_approval_note"]')[0].checked=!0===e.features.approvalNote||"true"==e.features.approvalNote),$('#modal-module-features [name="with_trash"]').length&&($('#modal-module-features [name="with_trash"]')[0].checked=!0===e.features.trashRequired||"true"==e.features.trashRequired),$('#modal-module-features [name="approval_type"][value="'+e.features.approvalType+'"]').length&&($('#modal-module-features [name="approval_type"][value="'+e.features.approvalType+'"]')[0].checked=!0),$('#modal-module-features [name="approval_position"][value="'+e.features.approvalPosition+'"]').length&&($('#modal-module-features [name="approval_position"][value="'+e.features.approvalPosition+'"]')[0].checked=!0),$('#modal-module-features [name="ajax_support"]').length&&($('#modal-module-features [name="ajax_support"]')[0].checked=!0===e.features.ajaxSupport||"true"==e.features.ajaxSupport))}function loadSavedModuleData(e,t,a){increaseAjaxPending(),$.ajax({type:"GET",url:"lib.ajax/module-data.php",data:{moduleFile:e,target:t},dataType:"json",success:function(e){decreaseAjaxPending(),restoreForm(e),a()},error:function(e){a()}})}function generateSelectFilter(e,t){let a;(t=t||{}).column_type=t.column_type||"text";let n=t.column_type,i={FILTER_SANITIZE_BOOL:["tinyint(1)","bool","boolean",],FILTER_SANITIZE_NUMBER_INT:["bit","varbit","smallint","int","integer","bigint","smallserial","serial","bigserial","tinyint",],FILTER_SANITIZE_NUMBER_FLOAT:["numeric","double","real","money"],FILTER_SANITIZE_SPECIAL_CHARS:["char","character","varchar","character varying","text","date","timestamp","time",]};a=$('<select class="form-control input-data-filter" name="filter_type_'+e+'" id="filter_type_'+e+'">\r\n<option value="FILTER_DEFAULT">DEFAULT</option>\r\n<option value="FILTER_SANITIZE_BOOL">BOOL</option>\r\n<option value="FILTER_SANITIZE_NUMBER_INT">NUMBER_INT</option>\r\n<option value="FILTER_SANITIZE_NUMBER_UINT">NUMBER_UINT</option>\r\n<option value="FILTER_SANITIZE_NUMBER_OCTAL">NUMBER_OCTAL</option>\r\n<option value="FILTER_SANITIZE_NUMBER_HEXADECIMAL">NUMBER_HEXADECIMAL</option>\r\n<option value="FILTER_SANITIZE_NUMBER_FLOAT">NUMBER_FLOAT</option>\r\n<option value="FILTER_SANITIZE_STRING">STRING</option>\r\n<option value="FILTER_SANITIZE_STRING_INLINE">STRING_INLINE</option>\r\n<option value="FILTER_SANITIZE_NO_DOUBLE_SPACE">NO_DOUBLE_SPACE</option>\r\n<option value="FILTER_SANITIZE_STRIPPED">STRIPPED</option>\r\n<option value="FILTER_SANITIZE_SPECIAL_CHARS">SPECIAL_CHARS</option>\r\n<option value="FILTER_SANITIZE_ALPHA">ALPHA</option>\r\n<option value="FILTER_SANITIZE_ALPHANUMERIC">ALPHANUMERIC</option>\r\n<option value="FILTER_SANITIZE_ALPHANUMERICPUNC">ALPHANUMERICPUNC</option>\r\n<option value="FILTER_SANITIZE_STRING_BASE64">STRING_BASE64</option>\r\n<option value="FILTER_SANITIZE_EMAIL">EMAIL</option>\r\n<option value="FILTER_SANITIZE_URL">URL</option>\r\n<option value="FILTER_SANITIZE_IP">IP</option>\r\n<option value="FILTER_SANITIZE_ENCODED">ENCODED</option>\r\n<option value="FILTER_SANITIZE_COLOR">COLOR</option>\r\n<option value="FILTER_SANITIZE_MAGIC_QUOTES">MAGIC_QUOTES</option>\r\n<option value="FILTER_SANITIZE_PASSWORD">PASSWORD</option>\r\n</select>\r\n');let l,o,r,c="FILTER_SANITIZE_SPECIAL_CHARS",d=!1;for(l in i){for(r in o=i[l])if(-1!=n.toLowerCase().indexOf(o[r].toLowerCase())){c=l,d=!0;break}if(d)break}return a.find("option").each(function(e,t){$(this).removeAttr("selected")}),a.find('option[value="'+c+'"]').attr("selected","selected"),a[0].outerHTML}function generateSelectType(e,t){let a;(t=t||{}).data_type=t.data_type||"text";let n=t.data_type,i={int:["bit","varbit","smallint","int","integer","bigint","smallserial","serial","bigserial","bool","boolean",],float:["numeric","double","real","money"],text:["char","character","varchar","character varying","text"],"datetime-local":["datetime","timestamp"],color:["char","character","varchar","character varying","text"],month:["char","character","varchar","character varying","text"],week:["char","character","varchar","character varying","text"],date:["date"],time:["time"]};a=$('<select class="form-control input-field-data-type" name="data_type_'+e+'" id="data_type_'+e+'">\r\n<option value="text" title="&lt;input type=&quot;text&quot;&gt;">text</option>\r\n<option value="email" title="&lt;input type=&quot;email&quot;&gt;">email</option>\r\n<option value="url" title="&lt;input type=&quot;url&quot;&gt;">url</option>\r\n<option value="tel" title="&lt;input type=&quot;tel&quot;&gt;">tel</option>\r\n<option value="password" title="&lt;input type=&quot;password&quot;&gt;">password</option>\r\n<option value="int" title="&lt;input type=&quot;number&quot;&gt;">int</option>\r\n<option value="float" title="&lt;input type=&quot;number&quot; step=&quot;any&quot;&gt;">float</option>\r\n<option value="date" title="&lt;input type=&quot;text&date;&gt;">date</option>\r\n<option value="time" title="&lt;input type=&quot;time&quot;&gt;">time</option>\r\n<option value="datetime-local" title="&lt;input type=&quot;datetime-local&quot;&gt;">datetime</option>\r\n<option value="week" title="&lt;input type=&quot;month&quot;&gt;">month</option>\r\n<option value="week" title="&lt;input type=&quot;week&quot;&gt;">week</option>\r\n<option value="color" title="&lt;input type=&quot;color&quot;&gt;">color</option>\r\n</select>\r\n');let l,o,r,c="text",d=!1;for(l in i){for(r in o=i[l])if(-1!=n.toLowerCase().indexOf(o[r].toLowerCase())){c=l,d=!0;break}if(d)break}return a.find("option").each(function(e,t){$(this).removeAttr("selected")}),a.find('option[value="'+c+'"]').attr("selected","selected"),a[0].outerHTML}function arrayUnique(e){let t,a=[];for(t=0;t<e.length;t++)-1==a.indexOf(e[t])&&a.push(e[t]);return a}function isKeyWord(e){e=e.toString();let t,a=keyWords.split(",");for(t in a)if(e.equalIgnoreCase(a[t]))return!0;return!1}function generateRow(e,t,a){let n=isKeyWord(e),i=[],l="";i.push("row-column"),n&&i.push("reserved"),l=' class="'+i.join(" ")+'"';let o="",r="",c="",d="";return -1!=$.inArray(e,a)?(o='  <td align="center"><input type="checkbox" class="include_insert" name="include_insert_'+e+'" value="0" disabled="disabled"></td>\r\n',r='  <td align="center"><input type="checkbox" class="include_edit" name="include_edit_'+e+'" value="0" disabled="disabled"></td>\r\n',c='  <td align="center"><input type="checkbox" class="include_list" name="include_list_'+e+'" value="1"></td>\r\n'):(o='  <td align="center"><input type="checkbox" class="include_insert" name="include_insert_'+e+'" value="1" checked="checked"></td>\r\n',r='  <td align="center"><input type="checkbox" class="include_edit" name="include_edit_'+e+'" value="1" checked="checked"></td>\r\n',c='  <td align="center"><input type="checkbox" class="include_list" name="include_list_'+e+'" value="1" checked="checked"></td>\r\n'),d='  <td align="center"><input type="checkbox" class="include_export" name="include_export_'+e+'" value="1" checked="checked"></td>\r\n','<tr data-field-name="'+e+'" '+l+'>\r\n  <td class="data-sort data-sort-body data-sort-handler"></td>\r\n  <td class="field-name">'+e+'<input type="hidden" name="field" value="'+e+'"></td>\r\n  <td><input type="hidden" class="input-field-name" name="caption_'+e+'" value="'+e.replaceAll("_"," ").capitalize().prettify().trim()+'" autocomplete="off" spellcheck="false">'+e.replaceAll("_"," ").capitalize().prettify().trim()+"</td>\r\n"+o+r+'  <td align="center"><input type="checkbox" class="include_detail" name="include_detail_'+e+'" value="1" checked="checked"></td>\r\n'+c+d+'  <td align="center"><input type="checkbox" class="include_key" name="include_key_'+e+'" value="1"></td>\r\n  <td align="center"><input type="checkbox" class="include_required" name="include_required_'+e+'" value="1"></td>\r\n  <td align="center"><input type="radio" class="input-element-type" name="element_type_'+e+'" value="text" checked="checked"></td>\r\n  <td align="center"><input type="radio" class="input-element-type" name="element_type_'+e+'" value="textarea"></td>\r\n  <td align="center"><input type="radio" class="input-element-type" name="element_type_'+e+'" value="checkbox"></td>\r\n  <td align="center"><input type="radio" class="input-element-type" name="element_type_'+e+'" value="select"></td>\r\n  <td align="center"><input type="hidden" class="reference-data" name="reference_data_'+e+'" value="{}"><button type="button" class="btn btn-sm btn-primary reference-button reference_button_data">Source</button></td>\r\n  <td align="center"><input type="checkbox" name="list_filter_'+e+'" value="text" class="input-field-filter"></td>\r\n  <td align="center"><input type="checkbox" name="list_filter_'+e+'" value="select" class="input-field-filter"></td>\r\n  <td align="center"><input type="hidden" class="reference-filter" name="reference_filter_'+e+'" value="{}"><button type="button" class="btn btn-sm btn-primary reference-button reference_button_filter">Source</button></td>\r\n  <td>\r\n'+generateSelectType(e,t)+"  </td>\r\n  <td>\r\n"+generateSelectFilter(e,t)+"  </td>\r\n</tr>\r\n"}function serializeForm(){let e=null;$(".reference_type").each(function(t){$(this)[0].checked&&(e=$(this).val())});let t=$(".multiple-selection").val(),a=getEntityData(),n=getMapData();return{type:e,entity:a,map:n,yesno:null,truefalse:null,onezero:null,multipleSelection:t}}function deserializeForm(e){$("#modal-create-reference-data").find(".modal-body").empty(),$("#modal-create-reference-data").find(".modal-body").append(getReferenceResource()),selectReferenceType(e),setEntityData(e),setMapData(e)}function addRow(e){let t=e.find("tbody").find("tr:last-child").prop("outerHTML");e.find("tbody").append(t)}function addColumn(e){let t=e.find("thead").find("tr").find("td").length-parseInt(e.attr("data-offset"))-2;e.find("thead").find("tr").find("td:nth("+t+")").after('<td><input class="form-control map-key" type="text" value="" placeholder="Additional attribute name"></td>'),e.find("tbody").find("tr").each(function(e){$(this).find("td:nth("+t+")").after('<td><input class="form-control map-value" type="text" value="" placeholder="Additional attribute value"></td>')}),e.find("tfoot").find("tr").find("td").attr("colspan",e.find("thead").find("tr").find("td").length)}function removeLastColumn(e){let t=e.find("thead").find("tr").find("td").length,a=parseInt(e.attr("data-offset")),n=t-a-2;t>a+3&&(e.find("thead").find("tr").find("td:nth("+n+")").remove(),e.find("tbody").find("tr").each(function(e){$(this).find("td:nth("+n+")").remove()}),e.find("tfoot").find("tr").find("td").attr("colspan",e.find("thead").find("tr").find("td").length))}function selectReferenceType(e){let t=e.type?e.type:"entity",a=$("#modal-create-reference-data .modal-dialog");"entity"==t||"map"==t?(a.addClass("modal-lg"),a.hasClass("modal-md")&&a.removeClass("modal-md")):(a.addClass("modal-md"),a.hasClass("modal-lg")&&a.removeClass("modal-lg")),$('.reference_type[value="'+t+'"]').length>0&&($('.reference_type[value="'+t+'"]')[0].checked=!0),$(".reference-section").css({display:"none"}),"entity"==t?$(".entity-section").css({display:"block"}):"map"==t&&$(".map-section").css({display:"block"})}function setEntityData(e){e.entity=e&&e.entity?e.entity:{};let t=e.entity;t.entityName=t.entityName?t.entityName:"",t.tableName=t.tableName?t.tableName:"",t.primaryKey=t.primaryKey?t.primaryKey:"",t.value=t.value?t.value:"",t.objectName=t.objectName?t.objectName:"",t.propertyName=t.propertyName?t.propertyName:"",t.textNodeFormat=t.textNodeFormat?t.textNodeFormat:"",t.indent=t.indent?t.indent:"";let a='[data-name="entity"]';$(a).find(".rd-entity-name").val(t.entityName),$(a).find(".rd-table-name").val(t.tableName),$(a).find(".rd-primary-key").val(t.primaryKey),$(a).find(".rd-value-column").val(t.value),$(a).find(".rd-reference-object-name").val(t.objectName),$(a).find(".rd-reference-property-name").val(t.propertyName),$(a).find(".rd-option-text-node-format").val(t.textNodeFormat),$(a).find(".rd-option-indent").val(t.indent);let n=e.multipleSelection||"0";"1"!=n&&(n="0"),$(".multiple-selection").val(n),setSpecificationData(e),setSortableData(e),setAdditionalOutputData(e)}function getEntityData(){let e='[data-name="entity"]';return{entityName:$(e).find(".rd-entity-name").val().trim(),tableName:$(e).find(".rd-table-name").val().trim(),primaryKey:$(e).find(".rd-primary-key").val().trim(),value:$(e).find(".rd-value-column").val().trim(),objectName:$(e).find(".rd-reference-object-name").val().trim(),propertyName:$(e).find(".rd-reference-property-name").val().trim(),textNodeFormat:$(e).find(".rd-option-text-node-format").val(),indent:$(e).find(".rd-option-indent").val(),specification:getSpecificationData(),sortable:getSortableData(),additionalOutput:getAdditionalOutputData()}}function setSpecificationData(e){let t=$('[data-name="specification"]'),a=e.entity.specification;if(void 0!==a&&null!=a&&a.length>0)for(let n in a){n>0&&addRow(t);let i=t.find("tr:last-child"),l=a[n],o=l.comparison||"",r=l.column||"",c=l.value||"";""==o&&(o="equals"),i.find(".rd-column-name").val(r),i.find(".rd-comparison").val(o),i.find(".rd-value").val(c)}}function getSpecificationData(){let e=[];return $('[data-name="specification"]').find("tbody").find("tr").each(function(t){let a=$(this),n=a.find(".rd-column-name").val()||"",i=a.find(".rd-value").val()||"",l=a.find(".rd-comparison").val()||"";""==l&&(l="equals"),n.length>0&&e.push({column:n.trim(),value:fixValue(i.trim()),comparison:l.trim()})}),e}function setSortableData(e){let t=$('[data-name="sortable"]'),a=e.entity.sortable;if(void 0!==a&&null!=a&&a.length>0)for(let n in a){n>0&&addRow(t);let i=t.find("tr:last-child"),l=a[n];i.find(".rd-column-name").val(l.sortBy),i.find(".rd-order-type").val(l.sortType)}}function getSortableData(){let e=[];return $('[data-name="sortable"]').find("tbody").find("tr").each(function(t){let a=$(this),n=a.find(".rd-column-name").val().trim(),i=a.find(".rd-order-type").val().trim();n.length>0&&e.push({sortBy:n,sortType:i})}),e}function setAdditionalOutputData(e){let t=$('[data-name="additional-output"]'),a=e.entity.additionalOutput;if(void 0!==a&&null!=a&&a.length>0)for(let n in a){n>0&&addRow(t);let i=t.find("tr:last-child"),l=a[n];i.find(".rd-column-name").val(l.column)}}function getAdditionalOutputData(){let e=[];return $('[data-name="additional-output"]').find("tbody").find("tr").each(function(t){let a=$(this).find(".rd-column-name").val().trim();a.length>0&&e.push({column:a})}),e}function setMapData(e){let t='[data-name="map"]',a=$(t),n=[];e.map=e.map?e.map:[];let i=e.map,l=[];if(i.length>0){let o=i[0],r=0;for(let c in o)o.hasOwnProperty(c)&&(++r>4&&addColumn(a),"value"!=c&&"label"!=c&&"default"!=c&&(n.push(c),l[0]=c));for(let d in n){let s=parseInt(d)+1;a.find("thead").find("tr").find(".map-key:nth-child("+s+")").val(n[d])}for(let p in $(t).find("thead").find("tr").find(".map-key").length>0&&$(t).find("thead").find("tr").find(".map-key").each(function(e){n.push($(this).val().trim())}),i){p>0&&addRow(a);let u=a.find("tr:last-child"),m=i[p];for(let f in u.find(".rd-value").val(m.value),u.find(".rd-label").val(m.label),i[p].default&&(u.find(".rd-selected")[0].checked=!0),n){let h=parseInt(f)+1,y=i[p][n[f]];u.find(".map-value:nth-child("+h+")").val(y)}}}}function getMapData(){let e=[],t='[data-name="map"]',a=[];return $(t).find("thead").find("tr").find(".map-key").length>0&&$(t).find("thead").find("tr").find(".map-key").each(function(e){a.push($(this).val().trim())}),$(t).find("tbody").find("tr").each(function(t){let n=$(this),i={value:n.find(".rd-value").val().trim(),label:n.find(".rd-label").val().trim(),default:n.find(".rd-selected")[0].checked};if(a.length>0){let l=0;n.find(".map-value").each(function(e){let t=$(this).val();a[l].length>0&&(i[a[l]]=t),l++})}e.push(i)}),e}function fixValue(e){return"true"==e||"false"!=e&&("null"==e?null:isNumeric(e)?parseNumber(e):e)}function parseNumber(e){return -1!==e.indexOf(".")?parseFloat(e):parseInt(e)}function isNumeric(e){return"string"==typeof e&&!isNaN(e)&&!isNaN(parseFloat(e))}function setLanguage(e){$("select.target-language").each(function(){let t=$(this);for(let a in t.empty(),e)t[0].options[t[0].options.length]=new Option(e[a].name+" - "+e[a].code,e[a].code)})}function getReferenceResource(){return`
<form action="">
    <div class="reference-selector">
        <label for="reference_type_entity"><input type="radio" class="reference_type" name="reference_type"
                id="reference_type_entity" value="entity" checked> Entity</label>
        <label for="reference_type_map"><input type="radio" class="reference_type" name="reference_type"
                id="reference_type_map" value="map"> Map</label>
        <label for="reference_type_yesno"><input type="radio" class="reference_type" name="reference_type"
                id="reference_type_yesno" value="yesno"> Yes/No</label>
        <label for="reference_type_truefalse"><input type="radio" class="reference_type" name="reference_type"
                id="reference_type_truefalse" value="truefalse"> True/False</label>
        <label for="reference_type_onezero"><input type="radio" class="reference_type" name="reference_type"
                id="reference_type_onezero" value="onezero"> 1/0</label>
    </div>
    <div class="reference-container">
        <div class="reference-section entity-section">
            <h4>Entity</h4>
            <div class="table-reference-container">
              <table data-name="entity" class="modal-table" width="100%" border="0" cellspacing="0" cellpadding="0">
                  <tbody>
                      <tr>
                          <td>Entity Name</td>
                          <td><input class="form-control rd-entity-name" type="text"></td>
                      </tr>
                      <tr>
                          <td>Table Name</td>
                          <td><input class="form-control rd-table-name" type="text"></td>
                      </tr>
                      <tr>
                          <td>Primary Key</td>
                          <td><input class="form-control rd-primary-key" type="text"></td>
                      </tr>
                      <tr>
                          <td>Value Column</td>
                          <td><input class="form-control rd-value-column" type="text"></td>
                      </tr>
                      <tr class="display-reference">
                          <td>Reference Object Name</td>
                          <td><input class="form-control rd-reference-object-name" type="text"></td>
                      </tr>
                      <tr class="display-reference">
                          <td>Reference Property Name</td>
                          <td><input class="form-control rd-reference-property-name" type="text"></td>
                      </tr>
                      <tr class="entity-generator">
                          <td></td>
                          <td>
                            <button type="button" class="btn btn-primary add_subfix">Add Entity Subfix</button>
                            <button type="button" class="btn btn-success generate_entity">Generate Entity</button>
                          </td>
                      </tr>
                  </tbody>
              </table>
            </div>
            <h4>Option Node</h4>
            <div class="table-reference-container">
              <table data-name="entity" class="modal-table" width="100%" border="0" cellspacing="0" cellpadding="0">
                  <tbody>
                      <tr>
                          <td>Format and Pamareters</td>
                          <td><input class="form-control rd-option-text-node-format" type="text"></td>
                      </tr>
                      <tr>
                          <td>Indent</td>
                          <td><input class="form-control rd-option-indent" type="number" step="1" min="0"></td>
                      </tr>
                  </tbody>
              </table>
            </div>
            <h4>Specfification</h4>
            <p>Just leave it blank if it doesn't exist. Click Remove button to remove value.</p>
            <div class="table-reference-container">
              <table data-name="specification" class="table table-reference" data-empty-on-remove="true">
                  <thead>
                      <tr>
                          <td width="40%">Column Name</td>
                          <td width="8%">Comp</td>
                          <td>Value</td>
                          <td width="42">Rem</td>
                          <td colspan="2">Move</td>
                      </tr>
                  </thead>
                  <tbody>
                      <tr>
                          <td><input class="form-control rd-column-name" type="text" value=""></td>
                          <td>
                            <select class="form-control rd-comparison">
                              <option value="equals">=</option>
                              <option value="notEquals">!=</option>
                              <option value="greaterThan">&gt;</option>
                              <option value="greaterThanOrEquals">&gt;=</option>
                              <option value="lessThan">&lt;</option>
                              <option value="lessThanOrEquals">&lt;=</option>
                            </select>
                          </td>
                          <td><input class="form-control rd-value" type="text" value=""></td>
                          <td><button type="button" class="btn btn-danger btn-remove-row"><i class="fa-regular fa-trash-can"></i></button></td>
                          <td width="30"><button type="button" class="btn btn-primary btn-move-up"><i class="fa-solid fa-arrow-up"></i></button></td>
                          <td width="30"><button type="button" class="btn btn-primary btn-move-down"><i class="fa-solid fa-arrow-down"></i></button></td>
                      </tr>
                  </tbody>
                  <tfoot>
                      <tr>
                          <td colspan="5">
                              <button type="button" class="btn btn-primary btn-add-row">Add Row</button>
                          </td>
                      </tr>
                  </tfoot>
              </table>
            </div>
            <h4>Sortable</h4>
            <p>Use at least one column to sort.</p>
            <div class="table-reference-container">
              <table data-name="sortable" class="table table-reference">
                  <thead>
                      <tr>
                          <td width="65%">Column</td>
                          <td>Value</td>
                          <td width="42">Rem</td>
                          <td colspan="2">Move</td>
                      </tr>
                  </thead>
                  <tbody>
                      <tr>
                          <td><input class="form-control rd-column-name" type="text" value=""></td>
                          <td><select class="form-control rd-order-type">
                                  <option value="PicoSort::ORDER_TYPE_ASC">ASC</option>
                                  <option value="PicoSort::ORDER_TYPE_DESC">DESC</option>
                              </select></td>
                          <td><button type="button" class="btn btn-danger btn-remove-row"><i class="fa-regular fa-trash-can"></i></button></td>
                          <td width="30"><button type="button" class="btn btn-primary btn-move-up"><i class="fa-solid fa-arrow-up"></i></button></td>
                          <td width="30"><button type="button" class="btn btn-primary btn-move-down"><i class="fa-solid fa-arrow-down"></i></button></td>
                      </tr>
                  </tbody>
                  <tfoot>
                      <tr>
                          <td colspan="5"><button type="button" class="btn btn-primary btn-add-row">Add Row</button></td>
                      </tr>
                  </tfoot>
              </table>
            </div>
            <h4>Additional Output</h4>
            <p>Just leave it blank if it doesn't exist. Click Remove button to remove value.</p>
            <div class="table-reference-container">
              <table data-name="additional-output" class="table table-reference" data-empty-on-remove="true">
                  <thead>
                      <tr>
                          <td>Column</td>
                          <td width="42">Rem</td>
                          <td colspan="2">Move</td>
                      </tr>
                  </thead>
                  <tbody>
                      <tr>
                          <td><input class="form-control rd-column-name" type="text" value=""></td>
                          <td><button type="button" class="btn btn-danger btn-remove-row"><i class="fa-regular fa-trash-can"></i></button></td>
                          <td width="30"><button type="button" class="btn btn-primary btn-move-up"><i class="fa-solid fa-arrow-up"></i></button></td>
                          <td width="30"><button type="button" class="btn btn-primary btn-move-down"><i class="fa-solid fa-arrow-down"></i></button></td>
                      </tr>
                  </tbody>
                  <tfoot>
                      <tr>
                          <td colspan="4"><button type="button" class="btn btn-primary btn-add-row">Add Row</button></td>
                      </tr>
                  </tfoot>
              </table>
            </div>
            <h4>Selection</h4>
            <p>How user can select the options</p>
            <div class="table-reference-container">
              <table data-name="entity" class="modal-table" width="100%" border="0" cellspacing="0" cellpadding="0">
                  <tbody>
                      <tr>
                          <td>Selection</td>
                          <td><select class="form-control multiple-selection">
                            <option value="0">Single</option>
                            <option value="1">Multiple</option>
                          </td>
                      </tr>
                  </tbody>
              </table>
            </div>
        </div>
        <div class="reference-section map-section">
            <h4>Map</h4>
            <div class="table-reference-container">
              <table data-name="map" class="table table-reference" data-offset="2">
                  <thead>
                      <tr>
                          <td>Value</td>
                          <td>Label</td>
                          <td><input class="form-control map-key" type="text" value=""
                                  placeholder="Additional attribute name"></td>
                          <td>Def</td>
                          <td width="42">Rem</td>
                          <td colspan="2">Move</td>
                      </tr>
                  </thead>
                  <tbody>
                      <tr>
                          <td><input class="form-control rd-value" type="text" value=""></td>
                          <td><input class="form-control rd-label" type="text" value=""></td>
                          <td><input class="form-control map-value" type="text" value=""
                                  placeholder="Additional attribute value"></td>
                          <td><input type="checkbox" class="rd-selected"></td>
                          <td><button type="button" class="btn btn-danger btn-remove-row"><i class="fa-regular fa-trash-can"></i></button></td>
                          <td width="30"><button type="button" class="btn btn-primary btn-move-up"><i class="fa-solid fa-arrow-up"></i></button></td>
                          <td width="30"><button type="button" class="btn btn-primary btn-move-down"><i class="fa-solid fa-arrow-down"></i></button></td>
                      </tr>
                  </tbody>
                  <tfoot>
                      <tr>
                          <td colspan="7">
                              <button type="button" class="btn btn-primary btn-add-row">Add Row</button>
                              <button type="button" class="btn btn-primary btn-add-column">Add Column</button>
                              <button type="button" class="btn btn-primary btn-remove-last-column">Remove Last
                                  Column</button>
                          </td>
                      </tr>
                  </tfoot>
              </table>
            </div>
            <h4>Selection</h4>
            <p>How user can select the options</p>
            <div class="table-reference-container">
              <table data-name="entity" class="modal-table" width="100%" border="0" cellspacing="0" cellpadding="0">
                  <tbody>
                      <tr>
                          <td>Selection</td>
                          <td><select class="form-control multiple-selection">
                            <option value="0">Single</option>
                            <option value="1">Multiple</option>
                          </td>
                      </tr>
                  </tbody>
              </table>
            </div>
        </div>
    </div>
</form>
`}