let initielized=!1,currentEntity="",currentModule="";function upperCamelize(e){return e.replaceAll("_"," ").capitalize().prettify().replaceAll(" ","").trim()}function hasKey(e,t){let a=e.length,n;for(n=0;n<a;n++)if(e[n].value==t)return!0;return!1}function loadState(e,t,a){let n;for(n in a.find("tbody tr").each(function(t,n){let i=$(this).find('input[type="hidden"][name="field"]').val();hasKey(e,i)&&$(a).find('input[name$="'+i+'"]').each(function(e,t){$(this)[0].checked=!1})}),e){let i=$(a).find(":input[name="+e[n].name+"]");if(i.length){let l=e[n].value,r=e[n].name,o=i.prop("tagName").toString().toLowerCase(),d=i.attr("type");"radio"==d?$(a).find('[name="'+r+'"][value="'+l+'"]')[0].checked=!0:"checkbox"==d&&null!=l&&0!=l&&"0"!=l?$(a).find('[name="'+r+'"]')[0].checked=!0:"select"==o&&i.val(e[n].value)}}}function getReferenceResource(){return`
	<form action="">
	<label for="reference_type_entity"><input type="radio" class="reference_type" name="reference_type" id="reference_type_entity" value="entity" checked> Entity</label>
	<label for="reference_type_map"><input type="radio" class="reference_type" name="reference_type" id="reference_type_map" value="map"> Map</label>
	<label for="reference_type_yesno"><input type="radio" class="reference_type" name="reference_type" id="reference_type_yesno" value="yesno"> Yes/No</label>
	<label for="reference_type_truefalse"><input type="radio" class="reference_type" name="reference_type" id="reference_type_truefalse" value="truefalse"> True/False</label>
	<label for="reference_type_onezero"><input type="radio" class="reference_type" name="reference_type" id="reference_type_onezero" value="onezero"> 1/0</label>
	<div class="reference-container">
	  <div class="reference-section entity-section">
		<h4>Entity</h4>
		<table data-name="entity" class="modal-table" width="100%" border="0" cellspacing="0" cellpadding="0">
		  <tbody>
			<tr>
			  <td>Entity Name</td>
			  <td><input class="form-control rd-entity-name" type="text"></td>
			</tr>
			<tr>
			  <td>Table Name</td>
			  <td><input class="form-control rd-table-name" type="text"></td>
			</tr>
			<tr>
			  <td>Primary Key</td>
			  <td><input class="form-control rd-primary-key" type="text"></td>
			</tr>
			<tr>
			  <td>Value Column</td>
			  <td><input class="form-control rd-value-column" type="text"></td>
			</tr>
			<tr class="display-reference">
			  <td>Reference Object Name</td>
			  <td><input class="form-control rd-reference-object-name" type="text"></td>
			</tr>
			<tr class="display-reference">
			  <td>Reference Property Name</td>
			  <td><input class="form-control rd-reference-property-name" type="text"></td>
			</tr>
			<tr class="entity-generator">
			  <td></td>
			  <td><button type="button" class="btn btn-primary generate-entity">Generate Entity Now</button></td>
			</tr>
		  </tbody>
		</table>
		<h4>Option Node</h4>
		<table data-name="entity" class="modal-table" width="100%" border="0" cellspacing="0" cellpadding="0">
		  <tbody>
		  <tr>
		  <td>Format and Pamareters</td>
		  <td><input class="form-control rd-option-text-node-format" type="text"></td>
		  </tr>
		  <tr>
		  <td>Indent</td>
		  <td><input class="form-control rd-option-indent" type="number" step="1" min="0"></td>
		  </tr>
		</tbody>
		  </table>
		<h4>Specfification</h4>
		<p>Just leave it blank if it doesn't exist. Click Rem button to remove value.</p>
		<table data-name="specification" class="table table-reference" data-empty-on-remove="true">
		  <thead>
			<tr>
			  <td width="45%">Column Name</td>
			  <td>Value</td>
			  <td width="62">Rem</td>
			</tr>
		  </thead>
			  <tbody>
			  <tr>
				<td><input class="form-control rd-column-name" type="text" value=""></td>
				<td><input class="form-control rd-value" type="text" value=""></td>
				<td><button type="button" class="btn btn-danger btn-remove-row">Rem</button></td>
			  </tr>
			</tbody>
			<tfoot>
			  <tr>
				<td colspan="3">
				  <button type="button" class="btn btn-primary btn-add-row">Add Row</button>
				</td>
			  </tr>
			</tfoot>
		</table>
		<h4>Sortable</h4>
		<p>Use at least one column to sort.</p>
		<table data-name="sortable" class="table table-reference">
		  <thead>
			<tr>
			  <td width="65%">Column</td>
			  <td>Value</td>
			  <td width="62">Rem</td>
			</tr>
		  </thead>
			  <tbody>
			  <tr>
				<td><input class="form-control rd-column-name" type="text" value=""></td>
				<td><select class="form-control rd-order-type">
				  <option value="PicoSort::ORDER_TYPE_ASC">ASC</option>
				  <option value="PicoSort::ORDER_TYPE_DESC">DESC</option>
				</select></td>
				<td><button type="button" class="btn btn-danger btn-remove-row">Rem</button></td>
			  </tr>
			</tbody>
			<tfoot>
			  <tr>
				<td colspan="3"><button type="button" class="btn btn-primary btn-add-row">Add Row</button></td>
			  </tr>
			</tfoot>
		</table>
		<h4>Additional Output</h4>
		<p>Just leave it blank if it doesn't exist. Click Rem button to remove value.</p>
		<table data-name="additional-output" class="table table-reference" data-empty-on-remove="true">
		  <thead>
			<tr>
			  <td>Column</td>
			  <td width="62">Rem</td>
			</tr>
		  </thead>
			  <tbody>
			  <tr>
				<td><input class="form-control rd-column-name" type="text" value=""></td>
				<td><button type="button" class="btn btn-danger btn-remove-row">Rem</button></td>
			  </tr>
			</tbody>
			<tfoot>
			  <tr>
				<td colspan="3"><button type="button" class="btn btn-primary btn-add-row">Add Row</button></td>
			  </tr>
			</tfoot>
		</table>
	  </div>
	  <div class="reference-section map-section">
		<h4>Map</h4>
		<table data-name="map" class="table table-reference" data-offset="2">
		  <thead>
			<tr>
			  <td>Value</td>
			  <td>Label</td>
			  <td><input class="form-control map-key" type="text" value="" placeholder="Additional attribute name"></td>
			  <td>Def</td>
			  <td>Rem</td>
			</tr>
		  </thead>
			  <tbody>
			  <tr>
				<td><input class="form-control rd-value" type="text" value=""></td>
				<td><input class="form-control rd-label" type="text" value=""></td>
				<td><input class="form-control map-value" type="text" value="" placeholder="Additional attribute value"></td>
				<td><input type="checkbox" class="rd-selected"></td>
				<td><button type="button" class="btn btn-danger btn-remove-row">Rem</button></td>
			  </tr>
			</tbody>
			<tfoot>
			  <tr>
				<td colspan="5">
				  <button type="button" class="btn btn-primary btn-add-row">Add Row</button>
				  <button type="button" class="btn btn-primary btn-add-column">Add Column</button>
				  <button type="button" class="btn btn-primary btn-remove-last-column">Remove Last Column</button>
				</td>
			  </tr>
			</tfoot>
		</table>
	  </div>
	</div>
  </form>
  `}function showAlertUI(e,t){$("#alert-dialog .modal-title").text(e),$("#alert-dialog .modal-body").html(t),$("#alert-dialog").modal("show")}function closeAlertUI(){$("#alert-dialog").modal("hide")}function saveModule(){if(""!=currentModule){$("#button-save-module-file").attr("disabled","disabled");let e=cmEditorModule.getDoc().getValue();$.ajax({type:"POST",url:"lib.ajax/module-update.php",data:{content:e,module:currentModule},dataType:"html",success:function(e){$("#button-save-module-file").removeAttr("disabled")}})}else showAlertUI("Alert","No file open")}function saveEntity(){if(""!=currentEntity){$("#button-save-entity-file").attr("disabled","disabled");let e=cmEditorFile.getDoc().getValue();$.ajax({type:"POST",url:"lib.ajax/entity-update.php",dataType:"json",data:{content:e,entity:currentEntity},dataType:"json",success:function(e){$("#button-save-entity-file").removeAttr("disabled"),updateEntityFile(),updateEntityQuery(!0),e.success||(showAlertUI(e.error_title,e.error_message),setTimeout(function(){closeAlertUI()},2e3))}})}else showAlertUI("Alert","No file open")}function saveQuery(){let e=new Blob([cmEditorSQL.getDoc().getValue()],{type:"application/x-sql;charset=utf-8"}),t=$("#current_application").val();saveAs(e,t+"-"+new Date().getTime()+".sql")}function getEntitySelection(){let e=[];return $(".entity-checkbox").each(function(){$(this)[0].checked&&e.push($(this).val())}),e}function getEntityQuery(e,t){$.ajax({type:"POST",url:"lib.ajax/entity-query.php",data:{entity:e,merged:t?1:0},dataType:"html",success:function(e){cmEditorSQL.getDoc().setValue(e),setTimeout(function(){cmEditorSQL.refresh()},1),$("#button-save-entity-query").removeAttr("disabled")}})}function getEntityFile(e,t){$.ajax({type:"POST",url:"lib.ajax/entity-file.php",data:{entity:e},dataType:"html",success:function(a){cmEditorFile.getDoc().setValue(a),setTimeout(function(){cmEditorFile.refresh()},1),$("#button-save-entity-file").removeAttr("disabled"),currentEntity=e[0],t&&t()}})}function getModuleFile(e,t){$.ajax({type:"POST",url:"lib.ajax/module-file.php",data:{module:e},dataType:"html",success:function(a){cmEditorModule.getDoc().setValue(a),setTimeout(function(){cmEditorModule.refresh()},1),$("#button-save-module-file").removeAttr("disabled"),currentModule=e,t&&t()}})}function updateEntityQuery(e){e=e||!1,$.ajax({type:"GET",url:"lib.ajax/entity-list-with-checkbox.php",data:{autoload:e},dataType:"html",success:function(t){$(".entity-container-query .entity-list").empty().append(t),$('.entity-container-query .entity-list [data-toggle="tooltip"]').tooltip({placement:"top"});let a=getEntitySelection(),n=$(".entity-merge")[0].checked;e&&getEntityQuery(a,n)}})}function updateEntityFile(){$.ajax({type:"GET",url:"lib.ajax/entity-list.php",dataType:"html",success:function(e){$(".entity-container-file .entity-list").empty().append(e),$(".entity-container-translate-etity .entity-list").empty().append(e),$('.entity-container-file .entity-list [data-toggle="tooltip"], .entity-container-translate-etity .entity-list [data-toggle="tooltip"]').tooltip({placement:"top"})}})}function updateModuleFile(){$.ajax({type:"GET",url:"lib.ajax/module-list.php",dataType:"html",success:function(e){$(".module-container .module-list").empty().append(e),$('.module-container .module-list [data-toggle="tooltip"]').tooltip({placement:"top"})}})}function saveReference(e,t,a){$.ajax({type:"POST",url:"lib.ajax/save-reference.php",data:{fieldName:e,key:t,value:a},dataType:"json",success:function(e){}})}function loadReference(e,t,a){$.ajax({type:"POST",url:"lib.ajax/load-reference.php",data:{fieldName:e,key:t},dataType:"json",success:function(e){a(e)}})}function updateTableName(e,t,a,n,i){e=e.replaceAll("_","-"),t=t.replaceAll("_","-"),a=ucWord(a.replaceAll("_"," "));let l=upperCamelize(n),r=n+"_apv",o=n+"_trash";$(this).attr("data-value",n),$('[name="primary_key_master"]').val(i),$('[name="entity_master_name"]').val(l),$('[name="entity_approval_name"]').val(l+"Apv"),$('[name="entity_trash_name"]').val(l+"Trash"),$('[name="table_approval_name"]').val(r),$('[name="primary_key_approval"]').val(r+"_id"),$('[name="table_trash_name"]').val(o),$('[name="primary_key_trash"]').val(o+"_id"),$('[name="module_file"]').val(e),$('[name="module_code"]').val(t),$('[name="module_name"]').val(a)}function ucWord(e){return(e=e.toLowerCase()).replace(/(^([a-zA-Z\p{M}]))|([ -][a-zA-Z\p{M}])/g,function(e){return e.toUpperCase()})}function prepareReferenceData(e,t){let a=t.closest("tr");"select"==e?a.find(".reference-button-data").css("display","inline"):a.find(".reference-button-data").css("display","none")}function prepareReferenceFilter(e,t){let a=t.closest("tr");"select"==e?a.find(".reference-button-filter").css("display","inline"):a.find(".reference-button-filter").css("display","none")}function switchApplication(e){$.ajax({type:"post",url:"lib.ajax/application-switch.php",dataType:"json",data:{currentApplication:e},success:function(e){window.location.reload()}})}function generateScript(e){let t=[];$(e).find("tr").each(function(e){let a=$(this).attr("data-field-name"),n=$(this).find("input.input-field-name").val(),i=$(this).find("input.include_insert")[0].checked,l=$(this).find("input.include_edit")[0].checked,r=$(this).find("input.include_detail")[0].checked,o=$(this).find("input.include_list")[0].checked,d=$(this).find("input.include_export")[0].checked,c=$(this).find("input.include_key")[0].checked,u=$(this).find("input.include_required")[0].checked,s=$(this).find("input.input-element-type:checked").val(),p=$(this).find("input.input-field-filter:checked").length>0?$(this).find("input.input-field-filter:checked").val():null,f=$(this).find("select.input-field-data-type").val(),m=$(this).find("select.input-data-filter").val(),y=parseJsonData($(this).find("input.reference-data").val()),h=parseJsonData($(this).find("input.reference-filter").val()),v={fieldName:a,fieldLabel:n,includeInsert:i,includeEdit:l,includeDetail:r,includeList:o,includeExport:d,isKey:c,isInputRequired:u,elementType:s,filterElementType:p,dataType:f,inputFilter:m,referenceData:y,referenceFilter:h};console.log(v),t.push(v)});let a=$("#subquery")[0].checked&&!0,n=$("#with_approval")[0].checked&&!0,i=$("#with_trash")[0].checked&&!0,l=$("#manualsortorder")[0].checked&&!0,r=$("#export_to_excel")[0].checked&&!0,o=$("#activate_deactivate")[0].checked&&!0,d=$("#with_approval_note")[0].checked&&!0,c=$('[name="approval_position"]:checked').val(),u=$('[name="approval_type"]:checked').val(),s=$("#ajax_support")[0].checked&&!0,p={mainEntity:{entityName:$('[name="entity_master_name"]').val(),tableName:$('[name="source_table"]').val(),primaryKey:$('[name="primary_key_master"]').val()},approvalRequired:n,trashRequired:i};n&&(p.approvalEntity={entityName:$('[name="entity_approval_name"]').val(),tableName:$('[name="table_approval_name"]').val(),primaryKey:$('[name="primary_key_approval"]').val()}),i&&(p.trashEntity={entityName:$('[name="entity_trash_name"]').val(),tableName:$('[name="table_trash_name"]').val(),primaryKey:$('[name="primary_key_trash"]').val()});let f=getSpecificationModule(),m=getSortableModule(),y={entity:p,fields:t,specification:f,sortable:m,features:{subquery:a,activateDeactivate:o,sortOrder:l,exportToExcel:r,approvalRequired:n,approvalNote:d,trashRequired:i,approvalType:u,approvalPosition:c,ajaxSupport:s},moduleCode:$('[name="module_code"]').val(),moduleName:$('[name="module_name"]').val(),moduleFile:$('[name="module_file"]').val(),target:$("#current_module_location").val(),updateEntity:$('[name="update_entity"]')[0].checked};generateAllCode(y)}function getSpecificationModule(){let e=[];return $(".table-data-filter").find("tbody").find("tr").each(function(t){let a=$(this);if(a.find(".data-filter-column-name").length&&a.find(".data-filter-column-value").length){let n=a.find(".data-filter-column-name").val(),i=a.find(".data-filter-column-value").val();n=n?n.trim():"",i=i?i.trim():"",n.length>0&&e.push({column:n,value:i})}}),e}function getSortableModule(){let e=[];return $(".table-data-order").find("tbody").find("tr").each(function(t){let a=$(this);if(a.find(".data-order-column-name").length&&a.find(".data-order-order-type").length){let n=a.find(".data-order-column-name").val(),i=a.find(".data-order-order-type").val();n=n?n.trim():"",i=i?i.trim():"",n.length>0&&e.push({sortBy:n,sortType:i})}}),e}function parseJsonData(e){if("string"!=typeof e)return null;try{let t=JSON.parse(e);if("object"==typeof t)return t}catch(a){}return null}function generateAllCode(e){$.ajax({type:"post",url:"lib.ajax/script-generator.php",dataType:"json",data:e,success:function(e){updateEntityFile(),updateEntityQuery(!0),e.success&&(showAlertUI(e.title,e.message),setTimeout(function(){closeAlertUI()},2e3))}})}function updateCurrentApplivation(e){$.ajax({type:"post",url:"lib.ajax/update-current-application.php",dataType:"json",data:e,success:function(e){for(let t in $('select[name="source_table"]').empty(),e)$('select[name="source_table"]')[0].append(new Option(e[t].table_name,e[t].table_name));let a=$('select[name="source_table"]').attr("data-value");null!=a&&""!=a&&$('select[name="source_table"]').val(a)}})}function loadTable(){$.ajax({type:"post",url:"lib.ajax/table-list.php",dataType:"json",success:function(e){for(let t in $('select[name="source_table"]').empty(),$('select[name="source_table"]')[0].append(new Option("- Select Table -","")),e)e.hasOwnProperty(t)&&$('select[name="source_table"]')[0].append(new Option(e[t].table_name,e[t].table_name));$('select[name="source_table"]').find("option").each(function(t){let a=$(this).attr("value")||"";""!=a&&void 0!==e[a]&&void 0!==e[a].primary_key&&void 0!==e[a].primary_key[0]&&$(this).attr("data-primary-key",e[a].primary_key[0])});let a=$('select[name="source_table"]').attr("data-value");null!=a&&""!=a&&$('select[name="source_table"]').val(a)}})}function loadColumn(e,t){$.ajax({type:"post",url:"lib.ajax/column-list.php",data:{table_name:e},dataType:"json",success:function(e){$(t).empty();let a=e.fields,n,i,l,r,o=getSkipedCol();for(n in a)r=generateRow(i=a[n].column_name,l={type:a[n].data_type},o),$(t).append(r);if(void 0!==e.primary_keys&&e.primary_keys.length)for(let d in e.primary_keys){let c=e.primary_keys[d];$('[data-field-name="'+c+'"]').find('[name="include_key_'+c+'"]')[0].checked=!0}$('[name="module_load_previous"]')[0].checked?loadSavedModuleData($("#module_file").val(),$("#current_module_location").val(),function(){$(".define-wrapper").css("display","block"),$("#define-column-tab").click()}):($(".define-wrapper").css("display","block"),$("#define-column-tab").click())}})}function restoreForm(e){if(void 0!==e.fields){for(let t in e.fields)if(e.fields.hasOwnProperty(t)){let a=$('.main-table tbody tr[data-field-name="'+e.fields[t].fieldName+'"]');a.length>0&&(a.appendTo(a.parent()),a.find(".include_insert")[0].checked=!0===e.fields[t].includeInsert||"true"==e.fields[t].includeInsert,a.find(".include_edit")[0].checked=!0===e.fields[t].includeEdit||"true"==e.fields[t].includeEdit,a.find(".include_detail")[0].checked=!0===e.fields[t].includeDetail||"true"==e.fields[t].includeDetail,a.find(".include_list")[0].checked=!0===e.fields[t].includeList||"true"==e.fields[t].includeList,a.find(".include_export")[0].checked=!0===e.fields[t].includeExport||"true"==e.fields[t].includeExport,a.find(".include_key")[0].checked=!0===e.fields[t].isKey||"true"==e.fields[t].isKey,a.find(".include_required")[0].checked=!0===e.fields[t].isInputRequired||"true"==e.fields[t].isInputRequired,a.find('.input-element-type[value="'+e.fields[t].elementType+'"]')[0].checked=!0,"select"==e.fields[t].elementType&&(a.find(".reference-data").val(JSON.stringify(e.fields[t].referenceData)),a.find(".reference-button-data").css("display","inline")),"select"==e.fields[t].filterElementType&&(a.find(".reference-filter").val(JSON.stringify(e.fields[t].referenceFilter)),a.find(".reference-button-filter").css("display","inline"),a.find('.input-field-filter[value="select"]')[0].checked=!0),"text"==e.fields[t].filterElementType&&(a.find('.input-field-filter[value="text"]')[0].checked=!0),a.find(".input-field-data-type").val(e.fields[t].dataType),a.find(".input-data-filter").val(e.fields[t].inputFilter))}}let n,i;for(n=0,i="#modal-filter-data tbody tr:last-child";$("#modal-filter-data tbody tr").length>1;)$(i).remove();if($(i).find(".data-filter-column-name").val(""),$(i).find(".data-filter-column-value").val(""),void 0===e.specification||0==e.specification.length)$(i).find(".data-filter-column-name").val(""),$(i).find(".data-filter-column-value").val("");else for(let l in e.specification)if(e.specification.hasOwnProperty(l)){if(n>0){let r=$(i)[0].outerHTML;$(i).parent().append(r)}$(i).find(".data-filter-column-name").val(e.specification[l].column),$(i).find(".data-filter-column-value").val(e.specification[l].value),n++}for(n=0,i="#modal-order-data tbody tr:last-child";$("#modal-order-data tbody tr").length>1;)$(i).remove();if($(i).find(".data-filter-column-name").val(""),$(i).find(".data-filter-column-value").val(""),void 0===e.sortable||0==e.sortable.length)$(i).find(".data-order-column-name").val(""),$(i).find(".data-order-order-type").val("PicoSort::ORDER_TYPE_ASC");else for(let o in e.sortable)if(e.sortable.hasOwnProperty(o)){if(n>0){let d=$(i)[0].outerHTML;$(i).parent().append(d)}$(i).find(".data-order-column-name").val(e.sortable[o].sortBy),$(i).find(".data-order-order-type").val(e.sortable[o].sortType),n++}void 0!==e.features&&($('#modal-module-features [name="subquery"]').length&&($('#modal-module-features [name="subquery"]')[0].checked=!0===e.features.subquery||"true"==e.features.subquery),$('#modal-module-features [name="activate_deactivate"]').length&&($('#modal-module-features [name="activate_deactivate"]')[0].checked=!0===e.features.activateDeactivate||"true"==e.features.activateDeactivate),$('#modal-module-features [name="manualsortorder"]').length&&($('#modal-module-features [name="manualsortorder"]')[0].checked=!0===e.features.sortOrder||"true"==e.features.sortOrder),$('#modal-module-features [name="export_to_excel"]').length&&($('#modal-module-features [name="export_to_excel"]')[0].checked=!0===e.features.exportToExcel||"true"==e.features.exportToExcel),$('#modal-module-features [name="with_approval"]').length&&($('#modal-module-features [name="with_approval"]')[0].checked=!0===e.features.approvalRequired||"true"==e.features.approvalRequired),$('#modal-module-features [name="with_approval_note"]').length&&($('#modal-module-features [name="with_approval_note"]')[0].checked=!0===e.features.approvalNote||"true"==e.features.approvalNote),$('#modal-module-features [name="with_trash"]').length&&($('#modal-module-features [name="with_trash"]')[0].checked=!0===e.features.trashRequired||"true"==e.features.trashRequired),$('#modal-module-features [name="approval_type"][value="'+e.features.approvalType+'"]').length&&($('#modal-module-features [name="approval_type"][value="'+e.features.approvalType+'"]')[0].checked=!0),$('#modal-module-features [name="approval_position"][value="'+e.features.approvalPosition+'"]').length&&($('#modal-module-features [name="approval_position"][value="'+e.features.approvalPosition+'"]')[0].checked=!0),$('#modal-module-features [name="ajax_support"]').length&&($('#modal-module-features [name="ajax_support"]')[0].checked=!0===e.features.ajaxSupport||"true"==e.features.ajaxSupport))}function loadSavedModuleData(e,t,a){$.ajax({type:"GET",url:"lib.ajax/module-data.php",data:{moduleFile:e,target:t},dataType:"json",success:function(e){restoreForm(e),a()},error:function(e){a()}})}function getSkipedCol(){let e=[];return e.push($('[name="entity_info_draft"]').val()),e.push($('[name="entity_info_waiting_for"]').val()),e.push($('[name="entity_info_approval_note"]').val()),e.push($('[name="entity_info_approval_id"]').val()),e.push($('[name="entity_info_admin_create"]').val()),e.push($('[name="entity_info_admin_edit"]').val()),e.push($('[name="entity_info_admin_ask_edit"]').val()),e.push($('[name="entity_info_time_create"]').val()),e.push($('[name="entity_info_time_edit"]').val()),e.push($('[name="entity_info_time_ask_edit"]').val()),e.push($('[name="entity_info_ip_create"]').val()),e.push($('[name="entity_info_ip_edit"]').val()),e.push($('[name="entity_info_ip_ask_edit"]').val()),e}function generateSelectFilter(e,t){let a;(t=t||{}).type=t.type||"text";let n=t.type,i={FILTER_SANITIZE_NUMBER_INT:["bit","varbit","smallint","int","integer","bigint","smallserial","serial","bigserial","bool","boolean",],FILTER_SANITIZE_NUMBER_FLOAT:["numeric","double","real","money"],FILTER_SANITIZE_SPECIAL_CHARS:["char","character","varchar","character varying","text","date","timestamp","time",]};a=$('<select class="form-control input-data-filter" name="filter_type_'+e+'" id="filter_type_'+e+'">\r\n<option value="FILTER_SANITIZE_NUMBER_INT">NUMBER_INT</option>\r\n<option value="FILTER_SANITIZE_NUMBER_UINT">NUMBER_UINT</option>\r\n<option value="FILTER_SANITIZE_NUMBER_OCTAL">NUMBER_OCTAL</option>\r\n<option value="FILTER_SANITIZE_NUMBER_HEXADECIMAL">NUMBER_HEXADECIMAL</option>\r\n<option value="FILTER_SANITIZE_NUMBER_FLOAT">NUMBER_FLOAT</option>\r\n<option value="FILTER_SANITIZE_STRING">STRING</option>\r\n<option value="FILTER_SANITIZE_STRING_INLINE">STRING_INLINE</option>\r\n<option value="FILTER_SANITIZE_NO_DOUBLE_SPACE">NO_DOUBLE_SPACE</option>\r\n<option value="FILTER_SANITIZE_STRIPPED">STRIPPED</option>\r\n<option value="FILTER_SANITIZE_SPECIAL_CHARS">SPECIAL_CHARS</option>\r\n<option value="FILTER_SANITIZE_ALPHA">ALPHA</option>\r\n<option value="FILTER_SANITIZE_ALPHANUMERIC">ALPHANUMERIC</option>\r\n<option value="FILTER_SANITIZE_ALPHANUMERICPUNC">ALPHANUMERICPUNC</option>\r\n<option value="FILTER_SANITIZE_STRING_BASE64">STRING_BASE64</option>\r\n<option value="FILTER_SANITIZE_EMAIL">EMAIL</option>\r\n<option value="FILTER_SANITIZE_URL">URL</option>\r\n<option value="FILTER_SANITIZE_IP">IP</option>\r\n<option value="FILTER_SANITIZE_ENCODED">ENCODED</option>\r\n<option value="FILTER_SANITIZE_COLOR">COLOR</option>\r\n<option value="FILTER_SANITIZE_MAGIC_QUOTES">MAGIC_QUOTES</option>\r\n<option value="FILTER_SANITIZE_PASSWORD">PASSWORD</option>\r\n</select>\r\n');let l,r,o,d="FILTER_SANITIZE_SPECIAL_CHARS",c=!1;for(l in i){for(o in r=i[l])if(-1!=n.indexOf(r[o])){d=l,c=!0;break}if(c)break}return a.find("option").each(function(e,t){$(this).removeAttr("selected")}),a.find('option[value="'+d+'"]').attr("selected","selected"),a[0].outerHTML}function generateSelectType(e,t){let a;(t=t||{}).type=t.type||"text";let n=t.type,i={int:["bit","varbit","smallint","int","integer","bigint","smallserial","serial","bigserial","bool","boolean",],float:["numeric","double","real","money"],text:["char","character","varchar","character varying","text"],"datetime-local":["datetime","timestamp"],date:["date"],time:["time"]};a=$('<select class="form-control input-field-data-type" name="data_type_'+e+'" id="data_type_'+e+'">\r\n<option value="text" title="&lt;input type=&quot;text&quot;&gt;">text</option>\r\n<option value="email" title="&lt;input type=&quot;email&quot;&gt;">email</option>\r\n<option value="url" title="&lt;input type=&quot;email&quot;&gt;">url</option>\r\n<option value="tel" title="&lt;input type=&quot;tel&quot;&gt;">tel</option>\r\n<option value="password" title="&lt;input type=&quot;password&quot;&gt;">password</option>\r\n<option value="int" title="&lt;input type=&quot;number&quot;&gt;">int</option>\r\n<option value="float" title="&lt;input type=&quot;number&quot; step=&quot;any&quot;&gt;">float</option>\r\n<option value="date" title="&lt;input type=&quot;text&date;&gt;">date</option>\r\n<option value="time" title="&lt;input type=&quot;time&quot;&gt;">time</option>\r\n<option value="datetime-local" title="&lt;input type=&quot;datetime-local&quot;&gt;">datetime</option>\r\n<option value="week" title="&lt;input type=&quot;week&quot;&gt;">week</option>\r\n<option value="color" title="&lt;input type=&quot;color&quot;&gt;">color</option>\r\n</select>\r\n');let l,r,o,d="FILTER_SANITIZE_SPECIAL_CHARS",c=!1;for(l in i){for(o in r=i[l])if(-1!=n.indexOf(r[o])){d=l,c=!0;break}if(c)break}return a.find("option").each(function(e,t){$(this).removeAttr("selected")}),a.find('option[value="'+d+'"]').attr("selected","selected"),a[0].outerHTML}function arrayUnique(e){let t,a=[];for(t=0;t<e.length;t++)-1==a.indexOf(e[t])&&a.push(e[t]);return a}function isKeyWord(e){e=e.toString();let t,a=keyWords.split(",");for(t in a)if(e.equalIgnoreCase(a[t]))return!0;return!1}String.prototype.replaceAll=function(e,t){return this.replace(RegExp(e,"g"),t)},jQuery(function(){$(document).on("click","#vscode",function(){let e=$("#current_application option:selected").attr("data-directory");window.location="vscode://file/"+e}),$(document).on("click","#load_table",function(e){e.preventDefault(),loadTable()}),$(document).on("click","#load_column",function(e){e.preventDefault();let t=$('[name="source_table"]').val(),a=$("table.main-table tbody");loadColumn(t,a)}),$(document).on("change",'select[name="source_table"]',function(e){let t=$(this).val(),a=$(this).find("option:selected").attr("data-primary-key")||"";updateTableName(t+".php",t,t,t,a)}),$(document).on("click","#save_application_config",function(e){e.preventDefault();let t=$(this).closest("form"),a=$(this).closest("form").serializeArray(),n={current_application:t.find('[name="current_application"]').val(),database:{},sessions:{},entity_info:{}};for(let i in a){let l=a[i].name;-1!==l.indexOf("database_")&&(n.database[l.substring(9)]=a[i].value),-1!==l.indexOf("sessions_")&&(n.sessions[l.substring(9)]=a[i].value),-1!==l.indexOf("entity_info_")&&(n.entity_info[l.substring(12)]=a[i].value)}updateCurrentApplivation(n)}),$(document).on("click","#generate-script",function(e){e.preventDefault(),generateScript($(".main-table tbody"))}),$(document).on("click","#switch-application",function(e){e.preventDefault(),switchApplication($("#current_application").val())}),$(document).on("change",".input-field-filter",function(e){let t=$(this)[0].checked,a=$(this).attr("value");t?($(this).closest("tr").find('.input-field-filter[value!="'+a+'"]')[0].checked=!1,prepareReferenceFilter(a,$(this))):$(this).closest("tr").find(".reference-button-filter").css("display","none")}),$(document).on("change",".input-element-type",function(e){let t=$(this).attr("value");prepareReferenceData(t,$(this))}),$(document).on("click",".reference-button-data",function(e){e.preventDefault(),$("#modal-create-reference-data").find(".modal-title").text("Create Data Reference"),$("#modal-create-reference-data").attr("data-reference-type","data"),$(this).closest("td");let t=$(this).closest("tr").attr("data-field-name"),a=$(this).siblings("input").attr("name");$("#modal-create-reference-data").attr("data-input-name",a),$("#modal-create-reference-data").attr("data-field-name",t),$("#modal-create-reference-data").find(".modal-body").empty(),$("#modal-create-reference-data").find(".modal-body").append(getReferenceResource());let n=$('[name="'+a+'"]').val();if(n.length<60&&loadReference(t,a,function(e){null!=e&&deserializeForm(e)}),""!=n){let i=parseJsonData(n);"object"!=typeof i&&(i={}),deserializeForm(i)}$("#modal-create-reference-data").modal("show")}),$(document).on("click",".reference-button-filter",function(e){e.preventDefault(),$("#modal-create-reference-data").find(".modal-title").text("Create Filter Reference"),$("#modal-create-reference-data").attr("data-reference-type","filter");let t=$(this).closest("tr").attr("data-field-name"),a=$(this).siblings("input").attr("name");$("#modal-create-reference-data").attr("data-input-name",a),$("#modal-create-reference-data").attr("data-field-name",t),$("#modal-create-reference-data").find(".modal-body").empty(),$("#modal-create-reference-data").find(".modal-body").append(getReferenceResource());let n=$('[name="'+a+'"]').val().trim();if(n.length<60&&loadReference(t,a,function(e){null!=e&&deserializeForm(e)}),""!=n){let i=parseJsonData(n);"object"!=typeof i&&(i={}),deserializeForm(i)}$("#modal-create-reference-data").modal("show")}),$(document).on("click","#apply-reference",function(e){let t=$("#modal-create-reference-data").attr("data-input-name"),a=JSON.stringify(serializeForm());$('[name="'+t+'"]').val(a),$("#modal-create-reference-data").modal("hide")}),$(document).on("click","#save-to-cache",function(e){let t=$("#modal-create-reference-data").attr("data-field-name"),a=$("#modal-create-reference-data").attr("data-input-name"),n=JSON.stringify(serializeForm());saveReference(t,a,n)}),$(document).on("click","#load-from-cache",function(e){let t=$("#modal-create-reference-data").attr("data-field-name"),a=$("#modal-create-reference-data").attr("data-input-name");loadReference(t,a,function(e){null!=e&&deserializeForm(e)})}),$(document).on("click",".reference_type",function(e){let t=$(this).val();selectReferenceType({type:t})}),$(document).on("click",".btn-add-column",function(e){let t=$(this).closest("table");addColumn(t)}),$(document).on("click",".btn-remove-last-column",function(e){let t=$(this).closest("table");removeLastColumn(t)}),$(document).on("click",".btn-add-row",function(e){let t=$(this).closest("table");addRow(t)}),$(document).on("click",".btn-remove-row",function(e){let t=$(this).closest("tbody").find("tr").length;t>1?$(this).closest("tr").remove():1==t&&"true"==$(this).closest("table").attr("data-empty-on-remove")&&$(this).closest("tr").find(":input").each(function(e){$(this).val("")})}),$(document).on("change",'.map-section input[type="checkbox"]',function(e){$(this)[0].checked&&$(this).closest("tr").siblings().each(function(){$(this).find('input[type="checkbox"]')[0].checked=!1})}),$(document).on("change",".entity-checkbox",function(e){let t=getEntitySelection(),a=$(".entity-merge")[0].checked;getEntityQuery(t,a)}),$(document).on("change",".entity-merge",function(e){let t=getEntitySelection(),a=$(".entity-merge")[0].checked;getEntityQuery(t,a)}),$(document).on("change","#entity-check-controll",function(e){let t=$(this)[0].checked;$(".entity-checkbox").each(function(){$(this)[0].checked=t});let a=getEntitySelection(),n=$(".entity-merge")[0].checked;getEntityQuery(a,n)}),$(document).on("click","#create-new-app",function(e){e.preventDefault();let t=$(this).closest(".modal"),a=t.find('[name="application_name"]').val().trim(),n=t.find('[name="application_id"]').val().trim(),i=t.find('[name="application_directory"]').val().trim(),l=t.find('[name="application_author"]').val().trim();""!=a&&""!=n&&""!=i&&""!=l&&$.ajax({method:"POST",url:"lib.ajax/application-create.php",data:{name:a,id:n,directory:i,author:l},success:function(e){window.location="./#module"}})}),$(document).on("click",".entity-container-file .entity-li a",function(e){e.preventDefault();let t=$(this).attr("data-entity-name"),a=$(this);getEntityFile([t],function(){$(".entity-li").removeClass("selected-file"),a.parent().addClass("selected-file")})}),$(document).on("click",".module-list .file-li a",function(e){e.preventDefault();let t=$(this).attr("data-file-name"),a=$(this);getModuleFile(t,function(){$(".file-li").removeClass("selected-file"),a.parent().addClass("selected-file")})}),$(document).on("click",".entity-container-query .entity-li a",function(e){e.preventDefault();let t=$(this).attr("data-entity-name");getEntityQuery([t])}),$(document).on("click","#button-save-module-file",function(e){e.preventDefault(),saveModule()}),$(document).on("click","#button-save-entity-file",function(e){e.preventDefault(),saveEntity()}),$(document).on("click","#button-save-entity-query",function(e){e.preventDefault(),saveQuery()}),$("tbody.data-table-manual-sort").each(function(e){let t=$(this)[0];Sortable.create(t,{animation:150,scroll:!0,handle:".data-sort-handler",onEnd:function(){}})}),$(document).on("click",".entity-container-translate-etity .entity-list a",function(e){e.preventDefault(),e.stopPropagation();let t=$(this).attr("data-entity-name");$.ajax({method:"POST",url:"lib.ajax/entity-translate.php",dataType:"json",data:{entityName:t},success:function(e){let t=[],a=[];for(let n in e)t.push(e[n].original),a.push(e[n].translated);trasEd1.getDoc().setValue(t.join("\r\n")),trasEd2.getDoc().setValue(a.join("\r\n")),focused={},trasEd1.removeLineClass(lastLine,"background","highlight-line"),trasEd2.removeLineClass(lastLine,"background","highlight-line"),lastLine=-1}})}),loadTable(),updateEntityQuery(!1),updateEntityFile(),updateModuleFile(),window.location.hash}),String.prototype.equalIgnoreCase=function(e){return this.toLowerCase()==e.toLowerCase()};let keyWords="absolute,action,add,after,aggregate,alias,all,allocate,alter,analyse,analyze,and,any,are,array,as,asc,assertion,at,authorization,avg,before,begin,between,binary,bit,bit_length,blob,boolean,both,breadth,by,call,cascade,cascaded,case,cast,catalog,char,character,character_length,char_length,check,class,clob,close,coalesce,collate,collation,column,commit,completion,connect,connection,constraint,constraints,constructor,continue,convert,corresponding,count,create,cross,cube,current,current_date,current_path,current_role,current_time,current_timestamp,current_user,cursor,cycle,data,date,day,deallocate,dec,decimal,declare,default,deferrable,deferred,delete,depth,deref,desc,describe,descriptor,destroy,destructor,deterministic,diagnostics,dictionary,disconnect,distinct,do,domain,double,drop,dynamic,each,else,end,end-exec,equals,escape,every,except,exception,exec,execute,exists,external,extract,false,fetch,first,float,for,foreign,found,free,from,full,function,general,get,global,go,goto,grant,group,grouping,having,host,hour,identity,ignore,immediate,in,indicator,initialize,initially,inner,inout,input,insensitive,insert,int,integer,intersect,interval,into,is,isolation,iterate,join,key,language,large,last,lateral,leading,left,less,level,like,limit,local,localtime,localtimestamp,locator,lower,map,match,max,min,minute,modifies,modify,month,names,national,natural,nchar,nclob,new,next,no,none,not,null,nullif,numeric,object,octet_length,of,off,offset,old,on,only,open,operation,option,or,order,ordinality,out,outer,output,overlaps,pad,parameter,parameters,partial,path,placing,position,postfix,precision,prefix,preorder,prepare,preserve,primary,prior,privileges,procedure,public,read,reads,real,recursive,ref,references,referencing,relative,restrict,result,return,returns,revoke,right,role,rollback,rollup,routine,row,rows,savepoint,schema,scope,scroll,search,second,section,select,sequence,session,session_user,set,sets,size,smallint,some,space,specific,specifictype,sql,sqlcode,sqlerror,sqlexception,sqlstate,sqlwarning,start,state,statement,static,structure,substring,sum,system_user,table,temporary,terminate,than,then,time,timestamp,timezone_hour,timezone_minute,to,trailing,transaction,translate,translation,treat,trigger,trim,true,under,union,unique,unknown,unnest,update,upper,usage,user,using,value,values,varchar,variable,varying,view,when,whenever,where,with,without,work,write,year,zone";function generateRow(e,t,a){let n=isKeyWord(e),i=[],l="";i.push("row-column"),n&&i.push("reserved"),l=' class="'+i.join(" ")+'"';let r="",o="",d="",c="";return -1!=$.inArray(e,a)?(r='  <td align="center"><input type="checkbox" class="include_insert" name="include_insert_'+e+'" value="0" disabled="disabled"></td>\r\n',o='  <td align="center"><input type="checkbox" class="include_edit" name="include_edit_'+e+'" value="0" disabled="disabled"></td>\r\n',d='  <td align="center"><input type="checkbox" class="include_list" name="include_list_'+e+'" value="1"></td>\r\n'):(r='  <td align="center"><input type="checkbox" class="include_insert" name="include_insert_'+e+'" value="1" checked="checked"></td>\r\n',o='  <td align="center"><input type="checkbox" class="include_edit" name="include_edit_'+e+'" value="1" checked="checked"></td>\r\n',d='  <td align="center"><input type="checkbox" class="include_list" name="include_list_'+e+'" value="1" checked="checked"></td>\r\n'),c='  <td align="center"><input type="checkbox" class="include_export" name="include_export_'+e+'" value="1" checked="checked"></td>\r\n','<tr data-field-name="'+e+'" '+l+'>\r\n  <td class="data-sort data-sort-body data-sort-handler"></td>\r\n  <td class="field-name">'+e+'<input type="hidden" name="field" value="'+e+'"></td>\r\n  <td><input type="hidden" class="input-field-name" name="caption_'+e+'" value="'+e.replaceAll("_"," ").capitalize().prettify().trim()+'" autocomplete="off" spellcheck="false">'+e.replaceAll("_"," ").capitalize().prettify().trim()+"</td>\r\n"+r+o+'  <td align="center"><input type="checkbox" class="include_detail" name="include_detail_'+e+'" value="1" checked="checked"></td>\r\n'+d+c+'  <td align="center"><input type="checkbox" class="include_key" name="include_key_'+e+'" value="1"></td>\r\n  <td align="center"><input type="checkbox" class="include_required" name="include_required_'+e+'" value="1"></td>\r\n  <td align="center"><input type="radio" class="input-element-type" name="element_type_'+e+'" value="text" checked="checked"></td>\r\n  <td align="center"><input type="radio" class="input-element-type" name="element_type_'+e+'" value="textarea"></td>\r\n  <td align="center"><input type="radio" class="input-element-type" name="element_type_'+e+'" value="checkbox"></td>\r\n  <td align="center"><input type="radio" class="input-element-type" name="element_type_'+e+'" value="select"></td>\r\n  <td align="center"><input type="hidden" class="reference-data" name="reference_data_'+e+'" value="{}"><button type="button" class="btn btn-sm btn-primary reference-button reference-button-data">Source</button></td>\r\n  <td align="center"><input type="checkbox" name="list_filter_'+e+'" value="text" class="input-field-filter"></td>\r\n  <td align="center"><input type="checkbox" name="list_filter_'+e+'" value="select" class="input-field-filter"></td>\r\n  <td align="center"><input type="hidden" class="reference-filter" name="reference_filter_'+e+'" value="{}"><button type="button" class="btn btn-sm btn-primary reference-button reference-button-filter">Source</button></td>\r\n  <td>\r\n'+generateSelectType(e,t)+"  </td>\r\n  <td>\r\n"+generateSelectFilter(e,t)+"  </td>\r\n</tr>\r\n"}function serializeForm(){let e=null;$(".reference_type").each(function(t){$(this)[0].checked&&(e=$(this).val())});let t=getEntityData(),a=getMapData();return{type:e,entity:t,map:a,yesno:null,truefalse:null,onezero:null}}function deserializeForm(e){$("#modal-create-reference-data").find(".modal-body").empty(),$("#modal-create-reference-data").find(".modal-body").append(getReferenceResource()),selectReferenceType(e),setEntityData(e),setMapData(e)}function addRow(e){e.find("tbody").find("tr").length;let t=e.find("tbody").find("tr:last-child").prop("outerHTML");e.find("tbody").append(t)}function addColumn(e){let t=e.find("thead").find("tr").find("td").length;e.find("tbody").find("tr").length;let a=t-parseInt(e.attr("data-offset"))-1;e.find("thead").find("tr").find("td:nth("+a+")").after('<td><input class="form-control map-key" type="text" value="" placeholder="Additional attribute name"></td>'),e.find("tbody").find("tr").each(function(e){$(this).find("td:nth("+a+")").after('<td><input class="form-control map-value" type="text" value="" placeholder="Additional attribute value"></td>')}),e.find("tfoot").find("tr").find("td").attr("colspan",e.find("thead").find("tr").find("td").length)}function removeLastColumn(e){let t=e.find("thead").find("tr").find("td").length;e.find("tbody").find("tr").length;let a=parseInt(e.attr("data-offset")),n=t-a-1;t>a+2&&(e.find("thead").find("tr").find("td:nth("+n+")").remove(),e.find("tbody").find("tr").each(function(e){$(this).find("td:nth("+n+")").remove()}),e.find("tfoot").find("tr").find("td").attr("colspan",e.find("thead").find("tr").find("td").length))}function selectReferenceType(e){let t=e.type?e.type:"entity",a=$("#modal-create-reference-data .modal-dialog");"entity"==t||"map"==t?(a.addClass("modal-xl"),a.hasClass("modal-md")&&a.removeClass("modal-md")):(a.addClass("modal-md"),a.hasClass("modal-xl")&&a.removeClass("modal-xl")),$('.reference_type[value="'+t+'"]').length>0&&($('.reference_type[value="'+t+'"]')[0].checked=!0),$(".reference-section").css({display:"none"}),"entity"==t?$(".entity-section").css({display:"block"}):"map"==t&&$(".map-section").css({display:"block"})}function setEntityData(e){e.entity=e&&e.entity?e.entity:{};let t=e.entity;t.entityName=t.entityName?t.entityName:"",t.tableName=t.tableName?t.tableName:"",t.primaryKey=t.primaryKey?t.primaryKey:"",t.value=t.value?t.value:"",t.objectName=t.objectName?t.objectName:"",t.propertyName=t.propertyName?t.propertyName:"",t.textNodeFormat=t.textNodeFormat?t.textNodeFormat:"",t.indent=t.indent?t.indent:"";let a='[data-name="entity"]';$(a).find(".rd-entity-name").val(t.entityName),$(a).find(".rd-table-name").val(t.tableName),$(a).find(".rd-primary-key").val(t.primaryKey),$(a).find(".rd-value-column").val(t.value),$(a).find(".rd-reference-object-name").val(t.objectName),$(a).find(".rd-reference-property-name").val(t.propertyName),$(a).find(".rd-option-text-node-format").val(t.textNodeFormat),$(a).find(".rd-option-indent").val(t.indent),setSpecificationData(e),setSortableData(e),setAdditionalOutputData(e)}function getEntityData(){let e='[data-name="entity"]';return{entityName:$(e).find(".rd-entity-name").val().trim(),tableName:$(e).find(".rd-table-name").val().trim(),primaryKey:$(e).find(".rd-primary-key").val().trim(),value:$(e).find(".rd-value-column").val().trim(),objectName:$(e).find(".rd-reference-object-name").val().trim(),propertyName:$(e).find(".rd-reference-property-name").val().trim(),textNodeFormat:$(e).find(".rd-option-text-node-format").val(),indent:$(e).find(".rd-option-indent").val(),specification:getSpecificationData(),sortable:getSortableData(),additionalOutput:getAdditionalOutputData()}}function setSpecificationData(e){let t=$('[data-name="specification"]'),a=e.entity.specification;if(void 0!==a&&null!=a&&a.length>0)for(let n in a){n>0&&addRow(t);let i=t.find("tr:last-child"),l=a[n];i.find(".rd-column-name").val(l.column),i.find(".rd-value").val(l.value)}}function getSpecificationData(){let e=[];return $('[data-name="specification"]').find("tbody").find("tr").each(function(t){let a=$(this),n=a.find(".rd-column-name").val().trim(),i=a.find(".rd-value").val().trim();n.length>0&&e.push({column:n,value:fixValue(i)})}),e}function setSortableData(e){let t=$('[data-name="sortable"]'),a=e.entity.sortable;if(void 0!==a&&null!=a&&a.length>0)for(let n in a){n>0&&addRow(t);let i=t.find("tr:last-child"),l=a[n];i.find(".rd-column-name").val(l.sortBy),i.find(".rd-order-type").val(l.sortType)}}function getSortableData(){let e=[];return $('[data-name="sortable"]').find("tbody").find("tr").each(function(t){let a=$(this),n=a.find(".rd-column-name").val().trim(),i=a.find(".rd-order-type").val().trim();n.length>0&&e.push({sortBy:n,sortType:i})}),e}function setAdditionalOutputData(e){let t=$('[data-name="additional-output"]'),a=e.entity.additionalOutput;if(void 0!==a&&null!=a&&a.length>0)for(let n in a){n>0&&addRow(t);let i=t.find("tr:last-child"),l=a[n];i.find(".rd-column-name").val(l.column)}}function getAdditionalOutputData(){let e=[];return $('[data-name="additional-output"]').find("tbody").find("tr").each(function(t){let a=$(this).find(".rd-column-name").val().trim();a.length>0&&e.push({column:a})}),e}function setMapData(e){let t='[data-name="map"]',a=$(t),n=[];e.map=e.map?e.map:[];let i=e.map,l=[];if(i.length>0){let r=i[0],o=0;for(let d in r)r.hasOwnProperty(d)&&(++o>4&&addColumn(a),"value"!=d&&"label"!=d&&"default"!=d&&(n.push(d),l[0]=d));for(let c in n){let u=parseInt(c)+1;a.find("thead").find("tr").find(".map-key:nth-child("+u+")").val(n[c])}for(let s in $(t).find("thead").find("tr").find(".map-key").length>0&&$(t).find("thead").find("tr").find(".map-key").each(function(e){n.push($(this).val().trim())}),i){s>0&&addRow(a);let p=a.find("tr:last-child"),f=i[s];for(let m in p.find(".rd-value").val(f.value),p.find(".rd-label").val(f.label),i[s].default&&(p.find(".rd-selected")[0].checked=!0),n){let y=parseInt(m)+1,h=i[s][n[m]];p.find(".map-value:nth-child("+y+")").val(h)}}}}function getMapData(){let e=[],t='[data-name="map"]',a=[];return $(t).find("thead").find("tr").find(".map-key").length>0&&$(t).find("thead").find("tr").find(".map-key").each(function(e){a.push($(this).val().trim())}),$(t).find("tbody").find("tr").each(function(t){let n=$(this),i=n.find(".rd-value").val().trim(),l,r={value:i,label:n.find(".rd-label").val().trim(),default:n.find(".rd-selected")[0].checked};if(a.length>0){let o=0;n.find(".map-value").each(function(e){let t=$(this).val();a[o].length>0&&(r[a[o]]=t),o++})}e.push(r)}),e}function fixValue(e){return"true"==e||"false"!=e&&("null"==e?null:isNumeric(e)?parseNumber(e):e)}function parseNumber(e){return -1!==e.indexOf(".")?parseFloat(e):parseInt(e)}function isNumeric(e){return"string"==typeof e&&!isNaN(e)&&!isNaN(parseFloat(e))}String.prototype.replaceAll=function(e,t,a){return this.replace(RegExp(e.replace(/([\/\,\!\\\^\$\{\}\[\]\(\)\.\*\+\?\|\<\>\-\&])/g,"\\$&"),a?"gi":"g"),"string"==typeof t?t.replace(/\$/g,"$$$$"):t)},String.prototype.capitalize=function(){return this.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})},String.prototype.prettify=function(){let e,t,a=this.split(" ");for(e in a)switch(t=a[e]){case"Id":a[e]="";break;case"Ip":a[e]="IP"}return a.join(" ")};