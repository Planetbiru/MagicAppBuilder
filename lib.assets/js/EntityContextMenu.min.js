let selectedElement=null;function initDiagramContextMenu(e){let t=document.querySelector("#context-menu");e.addEventListener("contextmenu",function(e){let n=e.target.closest("g.svg-entity");if(selectedElement=n,n){e.preventDefault();renderContextMenu(n)>0?(t.style.top=`${e.pageY}px`,t.style.left=`${e.pageX}px`,t.style.display="block"):t.style.display="none"}else t.style.display="none"})}function renderContextMenu(e){let t=document.querySelector("#context-menu"),n=t.querySelector("ul");n.innerHTML="";let l=e.dataset.entity,a=e.querySelectorAll(".diagram-column-name"),c=0;return a.forEach((e,t)=>{let a=e.textContent.trim();if(!a.startsWith(l)&&a.endsWith("_id")){let i=a.substring(0,a.length-3);if(null!=document.querySelector(`.table-list input[data-name="${i}"]`)){let r=document.createElement("li");r.dataset.type="relation";let d=document.createElement("label"),o=document.createElement("input"),s=`relation-${t}`;o.type="checkbox",o.id=s,o.dataset.name=i,o.addEventListener("change",function(e){selectTable(e)}),o.checked=isSelectedTable(i),d.setAttribute("for",s),d.appendChild(o);let u=` ${a}`;d.appendChild(document.createTextNode(u)),r.appendChild(d),n.appendChild(r),c++}}}),c}function selectTable(e){let t=e.target.dataset.name,n=document.querySelector(`.table-list input[data-name="${t}"]`);null!=n&&(n.checked=e.target.checked,n.dispatchEvent(new Event("change",{bubbles:!0})))}function isSelectedTable(e){let t=document.querySelector(`.table-list input[data-name="${e}"]`);return!!t&&t.checked}document.addEventListener("DOMContentLoaded",function(){document.addEventListener("click",function(e){let t=document.querySelector("#context-menu");e.target.closest("#context-menu")||(t.style.display="none")})});