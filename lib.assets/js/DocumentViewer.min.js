function previewFile(e){let t=e.split(".").pop().toLowerCase(),r=document.querySelector("#document-viewer");r.innerHTML="Loading...","pdf"===t?previewPDF(e):"docx"===t?previewDOCX(e):["xls","xlsx","ods"].includes(t)?previewExcel(e):"csv"===t?previewCSV(e):r.innerHTML="Unsupported format."}function previewPDF(e){let t=document.querySelector("#document-viewer"),r=pdfjsLib.getDocument(e);r.promise.then(e=>{e.getPage(1).then(e=>{let r=e.getViewport({scale:1.5}),n=document.createElement("canvas"),l=n.getContext("2d");n.height=r.height,n.width=r.width,t.innerHTML="",t.appendChild(n),e.render({canvasContext:l,viewport:r})})}).catch(e=>{t.innerHTML="Failed to load file PDF.",console.error(e)})}function previewDOCX(e){fetch(e).then(e=>e.blob()).then(e=>{if(null!=e){var t=Object.assign(docx.defaultOptions,{className:"docx",inWrapper:!0,ignoreWidth:!1,ignoreHeight:!1,ignoreFonts:!1,breakPages:!0,ignoreLastRenderedPageBreak:!0,experimental:!1,trimXmlDeclaration:!0,useBase64URL:!1,useMathMLPolyfill:!1,debug:!1}),r=document.querySelector("#document-viewer");docx.renderAsync(e,r,null,t)}})}function previewExcel(e){fetch(e).then(e=>e.arrayBuffer()).then(e=>{let t=document.querySelector("#document-viewer");t.innerHTML="";let r=document.createElement("ul");r.id="sheet-tabs",r.className="nav nav-tabs mt-2",t.appendChild(r);let n=document.createElement("div");n.id="sheet-viewer",n.style.marginTop="10px",t.appendChild(n);let l=XLSX.read(e,{type:"array"});renderExcelSheet(l,l.SheetNames[0],"#sheet-viewer"),l.SheetNames.forEach((e,t)=>{let n=document.createElement("li");n.className="nav-item";let a=document.createElement("a");a.className="nav-link"+(0===t?" active":""),a.href="#",a.textContent=e,a.onclick=t=>{t.preventDefault(),r.querySelectorAll(".nav-link").forEach(e=>e.classList.remove("active")),a.classList.add("active"),renderExcelSheet(l,e,"#sheet-viewer")},n.appendChild(a),r.appendChild(n)})}).catch(e=>{document.querySelector("#document-viewer").innerHTML="Failed to load file Excel.",console.error(e)})}function previewCSV(e){fetch(e).then(e=>e.text()).then(e=>{let t=document.querySelector("#document-viewer");t.innerHTML="";let r=document.createElement("ul");r.id="sheet-tabs",r.className="nav nav-tabs mt-2",t.appendChild(r);let n=document.createElement("div");n.id="sheet-viewer",n.style.marginTop="10px",t.appendChild(n);let l=XLSX.read(e,{type:"string"});renderExcelSheet(l,l.SheetNames[0],"#sheet-viewer"),l.SheetNames.forEach((e,t)=>{let n=document.createElement("li");n.className="nav-item";let a=document.createElement("a");a.className="nav-link"+(0===t?" active":""),a.href="#",a.textContent=e,a.onclick=t=>{t.preventDefault(),r.querySelectorAll(".nav-link").forEach(e=>e.classList.remove("active")),a.classList.add("active"),renderExcelSheet(l,e,"#sheet-viewer")},n.appendChild(a),r.appendChild(n)})}).catch(e=>{document.querySelector("#document-viewer").innerHTML="Failed to load file CSV.",console.error(e)})}function renderExcelSheet(e,t,r){let n=document.querySelector(r);if(!n)return;let l=XLSX.utils.sheet_to_html(e.Sheets[t]);n.innerHTML=l}