class Entity{constructor(t,e){this.index=e,this.name=t,this.columns=[],this.data=[],this.description="",this.creationDate=null,this.modificationDate=null,this.creator=null,this.modifier=null}addColumn(t){this.columns.push(t)}removeColumn(t){this.columns.splice(t,1)}setData(t){this.data=t||[]}countPrimaryKey(){return this.columns.filter(t=>t.primaryKey).length}getPrimaryKeyColumns(){return this.columns.filter(t=>t.primaryKey).map(t=>t.name)}getPrimaryKeyColumnsAsString(t="mysql"){let e=this.getPrimaryKeyColumns();return"mysql"===t?e.map(t=>`\`${t}\``).join(", "):e.join(", ")}toSQL(t="mysql"){let e=this.countPrimaryKey()>1,n=[],r=`CREATE TABLE IF NOT EXISTS ${this.name} (\r
`;return this.columns.forEach(r=>{n.push(`	${r.toSQL(t,e)}`)}),e&&n.push(`	PRIMARY KEY(${this.getPrimaryKeyColumnsAsString(t)})`),r+=n.join(",\r\n"),r+="\r\n);\r\n\r\n"}toSQLInsert(t="mysql"){if(!this.data||0===this.data.length)return"";let e=this.columns.map(t=>t.name),n=this.data.map(n=>"("+e.map(e=>{let r=this.columns.find(t=>t.name===e),l=!!r&&r.nullable;return this.formatValue(n[e],r,t,l)}).join(", ")+")");return`INSERT INTO ${this.name} (${e.join(", ")}) VALUES
${n.join(",\n")};\r
`}createInsert(t,e){let n=e.join(", "),r=e.map(e=>{let n=this.columns.find(t=>t.name===e),r=!n||n.nullable;return this.formatValue(t[e],n,"mysql",r)}).join(", ");return`INSERT INTO ${this.name} (${n}) VALUES (${r});`}formatValue(t,e,n="mysql",r=!0){let l=e.type.toLowerCase(),s=e.length,i=e.isTypeText(l),o=e.isTypeInteger(l),a=e.isTypeFloat(l),u=e.isTypeBoolean(l,s),m=null==t||"string"==typeof t&&""===t.trim()||!i&&"null"===String(t).toLowerCase();return m?r?"null":void 0!==e.default&&null!==e.default?this.formatValue(e.default,e,n,!0):u?this.formatBoolean(t,n,!1,e.default):o||a?"0":"''":u?this.formatBoolean(t,n,r,e.default):o||a?t.toString():this.quoteString(t)}formatBoolean(t,e="mysql",n=!0,r=null){let l=null==t||"string"==typeof t&&""===t.trim()||"string"==typeof t&&"null"===t.trim().toLowerCase();if(l)return n?"null":null!=r?this.formatBoolean(r,e,!1):"postgresql"===e.toLowerCase()?"false":"0";let s=String(t).toLowerCase().trim(),i="true"===s||"1"===s||"yes"===s||"on"===s;return"postgresql"===e.toLowerCase()?i?"true":"false":i?"1":"0"}quoteString(t){let e=String(t).replace(/'/g,"''");return`'${e}'`}}