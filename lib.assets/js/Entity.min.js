class Entity{constructor(t,e){this.index=e,this.name=t,this.columns=[],this.data=[],this.description="",this.creationDate=null,this.modificationDate=null,this.creator=null,this.modifier=null}addColumn(t){this.columns.push(t)}removeColumn(t){this.columns.splice(t,1)}setData(t){this.data=t||[]}countPrimaryKey(){return this.columns.filter(t=>t.primaryKey).length}getPrimaryKeyColumns(){return this.columns.filter(t=>t.primaryKey).map(t=>t.name)}getPrimaryKeyColumnsAsString(t="mysql"){let e=this.getPrimaryKeyColumns();return"mysql"===t?e.map(t=>`\`${t}\``).join(", "):e.join(", ")}toSQL(t="mysql"){let e=this.countPrimaryKey()>1,r=[],s=`CREATE TABLE IF NOT EXISTS ${this.name} (\r
`;return this.columns.forEach(s=>{r.push(`	${s.toSQL(t,e)}`)}),e&&r.push(`	PRIMARY KEY(${this.getPrimaryKeyColumnsAsString(t)})`),s+=r.join(",\r\n"),s+="\r\n);\r\n\r\n"}toSQLInsert(t="mysql"){if(!this.data||0===this.data.length)return"";let e=this.columns.map(t=>t.name),r=this.data.map(r=>"("+e.map(e=>{let s=this.columns.find(t=>t.name===e),l=!!s&&s.nullable;return this.formatValue(r[e],s,t,l)}).join(", ")+")");return`INSERT INTO ${this.name} (${e.join(", ")}) VALUES
${r.join(",\n")};\r
`}createInsert(t,e){let r=e.join(", "),s=e.map(e=>{let r=this.columns.find(t=>t.name===e),s=!r||r.nullable;return this.formatValue(t[e],r,"mysql",s)}).join(", ");return`INSERT INTO ${this.name} (${r}) VALUES (${s});`}formatValue(t,e,r="mysql",s=!0){let l=e.type.toLowerCase(),n=e.length,a=e.isTypeText(l),i=e.isTypeInteger(l),o=e.isTypeFloat(l),u=e.isTypeBoolean(l,n),m=null==t||"string"==typeof t&&""===t.trim()||!a&&"null"===String(t).toLowerCase();return m?s?"null":void 0!==e.default&&null!==e.default?this.formatValue(e.default,e,r,!0):u?this.formatBoolean(t,r,!1,e.default):i||o?"0":"''":u?this.formatBoolean(t,r,s,e.default):i||o?t.toString():this.quoteString(t,r)}formatBoolean(t,e="mysql",r=!0,s=null){let l=null==t||"string"==typeof t&&""===t.trim()||"string"==typeof t&&"null"===t.trim().toLowerCase();if(l)return r?"null":null!=s?this.formatBoolean(s,e,!1):"postgresql"===e.toLowerCase()?"false":"0";let n=String(t).toLowerCase().trim(),a="true"===n||"1"===n||"yes"===n||"on"===n;return"postgresql"===e.toLowerCase()?a?"true":"false":a?"1":"0"}quoteString(t,e="mysql"){let r=String(t);switch(r=r.replace(/'/g,"''"),e.toLowerCase()){case"mysql":default:r=r.replace(/\\/g,"\\\\");break;case"postgresql":return`E'${r=r.replace(/\\/g,"\\\\")}'`;case"sqlite":case"sqlserver":}return`'${r}'`}}